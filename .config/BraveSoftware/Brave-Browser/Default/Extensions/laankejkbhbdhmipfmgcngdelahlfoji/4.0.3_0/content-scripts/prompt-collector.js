var promptCollector=function(){"use strict";var ev=Object.defineProperty;var ql=ve=>{throw TypeError(ve)};var tv=(ve,Ce,Ie)=>Ce in ve?ev(ve,Ce,{enumerable:!0,configurable:!0,writable:!0,value:Ie}):ve[Ce]=Ie;var ce=(ve,Ce,Ie)=>tv(ve,typeof Ce!="symbol"?Ce+"":Ce,Ie),rc=(ve,Ce,Ie)=>Ce.has(ve)||ql("Cannot "+Ie);var j=(ve,Ce,Ie)=>(rc(ve,Ce,"read from private field"),Ie?Ie.call(ve):Ce.get(ve)),At=(ve,Ce,Ie)=>Ce.has(ve)?ql("Cannot add the same private member more than once"):Ce instanceof WeakSet?Ce.add(ve):Ce.set(ve,Ie),je=(ve,Ce,Ie,Ws)=>(rc(ve,Ce,"write to private field"),Ws?Ws.call(ve,Ie):Ce.set(ve,Ie),Ie),Lr=(ve,Ce,Ie)=>(rc(ve,Ce,"access private method"),Ie);var Vl,Wl,We,He,ar,Pe,Ue,Tr,Kr,Sr,Zt,Xr,Ps,Jr,Hl,Er,Qa,nc,Gl;typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ve=()=>{},Ie={debug:ve,log:ve,info:ve,warn:ve,error:ve};function Ws(...t){Ie.debug(...t)}function ni(...t){Ie.log(...t)}function Zl(...t){Ie.info(...t)}function zl(...t){Ie.warn(...t)}function Kl(...t){Ie.error(...t)}const Xl={debug:Ws,log:ni,info:Zl,warn:zl,error:Kl};var Pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ac={exports:{}};(function(t,e){(function(r,n){n(t)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Pt,function(r){var n,s;if(!((s=(n=globalThis.chrome)==null?void 0:n.runtime)!=null&&s.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const a="The message port closed before a response was received.",i=o=>{const u={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(u).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class l extends WeakMap{constructor(P,N=void 0){super(N),this.createItem=P}get(P){return this.has(P)||this.set(P,this.createItem(P)),super.get(P)}}const c=_=>_&&typeof _=="object"&&typeof _.then=="function",m=(_,P)=>(...N)=>{o.runtime.lastError?_.reject(new Error(o.runtime.lastError.message)):P.singleCallbackArg||N.length<=1&&P.singleCallbackArg!==!1?_.resolve(N[0]):_.resolve(N)},d=_=>_==1?"argument":"arguments",w=(_,P)=>function(U,...G){if(G.length<P.minArgs)throw new Error(`Expected at least ${P.minArgs} ${d(P.minArgs)} for ${_}(), got ${G.length}`);if(G.length>P.maxArgs)throw new Error(`Expected at most ${P.maxArgs} ${d(P.maxArgs)} for ${_}(), got ${G.length}`);return new Promise((I,K)=>{if(P.fallbackToNoCallback)try{U[_](...G,m({resolve:I,reject:K},P))}catch(L){console.warn(`${_} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,L),U[_](...G),P.fallbackToNoCallback=!1,P.noCallback=!0,I()}else P.noCallback?(U[_](...G),I()):U[_](...G,m({resolve:I,reject:K},P))})},A=(_,P,N)=>new Proxy(P,{apply(U,G,I){return N.call(G,_,...I)}});let f=Function.call.bind(Object.prototype.hasOwnProperty);const g=(_,P={},N={})=>{let U=Object.create(null),G={has(K,L){return L in _||L in U},get(K,L,H){if(L in U)return U[L];if(!(L in _))return;let W=_[L];if(typeof W=="function")if(typeof P[L]=="function")W=A(_,_[L],P[L]);else if(f(N,L)){let O=w(L,N[L]);W=A(_,_[L],O)}else W=W.bind(_);else if(typeof W=="object"&&W!==null&&(f(P,L)||f(N,L)))W=g(W,P[L],N[L]);else if(f(N,"*"))W=g(W,P[L],N["*"]);else return Object.defineProperty(U,L,{configurable:!0,enumerable:!0,get(){return _[L]},set(O){_[L]=O}}),W;return U[L]=W,W},set(K,L,H,W){return L in U?U[L]=H:_[L]=H,!0},defineProperty(K,L,H){return Reflect.defineProperty(U,L,H)},deleteProperty(K,L){return Reflect.deleteProperty(U,L)}},I=Object.create(_);return new Proxy(I,G)},b=_=>({addListener(P,N,...U){P.addListener(_.get(N),...U)},hasListener(P,N){return P.hasListener(_.get(N))},removeListener(P,N){P.removeListener(_.get(N))}}),S=new l(_=>typeof _!="function"?_:function(N){const U=g(N,{},{getContent:{minArgs:0,maxArgs:0}});_(U)}),x=new l(_=>typeof _!="function"?_:function(N,U,G){let I=!1,K,L=new Promise(Z=>{K=function(Q){I=!0,Z(Q)}}),H;try{H=_(N,U,K)}catch(Z){H=Promise.reject(Z)}const W=H!==!0&&c(H);if(H!==!0&&!W&&!I)return!1;const O=Z=>{Z.then(Q=>{G(Q)},Q=>{let ye;Q&&(Q instanceof Error||typeof Q.message=="string")?ye=Q.message:ye="An unexpected error occurred",G({__mozWebExtensionPolyfillReject__:!0,message:ye})}).catch(Q=>{console.error("Failed to send onMessage rejected reply",Q)})};return O(W?H:L),!0}),E=({reject:_,resolve:P},N)=>{o.runtime.lastError?o.runtime.lastError.message===a?P():_(new Error(o.runtime.lastError.message)):N&&N.__mozWebExtensionPolyfillReject__?_(new Error(N.message)):P(N)},C=(_,P,N,...U)=>{if(U.length<P.minArgs)throw new Error(`Expected at least ${P.minArgs} ${d(P.minArgs)} for ${_}(), got ${U.length}`);if(U.length>P.maxArgs)throw new Error(`Expected at most ${P.maxArgs} ${d(P.maxArgs)} for ${_}(), got ${U.length}`);return new Promise((G,I)=>{const K=E.bind(null,{resolve:G,reject:I});U.push(K),N.sendMessage(...U)})},y={devtools:{network:{onRequestFinished:b(S)}},runtime:{onMessage:b(x),onMessageExternal:b(x),sendMessage:C.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:C.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},T={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return u.privacy={network:{"*":T},services:{"*":T},websites:{"*":T}},g(o,y,u)};r.exports=i(chrome)}else r.exports=globalThis.browser})})(ac);var Jl=ac.exports;const we=Fr(Jl),Ql=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(t=>[t.name,t]),ed=new Map(Ql);class si extends Error{constructor(r){super(si._prepareSuperMessage(r));ce(this,"name","NonError")}static _prepareSuperMessage(r){try{return JSON.stringify(r)}catch{return String(r)}}}const td=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],ai=new WeakSet,rd=t=>{ai.add(t);const e=t.toJSON();return ai.delete(t),e},ic=t=>ed.get(t)??Error,ii=({from:t,seen:e,to:r,forceEnumerable:n,maxDepth:s,depth:a,useToJSON:i,serialize:o})=>{if(!r)if(Array.isArray(t))r=[];else if(!o&&oc(t)){const l=ic(t.name);r=new l}else r={};if(e.push(t),a>=s)return r;if(i&&typeof t.toJSON=="function"&&!ai.has(t))return rd(t);const u=l=>ii({from:l,seen:[...e],forceEnumerable:n,maxDepth:s,depth:a,useToJSON:i,serialize:o});for(const[l,c]of Object.entries(t)){if(c&&c instanceof Uint8Array&&c.constructor.name==="Buffer"){r[l]="[object Buffer]";continue}if(c!==null&&typeof c=="object"&&typeof c.pipe=="function"){r[l]="[object Stream]";continue}if(typeof c!="function"){if(!c||typeof c!="object"){try{r[l]=c}catch{}continue}if(!e.includes(t[l])){a++,r[l]=u(t[l]);continue}r[l]="[Circular]"}}for(const{property:l,enumerable:c}of td)typeof t[l]<"u"&&t[l]!==null&&Object.defineProperty(r,l,{value:oc(t[l])?u(t[l]):t[l],enumerable:n?!0:c,configurable:!0,writable:!0});return r};function nd(t,e={}){const{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:n=!0}=e;return typeof t=="object"&&t!==null?ii({from:t,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:n,serialize:!0}):typeof t=="function"?`[Function: ${t.name||"anonymous"}]`:t}function sd(t,e={}){const{maxDepth:r=Number.POSITIVE_INFINITY}=e;if(t instanceof Error)return t;if(ad(t)){const n=ic(t.name);return ii({from:t,seen:[],to:new n,maxDepth:r,depth:0,serialize:!1})}return new si(t)}function oc(t){return!!t&&typeof t=="object"&&"name"in t&&"message"in t&&"stack"in t}function ad(t){return!!t&&typeof t=="object"&&"message"in t&&!Array.isArray(t)}var id=Object.defineProperty,od=Object.defineProperties,cd=Object.getOwnPropertyDescriptors,cc=Object.getOwnPropertySymbols,ud=Object.prototype.hasOwnProperty,ld=Object.prototype.propertyIsEnumerable,uc=(t,e,r)=>e in t?id(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lc=(t,e)=>{for(var r in e||(e={}))ud.call(e,r)&&uc(t,r,e[r]);if(cc)for(var r of cc(e))ld.call(e,r)&&uc(t,r,e[r]);return t},dc=(t,e)=>od(t,cd(e)),dd=(t,e,r)=>new Promise((n,s)=>{var a=u=>{try{o(r.next(u))}catch(l){s(l)}},i=u=>{try{o(r.throw(u))}catch(l){s(l)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(a,i);o((r=r.apply(t,e)).next())});function hd(t){let e,r={};function n(){Object.entries(r).length===0&&(e==null||e(),e=void 0)}let s=Math.floor(Math.random()*1e4);function a(){return s++}return{sendMessage(i,o,...u){return dd(this,null,function*(){var l,c;const m={id:a(),type:i,data:o,timestamp:Date.now()};(l=t.logger)==null||l.debug(`[messaging] sendMessage {id=${m.id}} ─ᐅ`,m,...u);const d=yield t.sendMessage(m,...u),{res:w,err:A}=d??{err:new Error("No response")};if((c=t.logger)==null||c.debug(`[messaging] sendMessage {id=${m.id}} ᐊ─`,{res:w,err:A}),A!=null)throw sd(A);return w})},onMessage(i,o){var u,l,c;if(e==null&&((u=t.logger)==null||u.debug(`[messaging] "${i}" initialized the message listener for this context`),e=t.addRootListener(m=>{var d,w;if(typeof m.type!="string"||typeof m.timestamp!="number"){const g=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(m)}`);throw(d=t.logger)==null||d.error(g),g}(w=t==null?void 0:t.logger)==null||w.debug("[messaging] Received message",m);const A=r[m.type];if(A==null)return;const f=A(m);return Promise.resolve(f).then(g=>{var b;return(b=t==null?void 0:t.logger)==null||b.debug(`[messaging] onMessage {id=${m.id}} ─ᐅ`,{res:g}),{res:g}}).catch(g=>{var b;return(b=t==null?void 0:t.logger)==null||b.debug(`[messaging] onMessage {id=${m.id}} ─ᐅ`,{err:g}),{err:nd(g)}})})),r[i]!=null){const m=Error(`[messaging] In this JS context, only one listener can be setup for ${i}`);throw(l=t.logger)==null||l.error(m),m}return r[i]=o,(c=t.logger)==null||c.log(`[messaging] Added listener for ${i}`),()=>{delete r[i],n()}},removeAllListeners(){Object.keys(r).forEach(i=>{delete r[i]}),n()}}}function fd(t){return hd(dc(lc({},t),{sendMessage(e,r){return r==null?we.runtime.sendMessage(e):we.tabs.sendMessage(r,e)},addRootListener(e){const r=(n,s)=>e(typeof n=="object"?dc(lc({},n),{sender:s}):n);return we.runtime.onMessage.addListener(r),()=>we.runtime.onMessage.removeListener(r)}}))}/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var md=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1};/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2018, Jon Schlinkert.
 * Released under the MIT License.
 */const hc=md;var gd=function(t,e,r){if(hc(r)||(r={default:r}),!mc(t))return typeof r.default<"u"?r.default:t;typeof e=="number"&&(e=String(e));const n=Array.isArray(e),s=typeof e=="string",a=r.separator||".",i=r.joinChar||(typeof a=="string"?a:".");if(!s&&!n)return t;if(s&&e in t)return oi(e,t,r)?t[e]:r.default;let o=n?e:pd(e,a,r),u=o.length,l=0;do{let c=o[l];for(typeof c=="number"&&(c=String(c));c&&c.slice(-1)==="\\";)c=fc([c.slice(0,-1),o[++l]||""],i,r);if(c in t){if(!oi(c,t,r))return r.default;t=t[c]}else{let m=!1,d=l+1;for(;d<u;)if(c=fc([c,o[d++]],i,r),m=c in t){if(!oi(c,t,r))return r.default;t=t[c],l=d-1;break}if(!m)return r.default}}while(++l<u&&mc(t));return l===u?t:r.default};function fc(t,e,r){return typeof r.join=="function"?r.join(t):t[0]+e+t[1]}function pd(t,e,r){return typeof r.split=="function"?r.split(t):t.split(e)}function oi(t,e,r){return typeof r.isValid=="function"?r.isValid(t,e):!0}function mc(t){return hc(t)||Array.isArray(t)||typeof t=="function"}const yd=Fr(gd);var wd=(t,e,r)=>new Promise((n,s)=>{var a=u=>{try{o(r.next(u))}catch(l){s(l)}},i=u=>{try{o(r.throw(u))}catch(l){s(l)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(a,i);o((r=r.apply(t,e)).next())});function bd(){if(!Ad())return!1;const t=we.runtime.getManifest();return t.background?t.manifest_version===3?xd():_d():!1}function Ad(){var t;return!!((t=we.runtime)!=null&&t.id)}var vd=["/_generated_background_page.html"];function _d(){return typeof window<"u"&&vd.includes(location.pathname)}function xd(){return typeof window>"u"}function Wn(t,e,r){let n;const s=`proxy-service.${t}`,{onMessage:a,sendMessage:i}=fd(r);function o(u){const l=()=>{},c=new Proxy(l,{apply(m,d,w){return wd(this,null,function*(){return yield i(s,{path:u,args:w})})},get(m,d,w){return d==="__proxy"||typeof d=="symbol"?Reflect.get(m,d,w):o(u==null?d:`${u}.${d}`)}});return c.__proxy=!0,c}return[function(...l){return n=e(...l),a(s,({data:c})=>{const m=c.path==null?n:yd(n??{},c.path);if(m)return Promise.resolve(m.bind(n)(...c.args))}),n},function(){if(!bd())return o();if(n==null)throw Error(`Failed to get an instance of ${t}: in background, but registerService has not been called. Did you forget to call registerService?`);return n}]}const[rv,Td]=Wn("BackgroundApi",()=>{throw Error("Proxy only, no implementation provided.")});var gc=Object.prototype.hasOwnProperty;function ci(t,e){var r,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&ci(t[n],e[n]););return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(gc.call(t,r)&&++n&&!gc.call(e,r)||!(r in e)||!ci(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}const Sd=new Error("request for lock canceled");var Ed=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(c){try{l(n.next(c))}catch(m){i(m)}}function u(c){try{l(n.throw(c))}catch(m){i(m)}}function l(c){c.done?a(c.value):s(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};let kd=class{constructor(e,r=Sd){this._value=e,this._cancelError=r,this._queue=[],this._weightedWaiters=[]}acquire(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((n,s)=>{const a={resolve:n,reject:s,weight:e,priority:r},i=pc(this._queue,o=>r<=o.priority);i===-1&&e<=this._value?this._dispatchItem(a):this._queue.splice(i+1,0,a)})}runExclusive(e){return Ed(this,arguments,void 0,function*(r,n=1,s=0){const[a,i]=yield this.acquire(n,s);try{return yield r(a)}finally{i()}})}waitForUnlock(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,r)?Promise.resolve():new Promise(n=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),Od(this._weightedWaiters[e-1],{resolve:n,priority:r})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){const r=this._value;this._value-=e.weight,e.resolve([r,this._newReleaser(e.weight)])}_newReleaser(e){let r=!1;return()=>{r||(r=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){const r=this._weightedWaiters[e-1];r&&(r.forEach(n=>n.resolve()),this._weightedWaiters[e-1]=[])}else{const e=this._queue[0].priority;for(let r=this._value;r>0;r--){const n=this._weightedWaiters[r-1];if(!n)continue;const s=n.findIndex(a=>a.priority<=e);(s===-1?n:n.splice(0,s)).forEach(a=>a.resolve())}}}_couldLockImmediately(e,r){return(this._queue.length===0||this._queue[0].priority<r)&&e<=this._value}};function Od(t,e){const r=pc(t,n=>e.priority<=n.priority);t.splice(r+1,0,e)}function pc(t,e){for(let r=t.length-1;r>=0;r--)if(e(t[r]))return r;return-1}var Pd=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(c){try{l(n.next(c))}catch(m){i(m)}}function u(c){try{l(n.throw(c))}catch(m){i(m)}}function l(c){c.done?a(c.value):s(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};let Bs=class{constructor(e){this._semaphore=new kd(1,e)}acquire(){return Pd(this,arguments,void 0,function*(e=0){const[,r]=yield this._semaphore.acquire(1,e);return r})}runExclusive(e,r=0){return this._semaphore.runExclusive(()=>e(),1,r)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}};const qs=((Wl=(Vl=globalThis.browser)==null?void 0:Vl.runtime)==null?void 0:Wl.id)==null?globalThis.chrome:globalThis.browser,dn=Md();function Md(){const t={local:Hs("local"),session:Hs("session"),sync:Hs("sync"),managed:Hs("managed")},e=f=>{const g=t[f];if(g==null){const b=Object.keys(t).join(", ");throw Error(`Invalid area "${f}". Options: ${b}`)}return g},r=f=>{const g=f.indexOf(":"),b=f.substring(0,g),S=f.substring(g+1);if(S==null)throw Error(`Storage key should be in the form of "area:key", but received "${f}"`);return{driverArea:b,driverKey:S,driver:e(b)}},n=f=>f+"$",s=(f,g)=>{const b={...f};return Object.entries(g).forEach(([S,x])=>{x==null?delete b[S]:b[S]=x}),b},a=(f,g)=>f??g??null,i=f=>typeof f=="object"&&!Array.isArray(f)?f:{},o=async(f,g,b)=>{const S=await f.getItem(g);return a(S,(b==null?void 0:b.fallback)??(b==null?void 0:b.defaultValue))},u=async(f,g)=>{const b=n(g),S=await f.getItem(b);return i(S)},l=async(f,g,b)=>{await f.setItem(g,b??null)},c=async(f,g,b)=>{const S=n(g),x=i(await f.getItem(S));await f.setItem(S,s(x,b))},m=async(f,g,b)=>{if(await f.removeItem(g),b!=null&&b.removeMeta){const S=n(g);await f.removeItem(S)}},d=async(f,g,b)=>{const S=n(g);if(b==null)await f.removeItem(S);else{const x=i(await f.getItem(S));[b].flat().forEach(E=>delete x[E]),await f.setItem(S,x)}},w=(f,g,b)=>f.watch(g,b);return{getItem:async(f,g)=>{const{driver:b,driverKey:S}=r(f);return await o(b,S,g)},getItems:async f=>{const g=new Map,b=new Map,S=[];f.forEach(E=>{let C,y;typeof E=="string"?C=E:"getValue"in E?(C=E.key,y={fallback:E.fallback}):(C=E.key,y=E.options),S.push(C);const{driverArea:T,driverKey:_}=r(C),P=g.get(T)??[];g.set(T,P.concat(_)),b.set(C,y)});const x=new Map;return await Promise.all(Array.from(g.entries()).map(async([E,C])=>{(await t[E].getItems(C)).forEach(T=>{const _=`${E}:${T.key}`,P=b.get(_),N=a(T.value,(P==null?void 0:P.fallback)??(P==null?void 0:P.defaultValue));x.set(_,N)})})),S.map(E=>({key:E,value:x.get(E)}))},getMeta:async f=>{const{driver:g,driverKey:b}=r(f);return await u(g,b)},getMetas:async f=>{const g=f.map(x=>{const E=typeof x=="string"?x:x.key,{driverArea:C,driverKey:y}=r(E);return{key:E,driverArea:C,driverKey:y,driverMetaKey:n(y)}}),b=g.reduce((x,E)=>{var C;return x[C=E.driverArea]??(x[C]=[]),x[E.driverArea].push(E),x},{}),S={};return await Promise.all(Object.entries(b).map(async([x,E])=>{const C=await qs.storage[x].get(E.map(y=>y.driverMetaKey));E.forEach(y=>{S[y.key]=C[y.driverMetaKey]??{}})})),g.map(x=>({key:x.key,meta:S[x.key]}))},setItem:async(f,g)=>{const{driver:b,driverKey:S}=r(f);await l(b,S,g)},setItems:async f=>{const g={};f.forEach(b=>{const{driverArea:S,driverKey:x}=r("key"in b?b.key:b.item.key);g[S]??(g[S]=[]),g[S].push({key:x,value:b.value})}),await Promise.all(Object.entries(g).map(async([b,S])=>{await e(b).setItems(S)}))},setMeta:async(f,g)=>{const{driver:b,driverKey:S}=r(f);await c(b,S,g)},setMetas:async f=>{const g={};f.forEach(b=>{const{driverArea:S,driverKey:x}=r("key"in b?b.key:b.item.key);g[S]??(g[S]=[]),g[S].push({key:x,properties:b.meta})}),await Promise.all(Object.entries(g).map(async([b,S])=>{const x=e(b),E=S.map(({key:_})=>n(_));console.log(b,E);const C=await x.getItems(E),y=Object.fromEntries(C.map(({key:_,value:P})=>[_,i(P)])),T=S.map(({key:_,properties:P})=>{const N=n(_);return{key:N,value:s(y[N]??{},P)}});await x.setItems(T)}))},removeItem:async(f,g)=>{const{driver:b,driverKey:S}=r(f);await m(b,S,g)},removeItems:async f=>{const g={};f.forEach(b=>{let S,x;typeof b=="string"?S=b:"getValue"in b?S=b.key:"item"in b?(S=b.item.key,x=b.options):(S=b.key,x=b.options);const{driverArea:E,driverKey:C}=r(S);g[E]??(g[E]=[]),g[E].push(C),x!=null&&x.removeMeta&&g[E].push(n(C))}),await Promise.all(Object.entries(g).map(async([b,S])=>{await e(b).removeItems(S)}))},clear:async f=>{await e(f).clear()},removeMeta:async(f,g)=>{const{driver:b,driverKey:S}=r(f);await d(b,S,g)},snapshot:async(f,g)=>{var x;const S=await e(f).snapshot();return(x=g==null?void 0:g.excludeKeys)==null||x.forEach(E=>{delete S[E],delete S[n(E)]}),S},restoreSnapshot:async(f,g)=>{await e(f).restoreSnapshot(g)},watch:(f,g)=>{const{driver:b,driverKey:S}=r(f);return w(b,S,g)},unwatch(){Object.values(t).forEach(f=>{f.unwatch()})},defineItem:(f,g)=>{const{driver:b,driverKey:S}=r(f),{version:x=1,migrations:E={}}=g??{};if(x<1)throw Error("Storage item version cannot be less than 1. Initial versions should be set to 1, not 0.");const C=async()=>{var H;const N=n(S),[{value:U},{value:G}]=await b.getItems([S,N]);if(U==null)return;const I=(G==null?void 0:G.v)??1;if(I>x)throw Error(`Version downgrade detected (v${I} -> v${x}) for "${f}"`);if(I===x)return;console.debug(`[@wxt-dev/storage] Running storage migration for ${f}: v${I} -> v${x}`);const K=Array.from({length:x-I},(W,O)=>I+O+1);let L=U;for(const W of K)try{L=await((H=E==null?void 0:E[W])==null?void 0:H.call(E,L))??L}catch(O){throw new Cd(f,W,{cause:O})}await b.setItems([{key:S,value:L},{key:N,value:{...G,v:x}}]),console.debug(`[@wxt-dev/storage] Storage migration completed for ${f} v${x}`,{migratedValue:L})},y=(g==null?void 0:g.migrations)==null?Promise.resolve():C().catch(N=>{console.error(`[@wxt-dev/storage] Migration failed for ${f}`,N)}),T=new Bs,_=()=>(g==null?void 0:g.fallback)??(g==null?void 0:g.defaultValue)??null,P=()=>T.runExclusive(async()=>{const N=await b.getItem(S);if(N!=null||(g==null?void 0:g.init)==null)return N;const U=await g.init();return await b.setItem(S,U),U});return y.then(P),{key:f,get defaultValue(){return _()},get fallback(){return _()},getValue:async()=>(await y,g!=null&&g.init?await P():await o(b,S,g)),getMeta:async()=>(await y,await u(b,S)),setValue:async N=>(await y,await l(b,S,N)),setMeta:async N=>(await y,await c(b,S,N)),removeValue:async N=>(await y,await m(b,S,N)),removeMeta:async N=>(await y,await d(b,S,N)),watch:N=>w(b,S,(U,G)=>N(U??_(),G??_())),migrate:C}}}}function Hs(t){const e=()=>{if(qs.runtime==null)throw Error(["'wxt/storage' must be loaded in a web extension environment",`
 - If thrown during a build, see https://github.com/wxt-dev/wxt/issues/371`,` - If thrown during tests, mock 'wxt/browser' correctly. See https://wxt.dev/guide/go-further/testing.html
`].join(`
`));if(qs.storage==null)throw Error("You must add the 'storage' permission to your manifest to use 'wxt/storage'");const n=qs.storage[t];if(n==null)throw Error(`"browser.storage.${t}" is undefined`);return n},r=new Set;return{getItem:async n=>(await e().get(n))[n],getItems:async n=>{const s=await e().get(n);return n.map(a=>({key:a,value:s[a]??null}))},setItem:async(n,s)=>{s==null?await e().remove(n):await e().set({[n]:s})},setItems:async n=>{const s=n.reduce((a,{key:i,value:o})=>(a[i]=o,a),{});await e().set(s)},removeItem:async n=>{await e().remove(n)},removeItems:async n=>{await e().remove(n)},clear:async()=>{await e().clear()},snapshot:async()=>await e().get(),restoreSnapshot:async n=>{await e().set(n)},watch(n,s){const a=i=>{const o=i[n];o!=null&&(ci(o.newValue,o.oldValue)||s(o.newValue??null,o.oldValue??null))};return e().onChanged.addListener(a),r.add(a),()=>{e().onChanged.removeListener(a),r.delete(a)}},unwatch(){r.forEach(n=>{e().onChanged.removeListener(n)}),r.clear()}}}class Cd extends Error{constructor(e,r,n){super(`v${r} migration failed for "${e}"`,n),this.key=e,this.version=r}}const yc=6048e5,Id=864e5,wc=Symbol.for("constructDateFrom");function pr(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&wc in t?t[wc](e):t instanceof Date?new t.constructor(e):new Date(e)}function Mt(t,e){return pr(e||t,t)}let Nd={};function Gs(){return Nd}function Bn(t,e){var o,u,l,c;const r=Gs(),n=(e==null?void 0:e.weekStartsOn)??((u=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((c=(l=r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??0,s=Mt(t,e==null?void 0:e.in),a=s.getDay(),i=(a<n?7:0)+a-n;return s.setDate(s.getDate()-i),s.setHours(0,0,0,0),s}function Ys(t,e){return Bn(t,{...e,weekStartsOn:1})}function bc(t,e){const r=Mt(t,e==null?void 0:e.in),n=r.getFullYear(),s=pr(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=Ys(s),i=pr(r,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=Ys(i);return r.getTime()>=a.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function Ac(t){const e=Mt(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function Dd(t,...e){const r=pr.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function vc(t,e){const r=Mt(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function Rd(t,e,r){const[n,s]=Dd(r==null?void 0:r.in,t,e),a=vc(n),i=vc(s),o=+a-Ac(a),u=+i-Ac(i);return Math.round((o-u)/Id)}function Ld(t,e){const r=bc(t,e),n=pr(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Ys(n)}function $d(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Fd(t){return!(!$d(t)&&typeof t!="number"||isNaN(+Mt(t)))}function jd(t,e){const r=Mt(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Ud={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Vd=(t,e,r)=>{let n;const s=Ud[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function ui(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const Wd={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Bd={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qd={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Hd={date:ui({formats:Wd,defaultWidth:"full"}),time:ui({formats:Bd,defaultWidth:"full"}),dateTime:ui({formats:qd,defaultWidth:"full"})},Gd={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Yd=(t,e,r,n)=>Gd[t];function qn(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,o=r!=null&&r.width?String(r.width):i;s=t.formattingValues[o]||t.formattingValues[i]}else{const i=t.defaultWidth,o=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[o]||t.values[i]}const a=t.argumentCallback?t.argumentCallback(e):e;return s[a]}}const Zd={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},zd={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Kd={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Xd={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Jd={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Qd={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},eh={ordinalNumber:(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:qn({values:Zd,defaultWidth:"wide"}),quarter:qn({values:zd,defaultWidth:"wide",argumentCallback:t=>t-1}),month:qn({values:Kd,defaultWidth:"wide"}),day:qn({values:Xd,defaultWidth:"wide"}),dayPeriod:qn({values:Jd,defaultWidth:"wide",formattingValues:Qd,defaultFormattingWidth:"wide"})};function Hn(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(s);if(!a)return null;const i=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(o)?rh(o,m=>m.test(i)):th(o,m=>m.test(i));let l;l=t.valueCallback?t.valueCallback(u):u,l=r.valueCallback?r.valueCallback(l):l;const c=e.slice(i.length);return{value:l,rest:c}}}function th(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function rh(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function nh(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],a=e.match(t.parsePattern);if(!a)return null;let i=t.valueCallback?t.valueCallback(a[0]):a[0];i=r.valueCallback?r.valueCallback(i):i;const o=e.slice(s.length);return{value:i,rest:o}}}const sh=/^(\d+)(th|st|nd|rd)?/i,ah=/\d+/i,ih={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oh={any:[/^b/i,/^(a|c)/i]},ch={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},uh={any:[/1/i,/2/i,/3/i,/4/i]},lh={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},dh={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hh={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fh={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},mh={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gh={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ph={ordinalNumber:nh({matchPattern:sh,parsePattern:ah,valueCallback:t=>parseInt(t,10)}),era:Hn({matchPatterns:ih,defaultMatchWidth:"wide",parsePatterns:oh,defaultParseWidth:"any"}),quarter:Hn({matchPatterns:ch,defaultMatchWidth:"wide",parsePatterns:uh,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Hn({matchPatterns:lh,defaultMatchWidth:"wide",parsePatterns:dh,defaultParseWidth:"any"}),day:Hn({matchPatterns:hh,defaultMatchWidth:"wide",parsePatterns:fh,defaultParseWidth:"any"}),dayPeriod:Hn({matchPatterns:mh,defaultMatchWidth:"any",parsePatterns:gh,defaultParseWidth:"any"})},yh={code:"en-US",formatDistance:Vd,formatLong:Hd,formatRelative:Yd,localize:eh,match:ph,options:{weekStartsOn:0,firstWeekContainsDate:1}};function wh(t,e){const r=Mt(t,e==null?void 0:e.in);return Rd(r,jd(r))+1}function bh(t,e){const r=Mt(t,e==null?void 0:e.in),n=+Ys(r)-+Ld(r);return Math.round(n/yc)+1}function _c(t,e){var c,m,d,w;const r=Mt(t,e==null?void 0:e.in),n=r.getFullYear(),s=Gs(),a=(e==null?void 0:e.firstWeekContainsDate)??((m=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:m.firstWeekContainsDate)??s.firstWeekContainsDate??((w=(d=s.locale)==null?void 0:d.options)==null?void 0:w.firstWeekContainsDate)??1,i=pr((e==null?void 0:e.in)||t,0);i.setFullYear(n+1,0,a),i.setHours(0,0,0,0);const o=Bn(i,e),u=pr((e==null?void 0:e.in)||t,0);u.setFullYear(n,0,a),u.setHours(0,0,0,0);const l=Bn(u,e);return+r>=+o?n+1:+r>=+l?n:n-1}function Ah(t,e){var o,u,l,c;const r=Gs(),n=(e==null?void 0:e.firstWeekContainsDate)??((u=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((c=(l=r.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??1,s=_c(t,e),a=pr((e==null?void 0:e.in)||t,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),Bn(a,e)}function vh(t,e){const r=Mt(t,e==null?void 0:e.in),n=+Bn(r,e)-+Ah(r,e);return Math.round(n/yc)+1}function _e(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const yr={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return _e(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):_e(r+1,2)},d(t,e){return _e(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return _e(t.getHours()%12||12,e.length)},H(t,e){return _e(t.getHours(),e.length)},m(t,e){return _e(t.getMinutes(),e.length)},s(t,e){return _e(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return _e(s,e.length)}},hn={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},xc={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return yr.y(t,e)},Y:function(t,e,r,n){const s=_c(t,n),a=s>0?s:1-s;if(e==="YY"){const i=a%100;return _e(i,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):_e(a,e.length)},R:function(t,e){const r=bc(t);return _e(r,e.length)},u:function(t,e){const r=t.getFullYear();return _e(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return _e(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return _e(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return yr.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return _e(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=vh(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):_e(s,e.length)},I:function(t,e,r){const n=bh(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):_e(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):yr.d(t,e)},D:function(t,e,r){const n=wh(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):_e(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return _e(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return _e(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return _e(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=hn.noon:n===0?s=hn.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=hn.evening:n>=12?s=hn.afternoon:n>=4?s=hn.morning:s=hn.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return yr.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):yr.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):_e(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):_e(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):yr.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):yr.s(t,e)},S:function(t,e){return yr.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Sc(n);case"XXXX":case"XX":return jr(n);case"XXXXX":case"XXX":default:return jr(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return Sc(n);case"xxxx":case"xx":return jr(n);case"xxxxx":case"xxx":default:return jr(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Tc(n,":");case"OOOO":default:return"GMT"+jr(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Tc(n,":");case"zzzz":default:return"GMT"+jr(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return _e(n,e.length)},T:function(t,e,r){return _e(+t,e.length)}};function Tc(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+e+_e(a,2)}function Sc(t,e){return t%60===0?(t>0?"-":"+")+_e(Math.abs(t)/60,2):jr(t,e)}function jr(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=_e(Math.trunc(n/60),2),a=_e(n%60,2);return r+s+e+a}const Ec=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},kc=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},_h={p:kc,P:(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Ec(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",Ec(n,e)).replace("{{time}}",kc(s,e))}},xh=/^D+$/,Th=/^Y+$/,Sh=["D","DD","YY","YYYY"];function Eh(t){return xh.test(t)}function kh(t){return Th.test(t)}function Oh(t,e,r){const n=Ph(t,e,r);if(console.warn(n),Sh.includes(t))throw new RangeError(n)}function Ph(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Mh=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ch=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ih=/^'([^]*?)'?$/,Nh=/''/g,Dh=/[a-zA-Z]/;function Rh(t,e,r){var c,m,d,w;const n=Gs(),s=n.locale??yh,a=n.firstWeekContainsDate??((m=(c=n.locale)==null?void 0:c.options)==null?void 0:m.firstWeekContainsDate)??1,i=n.weekStartsOn??((w=(d=n.locale)==null?void 0:d.options)==null?void 0:w.weekStartsOn)??0,o=Mt(t,r==null?void 0:r.in);if(!Fd(o))throw new RangeError("Invalid time value");let u=e.match(Ch).map(A=>{const f=A[0];if(f==="p"||f==="P"){const g=_h[f];return g(A,s.formatLong)}return A}).join("").match(Mh).map(A=>{if(A==="''")return{isToken:!1,value:"'"};const f=A[0];if(f==="'")return{isToken:!1,value:Lh(A)};if(xc[f])return{isToken:!0,value:A};if(f.match(Dh))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:A}});s.localize.preprocessor&&(u=s.localize.preprocessor(o,u));const l={firstWeekContainsDate:a,weekStartsOn:i,locale:s};return u.map(A=>{if(!A.isToken)return A.value;const f=A.value;(kh(f)||Eh(f))&&Oh(f,e,String(t));const g=xc[f[0]];return g(o,f,s.localize,l)}).join("")}function Lh(t){const e=t.match(Ih);return e?e[1].replace(Nh,"'"):t}function Gn(){return Rh(new Date,"OOOO")}const $h=13,Oc="abcdefghijklmnopqrstuvwxyz0123456789",Fh=Oc.length;function jh(){let t="";for(let e=0;e<$h;e++)t+=Oc.charAt(Math.floor(Math.random()*Fh));return t}function Zs(t,e){if(typeof t=="string"&&(t=Uh(t.trim())),!t)return;const r=t.searchParams.toString()||void 0;let n=t.hostname;return n=n.replace(/^(m|mobile|amp|www|www1|www2|www3|tab|item|checkout|secure|user|account|accounts|web|app|open|i|v|preview|cdn|l|id|nid|user|sso|signin|login|auth0|play|api|click|detail|dashboard|console|manage|support|help)\./,"").replace(/.*\.zoom\.us/,"zoom.us").replace(/.*\.slack\.com/,"slack.com").replace(/.*\.wikipedia\.org/,"wikipedia.org").replace(/.*\.amazonaws\.com/,"amazonaws.com").replace(/.*\.netsuite\.com/,"netsuite.com").replace(/.*\.tumblr\.com/,"tumblr.com").replace(/.*\.deviantart\.com/,"deviantart.com"),{hostname:n,path:Vh(t.pathname),query:r}}function Uh(t){if(!t)return;const e=r=>{const n=new URL(r);if(!/^https?:/.test(n.protocol))throw Error("Invalid URL, ignored protocol found");if(!n.hostname)throw Error("Invalid URL, no hostname");if(n.hostname.lastIndexOf(".")>=n.hostname.length-2)throw Error("Invalid URL, bad domain ending");return n};try{return e(t)}catch{}if(!t.includes("://"))try{return e("https://"+t)}catch{}}function Vh(t){return t.endsWith("/")?t.substring(0,Math.max(1,t.length-1)):t}const Wh=new Error("request for lock canceled");var Bh=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(c){try{l(n.next(c))}catch(m){i(m)}}function u(c){try{l(n.throw(c))}catch(m){i(m)}}function l(c){c.done?a(c.value):s(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};class qh{constructor(e,r=Wh){this._value=e,this._cancelError=r,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((r,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:r,reject:n}),this._dispatch()})}runExclusive(e,r=1){return Bh(this,void 0,void 0,function*(){const[n,s]=yield this.acquire(r);try{return yield e(n)}finally{s()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(r=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(r),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(r=>r.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let r=this._value;r>0;r--){const n=(e=this._weightedQueues[r-1])===null||e===void 0?void 0:e.shift();if(!n)continue;const s=this._value,a=r;this._value-=r,r=this._value+1,n.resolve([s,this._newReleaser(a)])}this._drainUnlockWaiters()}_newReleaser(e){let r=!1;return()=>{r||(r=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(r=>r()),this._weightedWaiters[e-1]=[])}}var Hh=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(c){try{l(n.next(c))}catch(m){i(m)}}function u(c){try{l(n.throw(c))}catch(m){i(m)}}function l(c){c.done?a(c.value):s(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};class Gh{constructor(e){this._semaphore=new qh(1,e)}acquire(){return Hh(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const Yh=new Gh,Zh="local:installId",Pc="local:install-id";function Yn(){return Yh.runExclusive(async()=>{const t=await dn.getItem(Pc),e=await dn.getItem(Zh);if(t&&e)return t;if(e)return e;if(t)return t;const r=jh();return await dn.setItem(Pc,r),r})}var Mc={exports:{}};(function(t,e){(function(r,n){n(t)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Pt,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const n="The message port closed before a response was received.",s=a=>{const i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(i).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(T,_=void 0){super(_),this.createItem=T}get(T){return this.has(T)||this.set(T,this.createItem(T)),super.get(T)}}const u=y=>y&&typeof y=="object"&&typeof y.then=="function",l=(y,T)=>(..._)=>{a.runtime.lastError?y.reject(new Error(a.runtime.lastError.message)):T.singleCallbackArg||_.length<=1&&T.singleCallbackArg!==!1?y.resolve(_[0]):y.resolve(_)},c=y=>y==1?"argument":"arguments",m=(y,T)=>function(P,...N){if(N.length<T.minArgs)throw new Error(`Expected at least ${T.minArgs} ${c(T.minArgs)} for ${y}(), got ${N.length}`);if(N.length>T.maxArgs)throw new Error(`Expected at most ${T.maxArgs} ${c(T.maxArgs)} for ${y}(), got ${N.length}`);return new Promise((U,G)=>{if(T.fallbackToNoCallback)try{P[y](...N,l({resolve:U,reject:G},T))}catch(I){console.warn(`${y} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,I),P[y](...N),T.fallbackToNoCallback=!1,T.noCallback=!0,U()}else T.noCallback?(P[y](...N),U()):P[y](...N,l({resolve:U,reject:G},T))})},d=(y,T,_)=>new Proxy(T,{apply(P,N,U){return _.call(N,y,...U)}});let w=Function.call.bind(Object.prototype.hasOwnProperty);const A=(y,T={},_={})=>{let P=Object.create(null),N={has(G,I){return I in y||I in P},get(G,I,K){if(I in P)return P[I];if(!(I in y))return;let L=y[I];if(typeof L=="function")if(typeof T[I]=="function")L=d(y,y[I],T[I]);else if(w(_,I)){let H=m(I,_[I]);L=d(y,y[I],H)}else L=L.bind(y);else if(typeof L=="object"&&L!==null&&(w(T,I)||w(_,I)))L=A(L,T[I],_[I]);else if(w(_,"*"))L=A(L,T[I],_["*"]);else return Object.defineProperty(P,I,{configurable:!0,enumerable:!0,get(){return y[I]},set(H){y[I]=H}}),L;return P[I]=L,L},set(G,I,K,L){return I in P?P[I]=K:y[I]=K,!0},defineProperty(G,I,K){return Reflect.defineProperty(P,I,K)},deleteProperty(G,I){return Reflect.deleteProperty(P,I)}},U=Object.create(y);return new Proxy(U,N)},f=y=>({addListener(T,_,...P){T.addListener(y.get(_),...P)},hasListener(T,_){return T.hasListener(y.get(_))},removeListener(T,_){T.removeListener(y.get(_))}}),g=new o(y=>typeof y!="function"?y:function(_){const P=A(_,{},{getContent:{minArgs:0,maxArgs:0}});y(P)}),b=new o(y=>typeof y!="function"?y:function(_,P,N){let U=!1,G,I=new Promise(W=>{G=function(O){U=!0,W(O)}}),K;try{K=y(_,P,G)}catch(W){K=Promise.reject(W)}const L=K!==!0&&u(K);if(K!==!0&&!L&&!U)return!1;const H=W=>{W.then(O=>{N(O)},O=>{let Z;O&&(O instanceof Error||typeof O.message=="string")?Z=O.message:Z="An unexpected error occurred",N({__mozWebExtensionPolyfillReject__:!0,message:Z})}).catch(O=>{console.error("Failed to send onMessage rejected reply",O)})};return H(L?K:I),!0}),S=({reject:y,resolve:T},_)=>{a.runtime.lastError?a.runtime.lastError.message===n?T():y(new Error(a.runtime.lastError.message)):_&&_.__mozWebExtensionPolyfillReject__?y(new Error(_.message)):T(_)},x=(y,T,_,...P)=>{if(P.length<T.minArgs)throw new Error(`Expected at least ${T.minArgs} ${c(T.minArgs)} for ${y}(), got ${P.length}`);if(P.length>T.maxArgs)throw new Error(`Expected at most ${T.maxArgs} ${c(T.maxArgs)} for ${y}(), got ${P.length}`);return new Promise((N,U)=>{const G=S.bind(null,{resolve:N,reject:U});P.push(G),_.sendMessage(...P)})},E={devtools:{network:{onRequestFinished:f(g)}},runtime:{onMessage:f(b),onMessageExternal:f(b),sendMessage:x.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:x.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},C={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":C},services:{"*":C},websites:{"*":C}},A(a,E,i)};r.exports=s(chrome)}})})(Mc);var zh=Mc.exports;const Zn=Fr(zh),Ur=(t,e,r)=>Zn.i18n.getMessage(t,e,r);function gt(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function er(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function Kh(t,e){const r=gt(t);return isNaN(e)?er(t,NaN):(r.setDate(r.getDate()+e),r)}const Cc=6048e5,Xh=864e5;let Jh={};function zs(){return Jh}function zn(t,e){var o,u,l,c;const r=zs(),n=(e==null?void 0:e.weekStartsOn)??((u=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((c=(l=r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??0,s=gt(t),a=s.getDay(),i=(a<n?7:0)+a-n;return s.setDate(s.getDate()-i),s.setHours(0,0,0,0),s}function Ks(t){return zn(t,{weekStartsOn:1})}function Ic(t){const e=gt(t),r=e.getFullYear(),n=er(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=Ks(n),a=er(t,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const i=Ks(a);return e.getTime()>=s.getTime()?r+1:e.getTime()>=i.getTime()?r:r-1}function fn(t){const e=gt(t);return e.setHours(0,0,0,0),e}function Nc(t){const e=gt(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function Qh(t,e){const r=fn(t),n=fn(e),s=+r-Nc(r),a=+n-Nc(n);return Math.round((s-a)/Xh)}function ef(t){const e=Ic(t),r=er(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),Ks(r)}function Dc(t){return er(t,Date.now())}function Rc(t,e){const r=fn(t),n=fn(e);return+r==+n}function tf(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function rf(t){if(!tf(t)&&typeof t!="number")return!1;const e=gt(t);return!isNaN(Number(e))}function nf(t){const e=gt(t),r=er(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}const sf={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},af=(t,e,r)=>{let n;const s=sf[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function li(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const of={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},cf={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},uf={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},lf={date:li({formats:of,defaultWidth:"full"}),time:li({formats:cf,defaultWidth:"full"}),dateTime:li({formats:uf,defaultWidth:"full"})},df={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},hf=(t,e,r,n)=>df[t];function Kn(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,o=r!=null&&r.width?String(r.width):i;s=t.formattingValues[o]||t.formattingValues[i]}else{const i=t.defaultWidth,o=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[o]||t.values[i]}const a=t.argumentCallback?t.argumentCallback(e):e;return s[a]}}const ff={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},mf={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},gf={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},pf={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},yf={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wf={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bf={ordinalNumber:(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:Kn({values:ff,defaultWidth:"wide"}),quarter:Kn({values:mf,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Kn({values:gf,defaultWidth:"wide"}),day:Kn({values:pf,defaultWidth:"wide"}),dayPeriod:Kn({values:yf,defaultWidth:"wide",formattingValues:wf,defaultFormattingWidth:"wide"})};function Xn(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(s);if(!a)return null;const i=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(o)?vf(o,m=>m.test(i)):Af(o,m=>m.test(i));let l;l=t.valueCallback?t.valueCallback(u):u,l=r.valueCallback?r.valueCallback(l):l;const c=e.slice(i.length);return{value:l,rest:c}}}function Af(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function vf(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function _f(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],a=e.match(t.parsePattern);if(!a)return null;let i=t.valueCallback?t.valueCallback(a[0]):a[0];i=r.valueCallback?r.valueCallback(i):i;const o=e.slice(s.length);return{value:i,rest:o}}}const xf=/^(\d+)(th|st|nd|rd)?/i,Tf=/\d+/i,Sf={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ef={any:[/^b/i,/^(a|c)/i]},kf={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Of={any:[/1/i,/2/i,/3/i,/4/i]},Pf={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Mf={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Cf={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},If={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Nf={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Df={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Rf={ordinalNumber:_f({matchPattern:xf,parsePattern:Tf,valueCallback:t=>parseInt(t,10)}),era:Xn({matchPatterns:Sf,defaultMatchWidth:"wide",parsePatterns:Ef,defaultParseWidth:"any"}),quarter:Xn({matchPatterns:kf,defaultMatchWidth:"wide",parsePatterns:Of,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Xn({matchPatterns:Pf,defaultMatchWidth:"wide",parsePatterns:Mf,defaultParseWidth:"any"}),day:Xn({matchPatterns:Cf,defaultMatchWidth:"wide",parsePatterns:If,defaultParseWidth:"any"}),dayPeriod:Xn({matchPatterns:Nf,defaultMatchWidth:"any",parsePatterns:Df,defaultParseWidth:"any"})},Lf={code:"en-US",formatDistance:af,formatLong:lf,formatRelative:hf,localize:bf,match:Rf,options:{weekStartsOn:0,firstWeekContainsDate:1}};function $f(t){const e=gt(t);return Qh(e,nf(e))+1}function Ff(t){const e=gt(t),r=+Ks(e)-+ef(e);return Math.round(r/Cc)+1}function Lc(t,e){var c,m,d,w;const r=gt(t),n=r.getFullYear(),s=zs(),a=(e==null?void 0:e.firstWeekContainsDate)??((m=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:m.firstWeekContainsDate)??s.firstWeekContainsDate??((w=(d=s.locale)==null?void 0:d.options)==null?void 0:w.firstWeekContainsDate)??1,i=er(t,0);i.setFullYear(n+1,0,a),i.setHours(0,0,0,0);const o=zn(i,e),u=er(t,0);u.setFullYear(n,0,a),u.setHours(0,0,0,0);const l=zn(u,e);return r.getTime()>=o.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function jf(t,e){var o,u,l,c;const r=zs(),n=(e==null?void 0:e.firstWeekContainsDate)??((u=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((c=(l=r.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??1,s=Lc(t,e),a=er(t,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),zn(a,e)}function Uf(t,e){const r=gt(t),n=+zn(r,e)-+jf(r,e);return Math.round(n/Cc)+1}function xe(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const wr={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return xe(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):xe(r+1,2)},d(t,e){return xe(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return xe(t.getHours()%12||12,e.length)},H(t,e){return xe(t.getHours(),e.length)},m(t,e){return xe(t.getMinutes(),e.length)},s(t,e){return xe(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return xe(s,e.length)}},mn={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$c={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return wr.y(t,e)},Y:function(t,e,r,n){const s=Lc(t,n),a=s>0?s:1-s;if(e==="YY"){const i=a%100;return xe(i,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):xe(a,e.length)},R:function(t,e){const r=Ic(t);return xe(r,e.length)},u:function(t,e){const r=t.getFullYear();return xe(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return xe(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return xe(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return wr.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return xe(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=Uf(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):xe(s,e.length)},I:function(t,e,r){const n=Ff(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):xe(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):wr.d(t,e)},D:function(t,e,r){const n=$f(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):xe(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return xe(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return xe(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return xe(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=mn.noon:n===0?s=mn.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=mn.evening:n>=12?s=mn.afternoon:n>=4?s=mn.morning:s=mn.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return wr.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):wr.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):xe(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):xe(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):wr.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):wr.s(t,e)},S:function(t,e){return wr.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return jc(n);case"XXXX":case"XX":return Vr(n);case"XXXXX":case"XXX":default:return Vr(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return jc(n);case"xxxx":case"xx":return Vr(n);case"xxxxx":case"xxx":default:return Vr(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Fc(n,":");case"OOOO":default:return"GMT"+Vr(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Fc(n,":");case"zzzz":default:return"GMT"+Vr(n,":")}},t:function(t,e,r){const n=Math.trunc(t.getTime()/1e3);return xe(n,e.length)},T:function(t,e,r){const n=t.getTime();return xe(n,e.length)}};function Fc(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+e+xe(a,2)}function jc(t,e){return t%60===0?(t>0?"-":"+")+xe(Math.abs(t)/60,2):Vr(t,e)}function Vr(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=xe(Math.trunc(n/60),2),a=xe(n%60,2);return r+s+e+a}const Uc=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Vc=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Vf={p:Vc,P:(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Uc(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",Uc(n,e)).replace("{{time}}",Vc(s,e))}},Wf=/^D+$/,Bf=/^Y+$/,qf=["D","DD","YY","YYYY"];function Hf(t){return Wf.test(t)}function Gf(t){return Bf.test(t)}function Yf(t,e,r){const n=Zf(t,e,r);if(console.warn(n),qf.includes(t))throw new RangeError(n)}function Zf(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const zf=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Kf=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Xf=/^'([^]*?)'?$/,Jf=/''/g,Qf=/[a-zA-Z]/;function di(t,e,r){var c,m,d,w;const n=zs(),s=n.locale??Lf,a=n.firstWeekContainsDate??((m=(c=n.locale)==null?void 0:c.options)==null?void 0:m.firstWeekContainsDate)??1,i=n.weekStartsOn??((w=(d=n.locale)==null?void 0:d.options)==null?void 0:w.weekStartsOn)??0,o=gt(t);if(!rf(o))throw new RangeError("Invalid time value");let u=e.match(Kf).map(A=>{const f=A[0];if(f==="p"||f==="P"){const g=Vf[f];return g(A,s.formatLong)}return A}).join("").match(zf).map(A=>{if(A==="''")return{isToken:!1,value:"'"};const f=A[0];if(f==="'")return{isToken:!1,value:em(A)};if($c[f])return{isToken:!0,value:A};if(f.match(Qf))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:A}});s.localize.preprocessor&&(u=s.localize.preprocessor(o,u));const l={firstWeekContainsDate:a,weekStartsOn:i,locale:s};return u.map(A=>{if(!A.isToken)return A.value;const f=A.value;(Gf(f)||Hf(f))&&Yf(f,e,String(t));const g=$c[f[0]];return g(o,f,s.localize,l)}).join("")}function em(t){const e=t.match(Xf);return e?e[1].replace(Jf,"'"):t}function tm(t,e){const r=gt(t),n=gt(e);return r.getFullYear()===n.getFullYear()}function rm(t){return Rc(t,Dc(t))}function nm(t,e){return Kh(t,-1)}function sm(t){return Rc(t,nm(Dc(t)))}function am(){return fn(Date.now())}function im(){const t=new Date,e=t.getFullYear(),r=t.getMonth(),n=t.getDate(),s=new Date(0);return s.setFullYear(e,r,n-1),s.setHours(0,0,0,0),s}function Wc(t){return t.reduce((e,r)=>Math.min(e,r),Number.POSITIVE_INFINITY)}function Bc(t){return t.reduce((e,r)=>Math.max(e,r),Number.NEGATIVE_INFINITY)}const om="HH:mm",cm="h:mm a",um="h a";class Ct{constructor(e){ce(this,"_ms");this._ms=e instanceof Ct?e.ms:e instanceof Date?e.getTime():e??Date.now()}get ms(){return this._ms}get seconds(){return this._ms/1e3}get minutes(){return this.seconds/60}get hours(){return this.minutes/60}get days(){return this.hours/24}get weeks(){return this.days/7}get months(){return this.days/30}get years(){return this.days/365}get startOfDay(){const e=this.toJsDate();return e.setHours(0,0,0,0),new Ct(e.getTime())}add(e){return new Ct(this._ms+e.ms)}plus(e){return this.add(e)}subtract(e){return new Ct(this._ms-e.ms)}minus(e){return this.subtract(e)}isBefore(e,r=!1){return r?this._ms<=e.ms:this._ms<e.ms}isAfter(e,r=!1){return r?this._ms>=e.ms:this._ms>e.ms}since(e=new Ct){return new Bt(this._ms-e.ms)}toJsDate(){return new Date(this._ms)}toString(){return this.toJsDate().toISOString()}copy(){return new Ct(this._ms)}}var he=(t=>(t[t.Millisecond=1]="Millisecond",t[t.Second=1e3]="Second",t[t.Minute=6e4]="Minute",t[t.Hour=36e5]="Hour",t[t.Day=864e5]="Day",t[t.Week=6048e5]="Week",t[t.Month=2592e6]="Month",t[t.Year=31536e6]="Year",t))(he||{}),Xs=(t=>(t[t.Second=1]="Second",t[t.Minute=60]="Minute",t[t.Hour=3600]="Hour",t[t.Day=86400]="Day",t))(Xs||{});const Ee=class Ee{constructor(...e){ce(this,"ms");this.ms=e.length===1?e[0]:e[0]*e[1]}get seconds(){return this.ms/1e3}get minutes(){return this.ms/6e4}get hours(){return this.ms/36e5}get days(){return this.ms/864e5}get weeks(){return this.ms/6048e5}get months(){return this.ms/2592e6}get years(){return this.ms/31536e6}add(e){return new Ee(this.ms+e.ms)}plus(e){return this.add(e)}subtract(e){return new Ee(this.ms-e.ms)}minus(e){return this.subtract(e)}clamp(e,r){return new Ee(Math.min(Math.max(this.ms,e.ms),r.ms))}isEqual(e){return this.ms===e.ms}parse(){const e=Math.floor(this.ms/1e3),r=Math.floor(e/60);return{hours:Math.floor(r/60),minutes:r%60,seconds:e%60}}format(){const e=Math.floor(this.ms/1e3),r=Math.floor(e/60),n=Math.floor(r/60);return n>0?`${n}:${String(r%60).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`:r>0?`${r}:${String(e%60).padStart(2,"0")}`:`0:${String(e).padStart(2,"0")}`}formatString(e){const{seconds:r,minutes:n,hours:s}=this.parse();if(e!=null&&e.excludeTrailingZeros){const a=[s&&`${s}h`,(s||n)&&`${n}m`,`${r}s`];return r===0&&(a.pop(),n===0&&a.pop()),a.filter(i=>!!i).join(" ")}else return s>0?`${s}h ${n}m ${r}s`:n>0?`${n}m ${r}s`:`${r}s`}toString(){return`${this.ms}ms`}copy(){return new Ee(this.ms)}};ce(Ee,"ZERO",new Ee(0)),ce(Ee,"MS",new Ee(1,1)),ce(Ee,"SECOND",new Ee(1,1e3)),ce(Ee,"MINUTE",new Ee(1,6e4)),ce(Ee,"HOUR",new Ee(1,36e5)),ce(Ee,"DAY",new Ee(1,864e5)),ce(Ee,"WEEK",new Ee(1,6048e5)),ce(Ee,"MONTH",new Ee(1,2592e6)),ce(Ee,"YEAR",new Ee(1,31536e6)),ce(Ee,"INFINITY",new Ee(1/0));let Bt=Ee;function qc(t,e){const r={hours:t.getHours(),minutes:t.getMinutes()};return dm(e)?mi(r,e.start,{hours:23,minutes:59})||mi(r,{hours:0,minutes:0},e.end):mi(r,e.start,e.end)}function lm(t,e){t[0]>t[1]&&t.sort(),e[0]>e[1]&&e.sort();const[r,n]=t[0]<=e[0]?[t,e]:[e,t];return n[0]>=r[0]&&n[0]<r[1]?n[1]<=r[1]?n[1]-n[0]:r[1]-n[0]:0}function hi(t,e=!0){if(rm(t))return Ur("today");if(e&&sm(t))return Ur("yesterday");const r=gn();return t>=r-6*he.Day?di(t,"eeee"):tm(t,r)?di(t,"eee, MMM d"):new Date(t).toLocaleDateString()}function fi(t,e,r){return{*[Symbol.iterator](){for(let n=t;n<e;n=n+r)yield n}}}function Hc(t,e,r){const n=gn()+r,s=r+(Date.now()<n?-24*he.Hour:0);return[t+s,e+s]}function mi(t,e,r){return t.hours>e.hours&&t.hours<r.hours?!0:t.hours===e.hours&&t.hours===r.hours?t.minutes>=e.minutes&&t.minutes<=r.minutes:t.hours===e.hours&&t.minutes>=e.minutes||t.hours===r.hours&&t.minutes<=r.minutes}function dm(t){return t.start.hours===t.end.hours&&t.start.minutes>=t.end.minutes||t.start.hours>t.end.hours}function hm(t,e,r){const n=Math.max(1,r)*he.Day;return Array.from(fi(t,e,n)).map(s=>{let a=s+n;return a>=e&&(a=e),{startDate:s,endDate:a}})}function gi(t){const e=new Date(`2021-01-01T${t}`).getTime(),r=Yc(e).parse();return{hours:r.hours,minutes:r.minutes}}function Gc(t){return Math.round(t/1e3)}function fm(t,e){const n=(e!=null&&e.baseTime?Js(e.baseTime):gn())+t;return mm(n,e)}function mm(t,e){const r=Yc(t);let n;if(e!=null&&e.is24HourFormat)n=om;else{if(r.ms===0)return Ur("midnight");if(r.ms===12*he.Hour)return Ur("noon");n=gm(r.ms,he.Hour)?um:cm}return di(t,n)}function gm(t,e){return t%e===0}function gn(){return am().getTime()}function Js(t){return fn(t).getTime()}function Yc(t){return new Bt(t-Js(t))}function Zc(t,e){const r=dn.defineItem(t,{...e,fallback:null}),{serialize:n,deserialize:s}=pm[e.serializer];return{...r,get fallback(){return e.fallback},get defaultValue(){return e.fallback},getValue:async()=>{const a=await r.getValue();return a==null?null:s(a)},setValue:async a=>r.setValue(n(a)),watch:a=>r.watch((i,o)=>{const u=i==null?e.fallback:s(i),l=o==null?e.fallback:s(o);a(u,l)})}}const pm={time:{serialize:t=>t.ms,deserialize:t=>new Ct(t)},duration:{serialize:t=>t.ms,deserialize:t=>new Bt(t)},map:{serialize:t=>JSON.stringify(Array.from(t.entries())),deserialize:t=>new Map(JSON.parse(t))}};function Qs(t,e,r){let n=_l.getValue();_l.watch(a=>{n=Promise.resolve(a)});const s=async()=>await n?t:e;return{get fallback(){return r},get defaultValue(){return r},async getValue(...a){return await(await s()).getValue(...a)??r},async setValue(...a){return await(await s()).setValue(...a)},async removeValue(...a){return await(await s()).removeValue(...a)},async getMeta(...a){return await(await s()).getMeta(...a)},async setMeta(...a){return await(await s()).setMeta(...a)},async removeMeta(...a){return await(await s()).removeMeta(...a)},watch(a){const i=t.watch(async(u,l)=>{if(await n)return a(u??r,l??r)}),o=e.watch(async(u,l)=>{if(!await n)return a(u??r,l??r)});return()=>{i(),o()}},async migrate(){await Promise.all([t.migrate(),e.migrate()])}}}function ie(t,e,r=!1){return dn.defineItem(zc(t,r),e)}function Ne(t,e=!1){return dn.defineItem(zc(t,e))}function zc(t,e){return e?ym(t):pi(t)}const pi=t=>`local:${t}`,ym=t=>`sync:${t}`;function yi(t,e){if(!(!t||typeof t!="string"))return e()}const wm="@stayfocusd/sessions-last-uploaded-at-key",bm="@stayfocusd/page-views-last-uploaded-at-key-2";var Kc=(t=>(t[t.Sessions=wm]="Sessions",t[t.PageViews=bm]="PageViews",t))(Kc||{}),R=(t=>(t.Timers="timers",t.ResetTime="resetTime",t.FirstSensorTowerInstallDate="firstSensorTowerInstallDate",t.ResetTimeQueue="resetTimeQueue",t.AppGroups="app-groups",t.ActiveHours="activeHours",t.ActiveHoursQueue="activeHoursQueue",t.ActiveDays="activeDays",t.CurrentUrl="currentUrl",t.CurrentTabId="currentTabId",t.UrlsBeforeBlockedStorage="urlsBeforeBlockedStorage",t.LastResetTime="lastResetTime",t.Theme="theme",t.DisableSync="disableSync",t.BlockAllWebsitesAllowedTime="blockAllWebsitesAllowedTime",t.DisableUpdatePopup="disableUpdatePopup",t.Activated="activated",t.HasAcceptedToS="hasAcceptedToS",t.HasAcceptedPrivacyPolicy="hasAcceptedPrivacyPolicy",t.Is18OrOlder="is18OrOlder",t.Age="age",t.PromptBirthYearAt="promptBirthYearAt",t.PromptBirthYearInterval="promptBirthYearInterval",t.PromptReview="promptReview",t.PromptReviewAt="promptReviewAt",t.PromptReviewInterval="promptReviewInterval",t.ExplicitlyDeclinedPrivacyPolicy="explicitlyDeclinedPrivacyPolicy",t.ShowOnboardingAgainAt="showOnboardingAgainAt",t.ShowOnboardingAgainCount="showOnboardingAgainCount",t.ChallengeRequired="challengeRequired",t.HideAllowSiteLink="hideAllowSiteLink",t.ChallengeText="challengeText",t.Whitelist="whitelist",t.RemoteConfig="remoteConfig",t.RemoteConfigLastFetchedAt="remoteConfigLastFetchedAt",t.CustomStayFocusdMsg="customStayFocusdMsg",t.IsActivateSwitchShown="isActivateSwitchShown",t.ShowedInitialTutorial="showedInitialTutorial",t.StayFreePairingPromoDismissedStorage="stayfreePairingPromoDismissedStorage",t.NotificationSettings="notificationSettings",t.TrackTabsPlayingAudio="trackTabsPlayingAudio",t.NuclearQueue="nuclearQueue",t.BlockedGroups="blockedGroups",t.WhitelistNew="whitelistNew",t.YoutubeShortsHidden="youtube/shorts-hidden",t.YoutubeHomePageHidden="youtube/home-page-hidden",t.YoutubeCommentsHidden="youtube/comments-hidden",t.YoutubeTopBarHidden="youtube/top-bar-hidden",t.YoutubeRecommendedHidden="youtube/recommended-hidden",t.YoutubeEndCardsDisabled="youtube/end-cards-disabled",t.YoutubeBlackWhiteMode="youtube/black-white-mode",t.YoutubeAutoplayDisabled="youtube/autoplay-disabled",t.YoutubeSubscriptionsHidden="youtube/subscriptions-hidden",t.YoutubeExploreHidden="youtube/explore-hidden",t.YoutubeTrendsHidden="youtube/trends-hidden",t.TiktokExploreTabHidden="tiktok/tab-hidden",t.TiktokLiveTabHidden="tiktok/live-tab-hidden",t.TiktokCommentsTabHidden="tiktok/comments-hidden",t.TiktokSearchTabHidden="tiktok/search-hidden",t.TikTokBlackWhiteMode="tiktok/black-white-mode",t.DeviceGroup="device-group",t.IgnoredWebsites="ignored-websites",t.IgnoredApps="ignored-apps",t.IgnoredDesktopApps="ignored-desktop-apps",t[t.SessionsLastUploadedAt=Kc.Sessions]="SessionsLastUploadedAt",t))(R||{});const Am=[1,2,3,4,5,6,0],vm=he.Minute*10,_m=Am,xm={hours:3,minutes:0},Tm={start:{hours:0,minutes:0},end:{hours:23,minutes:59}},Sm=!1,Em=!1,km=!0,Om=!1,Pm=!1,Mm=!1,Cm=!0,Im=!0,Nm=[Xs.Second*5,Xs.Second*10,Xs.Minute,0,0],It=!1,Jn=!1;var qt=(t=>(t.Group="group",t.BlockAll="block-all",t.Nuclear="nuclear",t))(qt||{}),ge;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},t.getValidEnumValues=s=>{const a=t.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return t.objectValues(i)},t.objectValues=s=>t.objectKeys(s).map(function(a){return s[a]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},t.find=(s,a)=>{for(const i of s)if(a(i))return i},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(ge||(ge={}));var wi;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(wi||(wi={}));const q=ge.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),tr=t=>{switch(typeof t){case"undefined":return q.undefined;case"string":return q.string;case"number":return isNaN(t)?q.nan:q.number;case"boolean":return q.boolean;case"function":return q.function;case"bigint":return q.bigint;case"symbol":return q.symbol;case"object":return Array.isArray(t)?q.array:t===null?q.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?q.promise:typeof Map<"u"&&t instanceof Map?q.map:typeof Set<"u"&&t instanceof Set?q.set:typeof Date<"u"&&t instanceof Date?q.date:q.object;default:return q.unknown}},$=ge.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Dm=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class vt extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(a){return a.message},n={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let o=n,u=0;for(;u<i.path.length;){const l=i.path[u];u===i.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(r(i))):o[l]=o[l]||{_errors:[]},o=o[l],u++}}};return s(this),n}static assert(e){if(!(e instanceof vt))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ge.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}vt.create=t=>new vt(t);const pn=(t,e)=>{let r;switch(t.code){case $.invalid_type:t.received===q.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case $.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,ge.jsonStringifyReplacer)}`;break;case $.unrecognized_keys:r=`Unrecognized key(s) in object: ${ge.joinValues(t.keys,", ")}`;break;case $.invalid_union:r="Invalid input";break;case $.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ge.joinValues(t.options)}`;break;case $.invalid_enum_value:r=`Invalid enum value. Expected ${ge.joinValues(t.options)}, received '${t.received}'`;break;case $.invalid_arguments:r="Invalid function arguments";break;case $.invalid_return_type:r="Invalid function return type";break;case $.invalid_date:r="Invalid date";break;case $.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:ge.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case $.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case $.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case $.custom:r="Invalid input";break;case $.invalid_intersection_types:r="Intersection results could not be merged";break;case $.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case $.not_finite:r="Number must be finite";break;default:r=e.defaultError,ge.assertNever(t)}return{message:r}};let Xc=pn;function Rm(t){Xc=t}function ea(){return Xc}const ta=t=>{const{data:e,path:r,errorMaps:n,issueData:s}=t,a=[...r,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const u=n.filter(l=>!!l).slice().reverse();for(const l of u)o=l(i,{data:e,defaultError:o}).message;return{...s,path:a,message:o}},Lm=[];function V(t,e){const r=ea(),n=ta({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===pn?void 0:pn].filter(s=>!!s)});t.common.issues.push(n)}class Je{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const s of r){if(s.status==="aborted")return re;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const s of r){const a=await s.key,i=await s.value;n.push({key:a,value:i})}return Je.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const s of r){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return re;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(n[a.value]=i.value)}return{status:e.value,value:n}}}const re=Object.freeze({status:"aborted"}),yn=t=>({status:"dirty",value:t}),ut=t=>({status:"valid",value:t}),bi=t=>t.status==="aborted",Ai=t=>t.status==="dirty",Wr=t=>t.status==="valid",Qn=t=>typeof Promise<"u"&&t instanceof Promise;function ra(t,e,r,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function Jc(t,e,r,n,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r}typeof SuppressedError=="function"&&SuppressedError;var z;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(z||(z={}));var es,ts;class Ht{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Qc=(t,e)=>{if(Wr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new vt(t.common.issues);return this._error=r,this._error}}};function oe(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,o)=>{var u,l;const{message:c}=t;return i.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(u=c??n)!==null&&u!==void 0?u:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(l=c??r)!==null&&l!==void 0?l:o.defaultError}},description:s}}class ue{get description(){return this._def.description}_getType(e){return tr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:tr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Je,ctx:{common:e.parent.common,data:e.data,parsedType:tr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Qn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tr(e)},a=this._parseSync({data:e,path:s.path,parent:s});return Qc(s,a)}"~validate"(e){var r,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tr(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:s});return Wr(a)?{value:a.value}:{issues:s.common.issues}}catch(a){!((n=(r=a==null?void 0:a.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(a=>Wr(a)?{value:a.value}:{issues:s.common.issues})}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tr(e)},s=this._parse({data:e,path:n.path,parent:n}),a=await(Qn(s)?s:Promise.resolve(s));return Qc(n,a)}refine(e,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,a)=>{const i=e(s),o=()=>a.addIssue({code:$.custom,...n(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(u=>u?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new Rt({schema:this,typeName:te.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Yt.create(this,this._def)}nullable(){return _r.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Dt.create(this)}promise(){return vn.create(this,this._def)}or(e){return as.create([this,e],this._def)}and(e){return is.create(this,e,this._def)}transform(e){return new Rt({...oe(this._def),schema:this,typeName:te.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new ds({...oe(this._def),innerType:this,defaultValue:r,typeName:te.ZodDefault})}brand(){return new xi({typeName:te.ZodBranded,type:this,...oe(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new hs({...oe(this._def),innerType:this,catchValue:r,typeName:te.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return fs.create(this,e)}readonly(){return ms.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const $m=/^c[^\s-]{8,}$/i,Fm=/^[0-9a-z]+$/,jm=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Um=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Vm=/^[a-z0-9_-]{21}$/i,Wm=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Bm=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,qm=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Hm="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let vi;const Gm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ym=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Zm=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,zm=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Km=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Xm=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,eu="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Jm=new RegExp(`^${eu}$`);function tu(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Qm(t){return new RegExp(`^${tu(t)}$`)}function ru(t){let e=`${eu}T${tu(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function eg(t,e){return!!((e==="v4"||!e)&&Gm.test(t)||(e==="v6"||!e)&&Zm.test(t))}function tg(t,e){if(!Wm.test(t))return!1;try{const[r]=t.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function rg(t,e){return!!((e==="v4"||!e)&&Ym.test(t)||(e==="v6"||!e)&&zm.test(t))}class Nt extends ue{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==q.string){const a=this._getOrReturnCtx(e);return V(a,{code:$.invalid_type,expected:q.string,received:a.parsedType}),re}const n=new Je;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:$.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:$.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(e,s),i?V(s,{code:$.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&V(s,{code:$.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")qm.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"email",code:$.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")vi||(vi=new RegExp(Hm,"u")),vi.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"emoji",code:$.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")Um.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"uuid",code:$.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")Vm.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"nanoid",code:$.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")$m.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid",code:$.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")Fm.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid2",code:$.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")jm.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ulid",code:$.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),V(s,{validation:"url",code:$.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"regex",code:$.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),V(s,{code:$.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:$.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:$.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?ru(a).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:$.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?Jm.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:$.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?Qm(a).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:$.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?Bm.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"duration",code:$.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?eg(e.data,a.version)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ip",code:$.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?tg(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"jwt",code:$.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?rg(e.data,a.version)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cidr",code:$.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?Km.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"base64",code:$.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?Xm.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"base64url",code:$.invalid_string,message:a.message}),n.dirty()):ge.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:$.invalid_string,...z.errToObj(n)})}_addCheck(e){return new Nt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...z.errToObj(e)})}url(e){return this._addCheck({kind:"url",...z.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...z.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...z.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...z.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...z.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...z.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...z.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...z.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...z.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...z.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...z.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...z.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,local:(n=e==null?void 0:e.local)!==null&&n!==void 0?n:!1,...z.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...z.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...z.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...z.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...z.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...z.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...z.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...z.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...z.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...z.errToObj(r)})}nonempty(e){return this.min(1,z.errToObj(e))}trim(){return new Nt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Nt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Nt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Nt.create=t=>{var e;return new Nt({checks:[],typeName:te.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...oe(t)})};function ng(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,a=parseInt(t.toFixed(s).replace(".","")),i=parseInt(e.toFixed(s).replace(".",""));return a%i/Math.pow(10,s)}class br extends ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==q.number){const a=this._getOrReturnCtx(e);return V(a,{code:$.invalid_type,expected:q.number,received:a.parsedType}),re}let n;const s=new Je;for(const a of this._def.checks)a.kind==="int"?ge.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),V(n,{code:$.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:$.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:$.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?ng(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),V(n,{code:$.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),V(n,{code:$.not_finite,message:a.message}),s.dirty()):ge.assertNever(a);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,z.toString(r))}gt(e,r){return this.setLimit("min",e,!1,z.toString(r))}lte(e,r){return this.setLimit("max",e,!0,z.toString(r))}lt(e,r){return this.setLimit("max",e,!1,z.toString(r))}setLimit(e,r,n,s){return new br({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:z.toString(s)}]})}_addCheck(e){return new br({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:z.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:z.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:z.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:z.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:z.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ge.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}br.create=t=>new br({checks:[],typeName:te.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...oe(t)});class Ar extends ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==q.bigint)return this._getInvalidInput(e);let n;const s=new Je;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:$.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:$.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),V(n,{code:$.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):ge.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:q.bigint,received:r.parsedType}),re}gte(e,r){return this.setLimit("min",e,!0,z.toString(r))}gt(e,r){return this.setLimit("min",e,!1,z.toString(r))}lte(e,r){return this.setLimit("max",e,!0,z.toString(r))}lt(e,r){return this.setLimit("max",e,!1,z.toString(r))}setLimit(e,r,n,s){return new Ar({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:z.toString(s)}]})}_addCheck(e){return new Ar({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:z.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Ar.create=t=>{var e;return new Ar({checks:[],typeName:te.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...oe(t)})};class rs extends ue{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==q.boolean){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:q.boolean,received:n.parsedType}),re}return ut(e.data)}}rs.create=t=>new rs({typeName:te.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...oe(t)});class Br extends ue{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==q.date){const a=this._getOrReturnCtx(e);return V(a,{code:$.invalid_type,expected:q.date,received:a.parsedType}),re}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return V(a,{code:$.invalid_date}),re}const n=new Je;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:$.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:$.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):ge.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Br({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:z.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:z.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Br.create=t=>new Br({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:te.ZodDate,...oe(t)});class na extends ue{_parse(e){if(this._getType(e)!==q.symbol){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:q.symbol,received:n.parsedType}),re}return ut(e.data)}}na.create=t=>new na({typeName:te.ZodSymbol,...oe(t)});class ns extends ue{_parse(e){if(this._getType(e)!==q.undefined){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:q.undefined,received:n.parsedType}),re}return ut(e.data)}}ns.create=t=>new ns({typeName:te.ZodUndefined,...oe(t)});class ss extends ue{_parse(e){if(this._getType(e)!==q.null){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:q.null,received:n.parsedType}),re}return ut(e.data)}}ss.create=t=>new ss({typeName:te.ZodNull,...oe(t)});class wn extends ue{constructor(){super(...arguments),this._any=!0}_parse(e){return ut(e.data)}}wn.create=t=>new wn({typeName:te.ZodAny,...oe(t)});class qr extends ue{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ut(e.data)}}qr.create=t=>new qr({typeName:te.ZodUnknown,...oe(t)});class rr extends ue{_parse(e){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:q.never,received:r.parsedType}),re}}rr.create=t=>new rr({typeName:te.ZodNever,...oe(t)});class sa extends ue{_parse(e){if(this._getType(e)!==q.undefined){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:q.void,received:n.parsedType}),re}return ut(e.data)}}sa.create=t=>new sa({typeName:te.ZodVoid,...oe(t)});class Dt extends ue{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==q.array)return V(r,{code:$.invalid_type,expected:q.array,received:r.parsedType}),re;if(s.exactLength!==null){const i=r.data.length>s.exactLength.value,o=r.data.length<s.exactLength.value;(i||o)&&(V(r,{code:i?$.too_big:$.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(V(r,{code:$.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(V(r,{code:$.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,o)=>s.type._parseAsync(new Ht(r,i,r.path,o)))).then(i=>Je.mergeArray(n,i));const a=[...r.data].map((i,o)=>s.type._parseSync(new Ht(r,i,r.path,o)));return Je.mergeArray(n,a)}get element(){return this._def.type}min(e,r){return new Dt({...this._def,minLength:{value:e,message:z.toString(r)}})}max(e,r){return new Dt({...this._def,maxLength:{value:e,message:z.toString(r)}})}length(e,r){return new Dt({...this._def,exactLength:{value:e,message:z.toString(r)}})}nonempty(e){return this.min(1,e)}}Dt.create=(t,e)=>new Dt({type:t,minLength:null,maxLength:null,exactLength:null,typeName:te.ZodArray,...oe(e)});function bn(t){if(t instanceof De){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Yt.create(bn(n))}return new De({...t._def,shape:()=>e})}else return t instanceof Dt?new Dt({...t._def,type:bn(t.element)}):t instanceof Yt?Yt.create(bn(t.unwrap())):t instanceof _r?_r.create(bn(t.unwrap())):t instanceof Gt?Gt.create(t.items.map(e=>bn(e))):t}class De extends ue{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=ge.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==q.object){const l=this._getOrReturnCtx(e);return V(l,{code:$.invalid_type,expected:q.object,received:l.parsedType}),re}const{status:n,ctx:s}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof rr&&this._def.unknownKeys==="strip"))for(const l in s.data)i.includes(l)||o.push(l);const u=[];for(const l of i){const c=a[l],m=s.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new Ht(s,m,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof rr){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of o)u.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(l==="strict")o.length>0&&(V(s,{code:$.unrecognized_keys,keys:o}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of o){const m=s.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new Ht(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of u){const m=await c.key,d=await c.value;l.push({key:m,value:d,alwaysSet:c.alwaysSet})}return l}).then(l=>Je.mergeObjectSync(n,l)):Je.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(e){return z.errToObj,new De({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var s,a,i,o;const u=(i=(a=(s=this._def).errorMap)===null||a===void 0?void 0:a.call(s,r,n).message)!==null&&i!==void 0?i:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=z.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new De({...this._def,unknownKeys:"strip"})}passthrough(){return new De({...this._def,unknownKeys:"passthrough"})}extend(e){return new De({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new De({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:te.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new De({...this._def,catchall:e})}pick(e){const r={};return ge.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new De({...this._def,shape:()=>r})}omit(e){const r={};return ge.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new De({...this._def,shape:()=>r})}deepPartial(){return bn(this)}partial(e){const r={};return ge.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}),new De({...this._def,shape:()=>r})}required(e){const r={};return ge.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof Yt;)a=a._def.innerType;r[n]=a}}),new De({...this._def,shape:()=>r})}keyof(){return nu(ge.objectKeys(this.shape))}}De.create=(t,e)=>new De({shape:()=>t,unknownKeys:"strip",catchall:rr.create(),typeName:te.ZodObject,...oe(e)}),De.strictCreate=(t,e)=>new De({shape:()=>t,unknownKeys:"strict",catchall:rr.create(),typeName:te.ZodObject,...oe(e)}),De.lazycreate=(t,e)=>new De({shape:t,unknownKeys:"strip",catchall:rr.create(),typeName:te.ZodObject,...oe(e)});class as extends ue{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new vt(o.ctx.common.issues));return V(r,{code:$.invalid_union,unionErrors:i}),re}if(r.common.async)return Promise.all(n.map(async a=>{const i={...r,common:{...r.common,issues:[]},parent:null};return{result:await a._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const u of n){const l={...r,common:{...r.common,issues:[]},parent:null},c=u._parseSync({data:r.data,path:r.path,parent:l});if(c.status==="valid")return c;c.status==="dirty"&&!a&&(a={result:c,ctx:l}),l.common.issues.length&&i.push(l.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(u=>new vt(u));return V(r,{code:$.invalid_union,unionErrors:o}),re}}get options(){return this._def.options}}as.create=(t,e)=>new as({options:t,typeName:te.ZodUnion,...oe(e)});const nr=t=>t instanceof cs?nr(t.schema):t instanceof Rt?nr(t.innerType()):t instanceof us?[t.value]:t instanceof vr?t.options:t instanceof ls?ge.objectValues(t.enum):t instanceof ds?nr(t._def.innerType):t instanceof ns?[void 0]:t instanceof ss?[null]:t instanceof Yt?[void 0,...nr(t.unwrap())]:t instanceof _r?[null,...nr(t.unwrap())]:t instanceof xi||t instanceof ms?nr(t.unwrap()):t instanceof hs?nr(t._def.innerType):[];class aa extends ue{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==q.object)return V(r,{code:$.invalid_type,expected:q.object,received:r.parsedType}),re;const n=this.discriminator,s=r.data[n],a=this.optionsMap.get(s);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(V(r,{code:$.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),re)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const s=new Map;for(const a of r){const i=nr(a.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,a)}}return new aa({typeName:te.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...oe(n)})}}function _i(t,e){const r=tr(t),n=tr(e);if(t===e)return{valid:!0,data:t};if(r===q.object&&n===q.object){const s=ge.objectKeys(e),a=ge.objectKeys(t).filter(o=>s.indexOf(o)!==-1),i={...t,...e};for(const o of a){const u=_i(t[o],e[o]);if(!u.valid)return{valid:!1};i[o]=u.data}return{valid:!0,data:i}}else if(r===q.array&&n===q.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<t.length;a++){const i=t[a],o=e[a],u=_i(i,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===q.date&&n===q.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class is extends ue{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=(a,i)=>{if(bi(a)||bi(i))return re;const o=_i(a.value,i.value);return o.valid?((Ai(a)||Ai(i))&&r.dirty(),{status:r.value,value:o.data}):(V(n,{code:$.invalid_intersection_types}),re)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}is.create=(t,e,r)=>new is({left:t,right:e,typeName:te.ZodIntersection,...oe(r)});class Gt extends ue{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.array)return V(n,{code:$.invalid_type,expected:q.array,received:n.parsedType}),re;if(n.data.length<this._def.items.length)return V(n,{code:$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),re;!this._def.rest&&n.data.length>this._def.items.length&&(V(n,{code:$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const a=[...n.data].map((i,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new Ht(n,i,n.path,o)):null}).filter(i=>!!i);return n.common.async?Promise.all(a).then(i=>Je.mergeArray(r,i)):Je.mergeArray(r,a)}get items(){return this._def.items}rest(e){return new Gt({...this._def,rest:e})}}Gt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Gt({items:t,typeName:te.ZodTuple,rest:null,...oe(e)})};class os extends ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.object)return V(n,{code:$.invalid_type,expected:q.object,received:n.parsedType}),re;const s=[],a=this._def.keyType,i=this._def.valueType;for(const o in n.data)s.push({key:a._parse(new Ht(n,o,n.path,o)),value:i._parse(new Ht(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?Je.mergeObjectAsync(r,s):Je.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof ue?new os({keyType:e,valueType:r,typeName:te.ZodRecord,...oe(n)}):new os({keyType:Nt.create(),valueType:e,typeName:te.ZodRecord,...oe(r)})}}class ia extends ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.map)return V(n,{code:$.invalid_type,expected:q.map,received:n.parsedType}),re;const s=this._def.keyType,a=this._def.valueType,i=[...n.data.entries()].map(([o,u],l)=>({key:s._parse(new Ht(n,o,n.path,[l,"key"])),value:a._parse(new Ht(n,u,n.path,[l,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of i){const l=await u.key,c=await u.value;if(l.status==="aborted"||c.status==="aborted")return re;(l.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(l.value,c.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const u of i){const l=u.key,c=u.value;if(l.status==="aborted"||c.status==="aborted")return re;(l.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(l.value,c.value)}return{status:r.value,value:o}}}}ia.create=(t,e,r)=>new ia({valueType:e,keyType:t,typeName:te.ZodMap,...oe(r)});class Hr extends ue{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==q.set)return V(n,{code:$.invalid_type,expected:q.set,received:n.parsedType}),re;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(V(n,{code:$.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(V(n,{code:$.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const a=this._def.valueType;function i(u){const l=new Set;for(const c of u){if(c.status==="aborted")return re;c.status==="dirty"&&r.dirty(),l.add(c.value)}return{status:r.value,value:l}}const o=[...n.data.values()].map((u,l)=>a._parse(new Ht(n,u,n.path,l)));return n.common.async?Promise.all(o).then(u=>i(u)):i(o)}min(e,r){return new Hr({...this._def,minSize:{value:e,message:z.toString(r)}})}max(e,r){return new Hr({...this._def,maxSize:{value:e,message:z.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Hr.create=(t,e)=>new Hr({valueType:t,minSize:null,maxSize:null,typeName:te.ZodSet,...oe(e)});class An extends ue{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==q.function)return V(r,{code:$.invalid_type,expected:q.function,received:r.parsedType}),re;function n(o,u){return ta({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,ea(),pn].filter(l=>!!l),issueData:{code:$.invalid_arguments,argumentsError:u}})}function s(o,u){return ta({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,ea(),pn].filter(l=>!!l),issueData:{code:$.invalid_return_type,returnTypeError:u}})}const a={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof vn){const o=this;return ut(async function(...u){const l=new vt([]),c=await o._def.args.parseAsync(u,a).catch(w=>{throw l.addIssue(n(u,w)),l}),m=await Reflect.apply(i,this,c);return await o._def.returns._def.type.parseAsync(m,a).catch(w=>{throw l.addIssue(s(m,w)),l})})}else{const o=this;return ut(function(...u){const l=o._def.args.safeParse(u,a);if(!l.success)throw new vt([n(u,l.error)]);const c=Reflect.apply(i,this,l.data),m=o._def.returns.safeParse(c,a);if(!m.success)throw new vt([s(c,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new An({...this._def,args:Gt.create(e).rest(qr.create())})}returns(e){return new An({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new An({args:e||Gt.create([]).rest(qr.create()),returns:r||qr.create(),typeName:te.ZodFunction,...oe(n)})}}class cs extends ue{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}cs.create=(t,e)=>new cs({getter:t,typeName:te.ZodLazy,...oe(e)});class us extends ue{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return V(r,{received:r.data,code:$.invalid_literal,expected:this._def.value}),re}return{status:"valid",value:e.data}}get value(){return this._def.value}}us.create=(t,e)=>new us({value:t,typeName:te.ZodLiteral,...oe(e)});function nu(t,e){return new vr({values:t,typeName:te.ZodEnum,...oe(e)})}class vr extends ue{constructor(){super(...arguments),es.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return V(r,{expected:ge.joinValues(n),received:r.parsedType,code:$.invalid_type}),re}if(ra(this,es)||Jc(this,es,new Set(this._def.values)),!ra(this,es).has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return V(r,{received:r.data,code:$.invalid_enum_value,options:n}),re}return ut(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return vr.create(e,{...this._def,...r})}exclude(e,r=this._def){return vr.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}es=new WeakMap,vr.create=nu;class ls extends ue{constructor(){super(...arguments),ts.set(this,void 0)}_parse(e){const r=ge.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==q.string&&n.parsedType!==q.number){const s=ge.objectValues(r);return V(n,{expected:ge.joinValues(s),received:n.parsedType,code:$.invalid_type}),re}if(ra(this,ts)||Jc(this,ts,new Set(ge.getValidEnumValues(this._def.values))),!ra(this,ts).has(e.data)){const s=ge.objectValues(r);return V(n,{received:n.data,code:$.invalid_enum_value,options:s}),re}return ut(e.data)}get enum(){return this._def.values}}ts=new WeakMap,ls.create=(t,e)=>new ls({values:t,typeName:te.ZodNativeEnum,...oe(e)});class vn extends ue{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==q.promise&&r.common.async===!1)return V(r,{code:$.invalid_type,expected:q.promise,received:r.parsedType}),re;const n=r.parsedType===q.promise?r.data:Promise.resolve(r.data);return ut(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}vn.create=(t,e)=>new vn({type:t,typeName:te.ZodPromise,...oe(e)});class Rt extends ue{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===te.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:i=>{V(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(n.data,a);if(n.common.async)return Promise.resolve(i).then(async o=>{if(r.value==="aborted")return re;const u=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?re:u.status==="dirty"||r.value==="dirty"?yn(u.value):u});{if(r.value==="aborted")return re;const o=this._def.schema._parseSync({data:i,path:n.path,parent:n});return o.status==="aborted"?re:o.status==="dirty"||r.value==="dirty"?yn(o.value):o}}if(s.type==="refinement"){const i=o=>{const u=s.refinement(o,a);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?re:(o.status==="dirty"&&r.dirty(),i(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?re:(o.status==="dirty"&&r.dirty(),i(o.value).then(()=>({status:r.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Wr(i))return i;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Wr(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:r.value,value:o})):i);ge.assertNever(s)}}Rt.create=(t,e,r)=>new Rt({schema:t,typeName:te.ZodEffects,effect:e,...oe(r)}),Rt.createWithPreprocess=(t,e,r)=>new Rt({schema:e,effect:{type:"preprocess",transform:t},typeName:te.ZodEffects,...oe(r)});class Yt extends ue{_parse(e){return this._getType(e)===q.undefined?ut(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Yt.create=(t,e)=>new Yt({innerType:t,typeName:te.ZodOptional,...oe(e)});class _r extends ue{_parse(e){return this._getType(e)===q.null?ut(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}_r.create=(t,e)=>new _r({innerType:t,typeName:te.ZodNullable,...oe(e)});class ds extends ue{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===q.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}ds.create=(t,e)=>new ds({innerType:t,typeName:te.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...oe(e)});class hs extends ue{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Qn(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new vt(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new vt(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}hs.create=(t,e)=>new hs({innerType:t,typeName:te.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...oe(e)});class oa extends ue{_parse(e){if(this._getType(e)!==q.nan){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:q.nan,received:n.parsedType}),re}return{status:"valid",value:e.data}}}oa.create=t=>new oa({typeName:te.ZodNaN,...oe(t)});const sg=Symbol("zod_brand");class xi extends ue{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class fs extends ue{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?re:a.status==="dirty"?(r.dirty(),yn(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?re:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new fs({in:e,out:r,typeName:te.ZodPipeline})}}class ms extends ue{_parse(e){const r=this._def.innerType._parse(e),n=s=>(Wr(s)&&(s.value=Object.freeze(s.value)),s);return Qn(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}ms.create=(t,e)=>new ms({innerType:t,typeName:te.ZodReadonly,...oe(e)});function su(t,e){const r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function au(t,e={},r){return t?wn.create().superRefine((n,s)=>{var a,i;const o=t(n);if(o instanceof Promise)return o.then(u=>{var l,c;if(!u){const m=su(e,n),d=(c=(l=m.fatal)!==null&&l!==void 0?l:r)!==null&&c!==void 0?c:!0;s.addIssue({code:"custom",...m,fatal:d})}});if(!o){const u=su(e,n),l=(i=(a=u.fatal)!==null&&a!==void 0?a:r)!==null&&i!==void 0?i:!0;s.addIssue({code:"custom",...u,fatal:l})}}):wn.create()}const ag={object:De.lazycreate};var te;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(te||(te={}));const ig=(t,e={message:`Input not instance of ${t.name}`})=>au(r=>r instanceof t,e),Te=Nt.create,Re=br.create,og=oa.create,cg=Ar.create,ca=rs.create,ug=Br.create,lg=na.create,dg=ns.create,hg=ss.create,iu=wn.create,fg=qr.create,mg=rr.create,gg=sa.create,pg=Dt.create,xt=De.create,yg=De.strictCreate,Ti=as.create,wg=aa.create,bg=is.create,Ag=Gt.create,ou=os.create,vg=ia.create,_g=Hr.create,xg=An.create,Tg=cs.create,Sg=us.create,_n=vr.create,Eg=ls.create,kg=vn.create,cu=Rt.create,Og=Yt.create,Pg=_r.create,Mg=Rt.createWithPreprocess,Cg=fs.create;for(var X=Object.freeze({__proto__:null,defaultErrorMap:pn,setErrorMap:Rm,getErrorMap:ea,makeIssue:ta,EMPTY_PATH:Lm,addIssueToContext:V,ParseStatus:Je,INVALID:re,DIRTY:yn,OK:ut,isAborted:bi,isDirty:Ai,isValid:Wr,isAsync:Qn,get util(){return ge},get objectUtil(){return wi},ZodParsedType:q,getParsedType:tr,ZodType:ue,datetimeRegex:ru,ZodString:Nt,ZodNumber:br,ZodBigInt:Ar,ZodBoolean:rs,ZodDate:Br,ZodSymbol:na,ZodUndefined:ns,ZodNull:ss,ZodAny:wn,ZodUnknown:qr,ZodNever:rr,ZodVoid:sa,ZodArray:Dt,ZodObject:De,ZodUnion:as,ZodDiscriminatedUnion:aa,ZodIntersection:is,ZodTuple:Gt,ZodRecord:os,ZodMap:ia,ZodSet:Hr,ZodFunction:An,ZodLazy:cs,ZodLiteral:us,ZodEnum:vr,ZodNativeEnum:ls,ZodPromise:vn,ZodEffects:Rt,ZodTransformer:Rt,ZodOptional:Yt,ZodNullable:_r,ZodDefault:ds,ZodCatch:hs,ZodNaN:oa,BRAND:sg,ZodBranded:xi,ZodPipeline:fs,ZodReadonly:ms,custom:au,Schema:ue,ZodSchema:ue,late:ag,get ZodFirstPartyTypeKind(){return te},coerce:{string:t=>Nt.create({...t,coerce:!0}),number:t=>br.create({...t,coerce:!0}),boolean:t=>rs.create({...t,coerce:!0}),bigint:t=>Ar.create({...t,coerce:!0}),date:t=>Br.create({...t,coerce:!0})},any:iu,array:pg,bigint:cg,boolean:ca,date:ug,discriminatedUnion:wg,effect:cu,enum:_n,function:xg,instanceof:ig,intersection:bg,lazy:Tg,literal:Sg,map:vg,nan:og,nativeEnum:Eg,never:mg,null:hg,nullable:Pg,number:Re,object:xt,oboolean:()=>ca().optional(),onumber:()=>Re().optional(),optional:Og,ostring:()=>Te().optional(),pipeline:Cg,preprocess:Mg,promise:kg,record:ou,set:_g,strictObject:yg,string:Te,symbol:lg,transformer:cu,tuple:Ag,undefined:dg,union:Ti,unknown:fg,void:gg,NEVER:re,ZodIssueCode:$,quotelessJson:Dm,ZodError:vt}),Ge=[],Si=0;Si<256;++Si)Ge.push((Si+256).toString(16).slice(1));function Ig(t,e=0){return(Ge[t[e+0]]+Ge[t[e+1]]+Ge[t[e+2]]+Ge[t[e+3]]+"-"+Ge[t[e+4]]+Ge[t[e+5]]+"-"+Ge[t[e+6]]+Ge[t[e+7]]+"-"+Ge[t[e+8]]+Ge[t[e+9]]+"-"+Ge[t[e+10]]+Ge[t[e+11]]+Ge[t[e+12]]+Ge[t[e+13]]+Ge[t[e+14]]+Ge[t[e+15]]).toLowerCase()}var ua,Ng=new Uint8Array(16);function Dg(){if(!ua&&(ua=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ua))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ua(Ng)}var Rg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const uu={randomUUID:Rg};function gs(t,e,r){if(uu.randomUUID&&!t)return uu.randomUUID();t=t||{};var n=t.random||(t.rng||Dg)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Ig(n)}class Lg{constructor(e,r=Date.now()){this.logMethod=e,this.startedAt=r}log(e){const r=Date.now()-this.startedAt;this.logMethod(e.replace(/\{duration\}/g,`${(r/1e3).toFixed(3)}s`))}}const la=1e3,Ei=60*la,$g=60*Ei;function Fg(){return new Promise(t=>setTimeout(t,0))}function jg(t){const e=new Bs;return(...r)=>e.runExclusive(()=>t(...r))}function Ug(){let t,e;return[new Promise((n,s)=>{t=n,e=s}),t,e]}function lu(t){const e=t.objectStoreNames.length,r=[];for(let n=0;n<e;n++){const s=t.objectStoreNames.item(n);s&&r.push(s)}return r}const ki=(t,e)=>e.some(r=>t instanceof r);let du,hu;function Vg(){return du||(du=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wg(){return hu||(hu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Oi=new WeakMap,Pi=new WeakMap,da=new WeakMap;function Bg(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{r(Gr(t.result)),s()},i=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",i)});return da.set(e,t),e}function qg(t){if(Oi.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});Oi.set(t,e)}let Mi={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Oi.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Gr(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fu(t){Mi=t(Mi)}function Hg(t){return Wg().includes(t)?function(...e){return t.apply(Ci(this),e),Gr(this.request)}:function(...e){return Gr(t.apply(Ci(this),e))}}function Gg(t){return typeof t=="function"?Hg(t):(t instanceof IDBTransaction&&qg(t),ki(t,Vg())?new Proxy(t,Mi):t)}function Gr(t){if(t instanceof IDBRequest)return Bg(t);if(Pi.has(t))return Pi.get(t);const e=Gg(t);return e!==t&&(Pi.set(t,e),da.set(e,t)),e}const Ci=t=>da.get(t);function Yg(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(t,e),o=Gr(i);return n&&i.addEventListener("upgradeneeded",u=>{n(Gr(i.result),u.oldVersion,u.newVersion,Gr(i.transaction),u)}),r&&i.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),o.then(u=>{a&&u.addEventListener("close",()=>a()),s&&u.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const Zg=["get","getKey","getAll","getAllKeys","count"],zg=["put","add","delete","clear"],Ii=new Map;function mu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ii.get(e))return Ii.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=zg.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Zg.includes(r)))return;const a=async function(i,...o){const u=this.transaction(i,s?"readwrite":"readonly");let l=u.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),s&&u.done]))[0]};return Ii.set(e,a),a}fu(t=>({...t,get:(e,r,n)=>mu(e,r)||t.get(e,r,n),has:(e,r)=>!!mu(e,r)||t.has(e,r)}));const Kg=["continue","continuePrimaryKey","advance"],gu={},Ni=new WeakMap,pu=new WeakMap,Xg={get(t,e){if(!Kg.includes(e))return t[e];let r=gu[e];return r||(r=gu[e]=function(...n){Ni.set(this,pu.get(this)[e](...n))}),r}};async function*Jg(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const r=new Proxy(e,Xg);for(pu.set(r,e),da.set(r,Ci(e));e;)yield r,e=await(Ni.get(r)||e.continue()),Ni.delete(r)}function yu(t,e){return e===Symbol.asyncIterator&&ki(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&ki(t,[IDBIndex,IDBObjectStore])}fu(t=>({...t,get(e,r,n){return yu(e,r)?Jg:t.get(e,r,n)},has(e,r){return yu(e,r)||t.has(e,r)}}));var Qg=wu;function wu(t,e,r){t instanceof RegExp&&(t=bu(t,r)),e instanceof RegExp&&(e=bu(e,r));var n=Au(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function bu(t,e){var r=e.match(t);return r?r[0]:null}wu.range=Au;function Au(t,e,r){var n,s,a,i,o,u=r.indexOf(t),l=r.indexOf(e,u+1),c=u;if(u>=0&&l>0){if(t===e)return[u,l];for(n=[],a=r.length;c>=0&&!o;)c==u?(n.push(c),u=r.indexOf(t,c+1)):n.length==1?o=[n.pop(),l]:(s=n.pop(),s<a&&(a=s,i=l),l=r.indexOf(e,c+1)),c=u<l&&u>=0?u:l;n.length&&(o=[a,i])}return o}var vu=Qg,ep=np,_u="\0SLASH"+Math.random()+"\0",xu="\0OPEN"+Math.random()+"\0",Di="\0CLOSE"+Math.random()+"\0",Tu="\0COMMA"+Math.random()+"\0",Su="\0PERIOD"+Math.random()+"\0";function Ri(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function tp(t){return t.split("\\\\").join(_u).split("\\{").join(xu).split("\\}").join(Di).split("\\,").join(Tu).split("\\.").join(Su)}function rp(t){return t.split(_u).join("\\").split(xu).join("{").split(Di).join("}").split(Tu).join(",").split(Su).join(".")}function Eu(t){if(!t)return[""];var e=[],r=vu("{","}",t);if(!r)return t.split(",");var n=r.pre,s=r.body,a=r.post,i=n.split(",");i[i.length-1]+="{"+s+"}";var o=Eu(a);return a.length&&(i[i.length-1]+=o.shift(),i.push.apply(i,o)),e.push.apply(e,i),e}function np(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),ps(tp(t),!0).map(rp)):[]}function sp(t){return"{"+t+"}"}function ap(t){return/^-?0\d/.test(t)}function ip(t,e){return t<=e}function op(t,e){return t>=e}function ps(t,e){var r=[],n=vu("{","}",t);if(!n)return[t];var s=n.pre,a=n.post.length?ps(n.post,!1):[""];if(/\$$/.test(n.pre))for(var i=0;i<a.length;i++){var o=s+"{"+n.body+"}"+a[i];r.push(o)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),c=u||l,m=n.body.indexOf(",")>=0;if(!c&&!m)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+Di+n.post,ps(t)):[t];var d;if(c)d=n.body.split(/\.\./);else if(d=Eu(n.body),d.length===1&&(d=ps(d[0],!1).map(sp),d.length===1))return a.map(function(N){return n.pre+d[0]+N});var w;if(c){var A=Ri(d[0]),f=Ri(d[1]),g=Math.max(d[0].length,d[1].length),b=d.length==3?Math.abs(Ri(d[2])):1,S=ip,x=f<A;x&&(b*=-1,S=op);var E=d.some(ap);w=[];for(var C=A;S(C,f);C+=b){var y;if(l)y=String.fromCharCode(C),y==="\\"&&(y="");else if(y=String(C),E){var T=g-y.length;if(T>0){var _=new Array(T+1).join("0");C<0?y="-"+_+y.slice(1):y=_+y}}w.push(y)}}else{w=[];for(var P=0;P<d.length;P++)w.push.apply(w,ps(d[P],!1))}for(var P=0;P<w.length;P++)for(var i=0;i<a.length;i++){var o=s+w[P]+a[i];(!e||c||o)&&r.push(o)}}return r}const cp=Fr(ep),up=1024*64,ha=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>up)throw new TypeError("pattern is too long")},lp={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},ys=t=>t.replace(/[[\]\\-]/g,"\\$&"),dp=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),ku=t=>t.join(""),hp=(t,e)=>{const r=e;if(t.charAt(r)!=="[")throw new Error("not in a brace expression");const n=[],s=[];let a=r+1,i=!1,o=!1,u=!1,l=!1,c=r,m="";e:for(;a<t.length;){const f=t.charAt(a);if((f==="!"||f==="^")&&a===r+1){l=!0,a++;continue}if(f==="]"&&i&&!u){c=a+1;break}if(i=!0,f==="\\"&&!u){u=!0,a++;continue}if(f==="["&&!u){for(const[g,[b,S,x]]of Object.entries(lp))if(t.startsWith(g,a)){if(m)return["$.",!1,t.length-r,!0];a+=g.length,x?s.push(b):n.push(b),o=o||S;continue e}}if(u=!1,m){f>m?n.push(ys(m)+"-"+ys(f)):f===m&&n.push(ys(f)),m="",a++;continue}if(t.startsWith("-]",a+1)){n.push(ys(f+"-")),a+=2;continue}if(t.startsWith("-",a+1)){m=f,a+=2;continue}n.push(ys(f)),a++}if(c<a)return["",!1,0,!1];if(!n.length&&!s.length)return["$.",!1,t.length-r,!0];if(s.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!l){const f=n[0].length===2?n[0].slice(-1):n[0];return[dp(f),!1,c-r,!1]}const d="["+(l?"^":"")+ku(n)+"]",w="["+(l?"":"^")+ku(s)+"]";return[n.length&&s.length?"("+d+"|"+w+")":n.length?d:w,o,c-r,!0]},ws=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/\[([^\/\\])\]/g,"$1"):t.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1"),fp=new Set(["!","?","+","*","@"]),Ou=t=>fp.has(t),mp="(?!(?:^|/)\\.\\.?(?:$|/))",Li="(?!\\.)",gp=new Set(["[","."]),pp=new Set(["..","."]),yp=new Set("().*{}+?[]^$\\!"),wp=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),$i="[^/]",Pu=$i+"*?",Mu=$i+"+?",ht=class ht{constructor(e,r,n={}){At(this,Jr);ce(this,"type");At(this,We);At(this,He);At(this,ar,!1);At(this,Pe,[]);At(this,Ue);At(this,Tr);At(this,Kr);At(this,Sr,!1);At(this,Zt);At(this,Xr);At(this,Ps,!1);this.type=e,e&&je(this,He,!0),je(this,Ue,r),je(this,We,j(this,Ue)?j(j(this,Ue),We):this),je(this,Zt,j(this,We)===this?n:j(j(this,We),Zt)),je(this,Kr,j(this,We)===this?[]:j(j(this,We),Kr)),e==="!"&&!j(j(this,We),Sr)&&j(this,Kr).push(this),je(this,Tr,j(this,Ue)?j(j(this,Ue),Pe).length:0)}get hasMagic(){if(j(this,He)!==void 0)return j(this,He);for(const e of j(this,Pe))if(typeof e!="string"&&(e.type||e.hasMagic))return je(this,He,!0);return j(this,He)}toString(){return j(this,Xr)!==void 0?j(this,Xr):this.type?je(this,Xr,this.type+"("+j(this,Pe).map(e=>String(e)).join("|")+")"):je(this,Xr,j(this,Pe).map(e=>String(e)).join(""))}push(...e){for(const r of e)if(r!==""){if(typeof r!="string"&&!(r instanceof ht&&j(r,Ue)===this))throw new Error("invalid part: "+r);j(this,Pe).push(r)}}toJSON(){var r;const e=this.type===null?j(this,Pe).slice().map(n=>typeof n=="string"?n:n.toJSON()):[this.type,...j(this,Pe).map(n=>n.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===j(this,We)||j(j(this,We),Sr)&&((r=j(this,Ue))==null?void 0:r.type)==="!")&&e.push({}),e}isStart(){var r;if(j(this,We)===this)return!0;if(!((r=j(this,Ue))!=null&&r.isStart()))return!1;if(j(this,Tr)===0)return!0;const e=j(this,Ue);for(let n=0;n<j(this,Tr);n++){const s=j(e,Pe)[n];if(!(s instanceof ht&&s.type==="!"))return!1}return!0}isEnd(){var r,n,s;if(j(this,We)===this||((r=j(this,Ue))==null?void 0:r.type)==="!")return!0;if(!((n=j(this,Ue))!=null&&n.isEnd()))return!1;if(!this.type)return(s=j(this,Ue))==null?void 0:s.isEnd();const e=j(this,Ue)?j(j(this,Ue),Pe).length:0;return j(this,Tr)===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){const r=new ht(this.type,e);for(const n of j(this,Pe))r.copyIn(n);return r}static fromGlob(e,r={}){var s;const n=new ht(null,void 0,r);return Lr(s=ht,Er,Qa).call(s,e,n,0,r),n}toMMPattern(){if(this!==j(this,We))return j(this,We).toMMPattern();const e=this.toString(),[r,n,s,a]=this.toRegExpSource();if(!(s||j(this,He)||j(this,Zt).nocase&&!j(this,Zt).nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;const o=(j(this,Zt).nocase?"i":"")+(a?"u":"");return Object.assign(new RegExp(`^${r}$`,o),{_src:r,_glob:e})}get options(){return j(this,Zt)}toRegExpSource(e){var u;const r=e??!!j(this,Zt).dot;if(j(this,We)===this&&Lr(this,Jr,Hl).call(this),!this.type){const l=this.isStart()&&this.isEnd(),c=j(this,Pe).map(A=>{var x;const[f,g,b,S]=typeof A=="string"?Lr(x=ht,Er,Gl).call(x,A,j(this,He),l):A.toRegExpSource(e);return je(this,He,j(this,He)||b),je(this,ar,j(this,ar)||S),f}).join("");let m="";if(this.isStart()&&typeof j(this,Pe)[0]=="string"&&!(j(this,Pe).length===1&&pp.has(j(this,Pe)[0]))){const f=gp,g=r&&f.has(c.charAt(0))||c.startsWith("\\.")&&f.has(c.charAt(2))||c.startsWith("\\.\\.")&&f.has(c.charAt(4)),b=!r&&!e&&f.has(c.charAt(0));m=g?mp:b?Li:""}let d="";return this.isEnd()&&j(j(this,We),Sr)&&((u=j(this,Ue))==null?void 0:u.type)==="!"&&(d="(?:$|\\/)"),[m+c+d,ws(c),je(this,He,!!j(this,He)),j(this,ar)]}const n=this.type==="*"||this.type==="+",s=this.type==="!"?"(?:(?!(?:":"(?:";let a=Lr(this,Jr,nc).call(this,r);if(this.isStart()&&this.isEnd()&&!a&&this.type!=="!"){const l=this.toString();return je(this,Pe,[l]),this.type=null,je(this,He,void 0),[l,ws(this.toString()),!1,!1]}let i=!n||e||r?"":Lr(this,Jr,nc).call(this,!0);i===a&&(i=""),i&&(a=`(?:${a})(?:${i})*?`);let o="";if(this.type==="!"&&j(this,Ps))o=(this.isStart()&&!r?Li:"")+Mu;else{const l=this.type==="!"?"))"+(this.isStart()&&!r&&!e?Li:"")+Pu+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&i?")":this.type==="*"&&i?")?":`)${this.type}`;o=s+a+l}return[o,ws(a),je(this,He,!!j(this,He)),j(this,ar)]}};We=new WeakMap,He=new WeakMap,ar=new WeakMap,Pe=new WeakMap,Ue=new WeakMap,Tr=new WeakMap,Kr=new WeakMap,Sr=new WeakMap,Zt=new WeakMap,Xr=new WeakMap,Ps=new WeakMap,Jr=new WeakSet,Hl=function(){if(this!==j(this,We))throw new Error("should only call on root");if(j(this,Sr))return this;this.toString(),je(this,Sr,!0);let e;for(;e=j(this,Kr).pop();){if(e.type!=="!")continue;let r=e,n=j(r,Ue);for(;n;){for(let s=j(r,Tr)+1;!n.type&&s<j(n,Pe).length;s++)for(const a of j(e,Pe)){if(typeof a=="string")throw new Error("string part in extglob AST??");a.copyIn(j(n,Pe)[s])}r=n,n=j(r,Ue)}}return this},Er=new WeakSet,Qa=function(e,r,n,s){var w,A;let a=!1,i=!1,o=-1,u=!1;if(r.type===null){let f=n,g="";for(;f<e.length;){const b=e.charAt(f++);if(a||b==="\\"){a=!a,g+=b;continue}if(i){f===o+1?(b==="^"||b==="!")&&(u=!0):b==="]"&&!(f===o+2&&u)&&(i=!1),g+=b;continue}else if(b==="["){i=!0,o=f,u=!1,g+=b;continue}if(!s.noext&&Ou(b)&&e.charAt(f)==="("){r.push(g),g="";const S=new ht(b,r);f=Lr(w=ht,Er,Qa).call(w,e,S,f,s),r.push(S);continue}g+=b}return r.push(g),f}let l=n+1,c=new ht(null,r);const m=[];let d="";for(;l<e.length;){const f=e.charAt(l++);if(a||f==="\\"){a=!a,d+=f;continue}if(i){l===o+1?(f==="^"||f==="!")&&(u=!0):f==="]"&&!(l===o+2&&u)&&(i=!1),d+=f;continue}else if(f==="["){i=!0,o=l,u=!1,d+=f;continue}if(Ou(f)&&e.charAt(l)==="("){c.push(d),d="";const g=new ht(f,c);c.push(g),l=Lr(A=ht,Er,Qa).call(A,e,g,l,s);continue}if(f==="|"){c.push(d),d="",m.push(c),c=new ht(null,r);continue}if(f===")")return d===""&&j(r,Pe).length===0&&je(r,Ps,!0),c.push(d),d="",r.push(...m,c),l;d+=f}return r.type=null,je(r,He,void 0),je(r,Pe,[e.substring(n-1)]),l},nc=function(e){return j(this,Pe).map(r=>{if(typeof r=="string")throw new Error("string type in extglob ast??");const[n,s,a,i]=r.toRegExpSource(e);return je(this,ar,j(this,ar)||i),n}).filter(r=>!(this.isStart()&&this.isEnd())||!!r).join("|")},Gl=function(e,r,n=!1){let s=!1,a="",i=!1;for(let o=0;o<e.length;o++){const u=e.charAt(o);if(s){s=!1,a+=(yp.has(u)?"\\":"")+u;continue}if(u==="\\"){o===e.length-1?a+="\\\\":s=!0;continue}if(u==="["){const[l,c,m,d]=hp(e,o);if(m){a+=l,i=i||c,o+=m-1,r=r||d;continue}}if(u==="*"){n&&e==="*"?a+=Mu:a+=Pu,r=!0;continue}if(u==="?"){a+=$i,r=!0;continue}a+=wp(u)}return[a,ws(e),!!r,i]},At(ht,Er);let fa=ht;const bp=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/[?*()[\]]/g,"[$&]"):t.replace(/[?*()[\]\\]/g,"\\$&"),lt=(t,e,r={})=>(ha(e),!r.nocomment&&e.charAt(0)==="#"?!1:new ma(e,r).match(t)),Ap=/^\*+([^+@!?\*\[\(]*)$/,vp=t=>e=>!e.startsWith(".")&&e.endsWith(t),_p=t=>e=>e.endsWith(t),xp=t=>(t=t.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(t)),Tp=t=>(t=t.toLowerCase(),e=>e.toLowerCase().endsWith(t)),Sp=/^\*+\.\*+$/,Ep=t=>!t.startsWith(".")&&t.includes("."),kp=t=>t!=="."&&t!==".."&&t.includes("."),Op=/^\.\*+$/,Pp=t=>t!=="."&&t!==".."&&t.startsWith("."),Mp=/^\*+$/,Cp=t=>t.length!==0&&!t.startsWith("."),Ip=t=>t.length!==0&&t!=="."&&t!=="..",Np=/^\?+([^+@!?\*\[\(]*)?$/,Dp=([t,e=""])=>{const r=Cu([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},Rp=([t,e=""])=>{const r=Iu([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},Lp=([t,e=""])=>{const r=Iu([t]);return e?n=>r(n)&&n.endsWith(e):r},$p=([t,e=""])=>{const r=Cu([t]);return e?n=>r(n)&&n.endsWith(e):r},Cu=([t])=>{const e=t.length;return r=>r.length===e&&!r.startsWith(".")},Iu=([t])=>{const e=t.length;return r=>r.length===e&&r!=="."&&r!==".."},Nu=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",Du={win32:{sep:"\\"},posix:{sep:"/"}},Fp=Nu==="win32"?Du.win32.sep:Du.posix.sep;lt.sep=Fp;const Tt=Symbol("globstar **");lt.GLOBSTAR=Tt;const jp="[^/]"+"*?",Up="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Vp="(?:(?!(?:\\/|^)\\.).)*?",Wp=(t,e={})=>r=>lt(r,t,e);lt.filter=Wp;const St=(t,e={})=>Object.assign({},t,e),Bp=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return lt;const e=lt;return Object.assign((n,s,a={})=>e(n,s,St(t,a)),{Minimatch:class extends e.Minimatch{constructor(s,a={}){super(s,St(t,a))}static defaults(s){return e.defaults(St(t,s)).Minimatch}},AST:class extends e.AST{constructor(s,a,i={}){super(s,a,St(t,i))}static fromGlob(s,a={}){return e.AST.fromGlob(s,St(t,a))}},unescape:(n,s={})=>e.unescape(n,St(t,s)),escape:(n,s={})=>e.escape(n,St(t,s)),filter:(n,s={})=>e.filter(n,St(t,s)),defaults:n=>e.defaults(St(t,n)),makeRe:(n,s={})=>e.makeRe(n,St(t,s)),braceExpand:(n,s={})=>e.braceExpand(n,St(t,s)),match:(n,s,a={})=>e.match(n,s,St(t,a)),sep:e.sep,GLOBSTAR:Tt})};lt.defaults=Bp;const Ru=(t,e={})=>(ha(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:cp(t));lt.braceExpand=Ru;const qp=(t,e={})=>new ma(t,e).makeRe();lt.makeRe=qp;const Hp=(t,e,r={})=>{const n=new ma(e,r);return t=t.filter(s=>n.match(s)),n.options.nonull&&!t.length&&t.push(e),t};lt.match=Hp;const Lu=/[?*]|[+@!]\(.*?\)|\[|\]/,Gp=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");class ma{constructor(e,r={}){ce(this,"options");ce(this,"set");ce(this,"pattern");ce(this,"windowsPathsNoEscape");ce(this,"nonegate");ce(this,"negate");ce(this,"comment");ce(this,"empty");ce(this,"preserveMultipleSlashes");ce(this,"partial");ce(this,"globSet");ce(this,"globParts");ce(this,"nocase");ce(this,"isWindows");ce(this,"platform");ce(this,"windowsNoMagicRoot");ce(this,"regexp");ha(e),r=r||{},this.options=r,this.pattern=e,this.platform=r.platform||Nu,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!r.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!r.nonegate,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=r.windowsNoMagicRoot!==void 0?r.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const e of this.set)for(const r of e)if(typeof r!="string")return!0;return!1}debug(...e){}make(){const e=this.pattern,r=this.options;if(!r.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],r.debug&&(this.debug=(...a)=>console.error(...a)),this.debug(this.pattern,this.globSet);const n=this.globSet.map(a=>this.slashSplit(a));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let s=this.globParts.map((a,i,o)=>{if(this.isWindows&&this.windowsNoMagicRoot){const u=a[0]===""&&a[1]===""&&(a[2]==="?"||!Lu.test(a[2]))&&!Lu.test(a[3]),l=/^[a-z]:/i.test(a[0]);if(u)return[...a.slice(0,4),...a.slice(4).map(c=>this.parse(c))];if(l)return[a[0],...a.slice(1).map(c=>this.parse(c))]}return a.map(u=>this.parse(u))});if(this.debug(this.pattern,s),this.set=s.filter(a=>a.indexOf(!1)===-1),this.isWindows)for(let a=0;a<this.set.length;a++){const i=this.set[a];i[0]===""&&i[1]===""&&this.globParts[a][2]==="?"&&typeof i[3]=="string"&&/^[a-z]:$/i.test(i[3])&&(i[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let n=0;n<e.length;n++)for(let s=0;s<e[n].length;s++)e[n][s]==="**"&&(e[n][s]="*");const{optimizationLevel:r=1}=this.options;return r>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):r>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(r=>{let n=-1;for(;(n=r.indexOf("**",n+1))!==-1;){let s=n;for(;r[s+1]==="**";)s++;s!==n&&r.splice(n,s-n)}return r})}levelOneOptimize(e){return e.map(r=>(r=r.reduce((n,s)=>{const a=n[n.length-1];return s==="**"&&a==="**"?n:s===".."&&a&&a!==".."&&a!=="."&&a!=="**"?(n.pop(),n):(n.push(s),n)},[]),r.length===0?[""]:r))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let r=!1;do{if(r=!1,!this.preserveMultipleSlashes){for(let s=1;s<e.length-1;s++){const a=e[s];s===1&&a===""&&e[0]===""||(a==="."||a==="")&&(r=!0,e.splice(s,1),s--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(r=!0,e.pop())}let n=0;for(;(n=e.indexOf("..",n+1))!==-1;){const s=e[n-1];s&&s!=="."&&s!==".."&&s!=="**"&&(r=!0,e.splice(n-1,2),n-=2)}}while(r);return e.length===0?[""]:e}firstPhasePreProcess(e){let r=!1;do{r=!1;for(let n of e){let s=-1;for(;(s=n.indexOf("**",s+1))!==-1;){let i=s;for(;n[i+1]==="**";)i++;i>s&&n.splice(s+1,i-s);let o=n[s+1];const u=n[s+2],l=n[s+3];if(o!==".."||!u||u==="."||u===".."||!l||l==="."||l==="..")continue;r=!0,n.splice(s,1);const c=n.slice(0);c[s]="**",e.push(c),s--}if(!this.preserveMultipleSlashes){for(let i=1;i<n.length-1;i++){const o=n[i];i===1&&o===""&&n[0]===""||(o==="."||o==="")&&(r=!0,n.splice(i,1),i--)}n[0]==="."&&n.length===2&&(n[1]==="."||n[1]==="")&&(r=!0,n.pop())}let a=0;for(;(a=n.indexOf("..",a+1))!==-1;){const i=n[a-1];if(i&&i!=="."&&i!==".."&&i!=="**"){r=!0;const u=a===1&&n[a+1]==="**"?["."]:[];n.splice(a-1,2,...u),n.length===0&&n.push(""),a-=2}}}}while(r);return e}secondPhasePreProcess(e){for(let r=0;r<e.length-1;r++)for(let n=r+1;n<e.length;n++){const s=this.partsMatch(e[r],e[n],!this.preserveMultipleSlashes);if(s){e[r]=[],e[n]=s;break}}return e.filter(r=>r.length)}partsMatch(e,r,n=!1){let s=0,a=0,i=[],o="";for(;s<e.length&&a<r.length;)if(e[s]===r[a])i.push(o==="b"?r[a]:e[s]),s++,a++;else if(n&&e[s]==="**"&&r[a]===e[s+1])i.push(e[s]),s++;else if(n&&r[a]==="**"&&e[s]===r[a+1])i.push(r[a]),a++;else if(e[s]==="*"&&r[a]&&(this.options.dot||!r[a].startsWith("."))&&r[a]!=="**"){if(o==="b")return!1;o="a",i.push(e[s]),s++,a++}else if(r[a]==="*"&&e[s]&&(this.options.dot||!e[s].startsWith("."))&&e[s]!=="**"){if(o==="a")return!1;o="b",i.push(r[a]),s++,a++}else return!1;return e.length===r.length&&i}parseNegate(){if(this.nonegate)return;const e=this.pattern;let r=!1,n=0;for(let s=0;s<e.length&&e.charAt(s)==="!";s++)r=!r,n++;n&&(this.pattern=e.slice(n)),this.negate=r}matchOne(e,r,n=!1){const s=this.options;if(this.isWindows){const f=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),g=!f&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),b=typeof r[0]=="string"&&/^[a-z]:$/i.test(r[0]),S=!b&&r[0]===""&&r[1]===""&&r[2]==="?"&&typeof r[3]=="string"&&/^[a-z]:$/i.test(r[3]),x=g?3:f?0:void 0,E=S?3:b?0:void 0;if(typeof x=="number"&&typeof E=="number"){const[C,y]=[e[x],r[E]];C.toLowerCase()===y.toLowerCase()&&(r[E]=C,E>x?r=r.slice(E):x>E&&(e=e.slice(x)))}}const{optimizationLevel:a=1}=this.options;a>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var i=0,o=0,u=e.length,l=r.length;i<u&&o<l;i++,o++){this.debug("matchOne loop");var c=r[o],m=e[i];if(this.debug(r,c,m),c===!1)return!1;if(c===Tt){this.debug("GLOBSTAR",[r,c,m]);var d=i,w=o+1;if(w===l){for(this.debug("** at the end");i<u;i++)if(e[i]==="."||e[i]===".."||!s.dot&&e[i].charAt(0)===".")return!1;return!0}for(;d<u;){var A=e[d];if(this.debug(`
globstar while`,e,d,r,w,A),this.matchOne(e.slice(d),r.slice(w),n))return this.debug("globstar found match!",d,u,A),!0;if(A==="."||A===".."||!s.dot&&A.charAt(0)==="."){this.debug("dot detected!",e,d,r,w);break}this.debug("globstar swallow a segment, and continue"),d++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,d,r,w),d===u))}let f;if(typeof c=="string"?(f=m===c,this.debug("string match",c,m,f)):(f=c.test(m),this.debug("pattern match",c,m,f)),!f)return!1}if(i===u&&o===l)return!0;if(i===u)return n;if(o===l)return i===u-1&&e[i]==="";throw new Error("wtf?")}braceExpand(){return Ru(this.pattern,this.options)}parse(e){ha(e);const r=this.options;if(e==="**")return Tt;if(e==="")return"";let n,s=null;(n=e.match(Mp))?s=r.dot?Ip:Cp:(n=e.match(Ap))?s=(r.nocase?r.dot?Tp:xp:r.dot?_p:vp)(n[1]):(n=e.match(Np))?s=(r.nocase?r.dot?Rp:Dp:r.dot?Lp:$p)(n):(n=e.match(Sp))?s=r.dot?kp:Ep:(n=e.match(Op))&&(s=Pp);const a=fa.fromGlob(e,this.options).toMMPattern();return s&&typeof a=="object"&&Reflect.defineProperty(a,"test",{value:s}),a}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const r=this.options,n=r.noglobstar?jp:r.dot?Up:Vp,s=new Set(r.nocase?["i"]:[]);let a=e.map(u=>{const l=u.map(c=>{if(c instanceof RegExp)for(const m of c.flags.split(""))s.add(m);return typeof c=="string"?Gp(c):c===Tt?Tt:c._src});return l.forEach((c,m)=>{const d=l[m+1],w=l[m-1];c!==Tt||w===Tt||(w===void 0?d!==void 0&&d!==Tt?l[m+1]="(?:\\/|"+n+"\\/)?"+d:l[m]=n:d===void 0?l[m-1]=w+"(?:\\/|"+n+")?":d!==Tt&&(l[m-1]=w+"(?:\\/|\\/"+n+"\\/)"+d,l[m+1]=Tt))}),l.filter(c=>c!==Tt).join("/")}).join("|");const[i,o]=e.length>1?["(?:",")"]:["",""];a="^"+i+a+o+"$",this.negate&&(a="^(?!"+a+").+$");try{this.regexp=new RegExp(a,[...s].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,r=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;const n=this.options;this.isWindows&&(e=e.split("\\").join("/"));const s=this.slashSplit(e);this.debug(this.pattern,"split",s);const a=this.set;this.debug(this.pattern,"set",a);let i=s[s.length-1];if(!i)for(let o=s.length-2;!i&&o>=0;o--)i=s[o];for(let o=0;o<a.length;o++){const u=a[o];let l=s;if(n.matchBase&&u.length===1&&(l=[i]),this.matchOne(l,u,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return lt.defaults(e).Minimatch}}lt.AST=fa,lt.Minimatch=ma,lt.escape=bp,lt.unescape=ws;const ga=()=>Te().uuid(),Yp=/^(?=.{1,255}$)[0-9A-Za-z_](?:(?:[0-9A-Za-z_]|-){0,61}[0-9A-Za-z_])?(?:\.[0-9A-Za-z_](?:(?:[0-9A-Za-z_]|-){0,61}[0-9A-Za-z_])?)*\.?$/,$u=()=>Te().regex(Yp);xt({id:ga(),host:$u(),startedAt:Re().positive(),endedAt:Re().nullable().optional()}).strict();const Fu=xt({id:ga(),sessionId:ga(),adUrl:Te().url(),timestamp:Re().positive().describe("The time in ms since 1970 that this ad was seen at")}).strict(),Zp=Fu.extend({type:_n(["image"]),additionalDetails:xt({width:Re().nonnegative(),height:Re().nonnegative()})}).strict(),zp=Fu.extend({type:_n(["iframe"]),additionalDetails:xt({width:Re().nonnegative(),height:Re().nonnegative()})}).strict();Ti([Zp,zp]);const Fi=ga,ju=$u,ji=()=>ca().nullable().optional(),Ui=()=>ca().nullable().optional();xt({id:Fi(),host:ju(),startedAt:Re().positive(),endedAt:Re().nullable().optional(),imported:ji(),generated:Ui()}).strict();const Uu=xt({id:Te(),sessionId:Fi(),timestamp:Re().positive().describe("The time in ms since 1970 that this ad was seen at"),imported:ji()}).strict(),Kp=Uu.extend({type:_n(["basic-display"]),details:xt({type:_n(["image","iframe"]),url:Te().url().describe("The URL the ad is accessible at"),width:Re().nonnegative(),height:Re().nonnegative()}).strict()}),Xp=()=>ou(Te(),iu()),Jp=Uu.extend({type:_n(["youtube/hulu/vast","pathmatics"]),details:Xp()}),Qp=Ti([Kp,Jp]),Vi=Fi,Wi=ji,ey=Ui,Bi=()=>ju().describe("The mobile app bundle ID or website hostname"),ty=xt({id:Vi(),appId:Bi(),createdBy:Te({description:"The install id that created the session"}),startedAt:Re().positive(),endedAt:Re(),imported:Wi(),generated:ey()}).strict(),ry=xt({id:Vi(),appId:Bi(),createdBy:Te(),startedAt:Re().positive(),endedAt:Re().nullable().optional(),imported:Wi(),generated:Ui()}).strict(),ny=Qp,Vu=Vi,Wu=Wi,Bu=Bi,sy=ty,ay=ry,iy=xt({id:Vu(),appId:Bu(),path:Te().startsWith("/"),query:Te().optional(),referrer:Te().nullish(),createdBy:Te(),startedAt:Re().positive(),endedAt:Re(),imported:Wu(),adNetwork:Te().optional(),utmSource:Te().optional(),utmMedium:Te().optional(),utmCampaign:Te().optional(),utmTerm:Te().optional()}).strict(),oy=xt({id:Vu(),appId:Bu(),path:Te().startsWith("/"),query:Te().optional(),referrer:Te().nullish(),createdBy:Te(),startedAt:Re().positive(),endedAt:Re().nullish(),imported:Wu(),adNetwork:Te().optional(),utmSource:Te().optional(),utmMedium:Te().optional(),utmCampaign:Te().optional(),utmTerm:Te().optional()}).strict(),cy=ny,uy=sy,qu=ay,ly=iy,dy=oy,Hu=cy;class qi{constructor(e,r){this.db=e,this.storeName=r}async deleteAll(){const r=(await this.db).transaction(this.storeName,"readwrite");let n=await r.objectStore(this.storeName).openCursor();for(;n;)await n.delete(),n=await n.continue();await r.done}async findAll(){return await(await this.db).getAll(this.storeName)}}var hy=Object.defineProperty,fy=(t,e,r)=>e in t?hy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bs=(t,e,r)=>fy(t,typeof e!="symbol"?e+"":e,r);const Yr=class ei extends qi{constructor(e){super(e.db,ei.STORE_NAME_LATEST),this.config=e}async findAds(e,r){return await(await this.db).getAllFromIndex(this.storeName,ei.INDEX_TIMESTAMP,IDBKeyRange.bound(e,r,!1,!0))}async findAdsForSession(e){return await(await this.db).getAllFromIndex(this.storeName,ei.INDEX_SESSION_ID,e)}async upsertAd(e){var s,a;const r=await this.db,n=Hu.parse(e);return(a=(s=this.config).onAdUpserted)==null||a.call(s,n),await r.put(this.storeName,n),n}};bs(Yr,"STORE_NAME_1","ads"),bs(Yr,"STORE_NAME_2","ads-2"),bs(Yr,"STORE_NAME_LATEST",Yr.STORE_NAME_2),bs(Yr,"INDEX_SESSION_ID","idx_ad_sessionId"),bs(Yr,"INDEX_TIMESTAMP","idx_ad_timestamp");let dt=Yr;var my=Object.defineProperty,gy=(t,e,r)=>e in t?my(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pa=(t,e,r)=>gy(t,typeof e!="symbol"?e+"":e,r);const Hi=-1;function py(t){return{id:t.id,appId:t.appId,path:t.path,referrer:t.referrer,query:t.query,createdBy:t.createdBy,endedAt:t.endedAt??Hi,startedAt:t.startedAt,imported:t.imported,adNetwork:t.adNetwork,utmSource:t.utmSource,utmMedium:t.utmMedium,utmCampaign:t.utmCampaign,utmTerm:t.utmTerm}}function ya(t){return{id:t.id,appId:t.appId,path:t.path,query:t.query,referrer:t.referrer,createdBy:t.createdBy,endedAt:t.endedAt===Hi?null:t.endedAt,startedAt:t.startedAt,imported:t.imported,adNetwork:t.adNetwork,utmSource:t.utmSource,utmMedium:t.utmMedium,utmCampaign:t.utmCampaign,utmTerm:t.utmTerm}}const xn=class Us extends qi{constructor(e){super(e.db,Us.STORE_NAME_LATEST),this.config=e}async startPageView(e){const r=await this.db,n=dy.parse({...e,id:gs(),createdBy:await this.config.getInstallId(),endedAt:void 0}),s=py(n);return await r.add(this.storeName,s),n}async endPageView(e,r){const n=await this.db,s=await n.get(this.storeName,e.id);if(s==null)throw Error(`Cannot update: PageView not found with id=${e.id}`);const a={...s,endedAt:r};return await n.put(this.storeName,a),ya(a)}async getActivePageViews(){return(await(await this.db).getAllFromIndex(this.storeName,Us.INDEX_ENDED_AT,Hi)).map(ya)}async findPageViewsByStartedAt(e,r){return(await(await this.db).getAllFromIndex(this.storeName,Us.INDEX_STARTED_AT,IDBKeyRange.bound(e,r,!1,!0))).map(ya)}async findPageViewsByEndedAt(e,r){return(await(await this.db).getAllFromIndex(this.storeName,Us.INDEX_ENDED_AT,IDBKeyRange.bound(e,r,!1,!0))).map(ya)}async deleteAllGeneratedPageViews(){const r=(await this.db).transaction(this.storeName,"readwrite");let n=await r.store.openCursor();for(;n;)n.value.imported&&await n.delete(),n=await n.continue();await r.done}};pa(xn,"STORE_NAME_1","page_views"),pa(xn,"STORE_NAME_LATEST",xn.STORE_NAME_1),pa(xn,"INDEX_ENDED_AT","idx_page_view_endedAt"),pa(xn,"INDEX_STARTED_AT","idx_page_view_startedAt");let As=xn;var yy=Object.defineProperty,wy=(t,e,r)=>e in t?yy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vs=(t,e,r)=>wy(t,typeof e!="symbol"?e+"":e,r);const Gi=-1;function Gu(t){return{id:t.id,appId:t.appId,createdBy:t.createdBy,endedAt:t.endedAt??Gi,startedAt:t.startedAt,imported:t.imported,generated:t.generated}}function Zr(t){return{id:t.id,appId:t.appId,createdBy:t.createdBy,endedAt:t.endedAt===Gi?null:t.endedAt,startedAt:t.startedAt,imported:t.imported,generated:t.generated}}const zr=class $r extends qi{constructor(e){super(e.db,$r.STORE_NAME_LATEST),this.config=e}async startSession(e){const r=await this.db,n=qu.parse({...e,id:gs(),createdBy:await this.config.getInstallId(),endedAt:void 0}),s=Gu(n);return await r.add(this.storeName,s),n}async createSessions(e){const r=await this.db,n=await this.config.getInstallId(),s=r.transaction($r.STORE_NAME_LATEST,"readwrite"),a=s.objectStore($r.STORE_NAME_LATEST),i=e.map(u=>qu.parse({...u,id:gs(),createdBy:n})),o=i.map(Gu);return await Promise.all([...o.map(u=>a.add(u)),s.done]),i}async endSession(e,r){var i,o;const n=await this.db;r-e.startedAt>=6*$g&&((o=(i=this.config).onLongSessionDetected)==null||o.call(i,e,r),r=e.startedAt+10*Ei);const s=await n.get(this.storeName,e.id);if(s==null)throw Error(`Cannot update: Session not found with id=${e.id}`);const a={...s,endedAt:r};return await n.put(this.storeName,a),Zr(a)}async findAllSessions(){return(await super.findAll()).map(Zr)}async findSessions(e,r){return(await(await this.db).getAllFromIndex(this.storeName,$r.INDEX_STARTED_AT,IDBKeyRange.bound(e,r,!1,!0))).map(Zr)}async findSessionsByEndedAt(e,r){return(await(await this.db).getAllFromIndex(this.storeName,$r.INDEX_ENDED_AT,IDBKeyRange.bound(e,r,!1,!0))).map(Zr)}async findOldestSession(){const n=(await(await this.db).getAllFromIndex(this.storeName,$r.INDEX_STARTED_AT,IDBKeyRange.lowerBound(0,!0))).shift();return n?Zr(n):void 0}async getSession(e){const n=await(await this.db).get(this.storeName,e);if(n==null)throw Error(`No session with id=${e} was found`);return Zr(n)}async getActiveSessions(){return(await(await this.db).getAllFromIndex(this.storeName,$r.INDEX_ENDED_AT,Gi)).map(Zr)}async deleteAllGeneratedSessions(){const r=(await this.db).transaction(this.storeName,"readwrite");let n=await r.store.openCursor();for(;n;){const s=n.value;(s.imported||s.generated)&&await n.delete(),n=await n.continue()}await r.done}};vs(zr,"STORE_NAME_1","sessions"),vs(zr,"STORE_NAME_2","sessions_2"),vs(zr,"STORE_NAME_LATEST",zr.STORE_NAME_2),vs(zr,"INDEX_ENDED_AT","idx_session_endedAt"),vs(zr,"INDEX_STARTED_AT","idx_session_startedAt");let Qe=zr;var Ye=(t=>(t[t.V2=2]="V2",t[t.V3=3]="V3",t[t.V4=4]="V4",t[t.V5=5]="V5",t[t.V6=6]="V6",t[t.V7=7]="V7",t[t.V8=8]="V8",t))(Ye||{});const by=X.object({version:X.nativeEnum(Ye),stores:X.object({[Qe.STORE_NAME_LATEST]:X.array(uy).optional(),[As.STORE_NAME_LATEST]:X.array(ly).optional(),[dt.STORE_NAME_LATEST]:X.array(Hu).optional()})});X.object({version:X.nativeEnum(Ye),stores:X.record(X.string(),X.array(X.any()))});async function Ay(t){const e=await t,r={version:e.version,stores:{}},n=lu(e),s=e.transaction(n,"readonly");for(const a of n){const o=await s.objectStore(a).getAll();o.forEach(u=>{delete u.imported}),r.stores[a]=o}return await s.done,r}function vy(t,e){return{...t,id:gs(),sessionId:e}}function _y(t){return{...t,id:gs()}}function Yu(t){return{id:t.id,sessionId:t.sessionId,timestamp:t.timestamp,type:"basic-display",details:{type:t.type,height:t.additionalDetails.height,width:t.additionalDetails.width,url:t.adUrl}}}function wa(t,e){return{id:t.id,appId:t.host,createdBy:e,startedAt:t.startedAt,endedAt:t.endedAt??-1,imported:t.imported,generated:t.generated}}async function xy({dbPromise:t,usageBackup:e,logger:r,getInstallId:n}){const s=await t;r==null||r.debug("[import-backup] Importing...",e);const a=await n(),i=await by.parseAsync(await Zu(e,s.version,{installId:a})),o=lu(s),u=s.transaction(o,"readwrite");for(const l of o){const c=i.stores[l];if(c!=null&&c.length){const m=u.objectStore(l);for(const d of c)r==null||r.debug(`[import-backup]: ${l}:`,d),await m.put({...d,imported:!0})}}await u.done}const Yi=t=>e=>({...e,version:t}),Ty=()=>t=>t,Sy=t=>{var e;return{version:Ye.V4,stores:{[Qe.STORE_NAME_2]:t.stores[Qe.STORE_NAME_2],[dt.STORE_NAME_2]:(e=t.stores[dt.STORE_NAME_2])==null?void 0:e.map(Yu)}}},Ey=(t,{installId:e})=>{var r;return{version:Ye.V6,stores:{[Qe.STORE_NAME_2]:(r=t.stores[Qe.STORE_NAME_2])==null?void 0:r.map(n=>wa(n,e)),[dt.STORE_NAME_2]:t.stores[dt.STORE_NAME_2]}}},ky=(t,{installId:e})=>{var r;return{version:Ye.V7,stores:{[Qe.STORE_NAME_2]:(r=t.stores[Qe.STORE_NAME_2])==null?void 0:r.map(n=>"host"in n?wa(n,e):n),[dt.STORE_NAME_2]:t.stores[dt.STORE_NAME_2]}}},Oy={[Ye.V2]:Yi(Ye.V3),[Ye.V3]:Sy,[Ye.V4]:Yi(Ye.V5),[Ye.V5]:Ey,[Ye.V6]:ky,[Ye.V7]:Yi(Ye.V8),[Ye.V8]:Ty()};async function Zu(t,e,r){if(t.version>e)throw Error(`Failed to upgrade backup version ${t.version}, version not supported`);if(t.version===e)return t;const n=Oy[t.version];if(n==null)throw Error(`Failed to upgrade backup version ${t.version}, version not supported`);const s=await n(t,r);return await Zu(s,e,r)}async function Py({db:t,tx:e}){const r=e.objectStore(Qe.STORE_NAME_1),n=e.objectStore(Qe.STORE_NAME_2),s=e.objectStore(dt.STORE_NAME_1),a=e.objectStore(dt.STORE_NAME_2),i=await r.index(Qe.INDEX_STARTED_AT).getAll();for(const o of i){const u=_y(o);await n.add(u);const l=await s.index(dt.INDEX_SESSION_ID).getAll(o.id);for(const c of l){const m=vy(c,u.id);await a.add(m)}}t.deleteObjectStore(r.name),t.deleteObjectStore(s.name)}async function My({tx:t}){const e=t.objectStore(dt.STORE_NAME_2),r=await e.getAll();for(const n of r){const s=Yu(n);await e.put(s)}}async function Cy({tx:t,ctx:e}){const r=t.objectStore(Qe.STORE_NAME_2),n=await r.getAll();for(const s of n){const a=wa(s,e.installId);await r.put(a)}}async function Iy({tx:t,ctx:e}){const r=t.objectStore(Qe.STORE_NAME_2),n=await r.getAll();for(const s of n)if("host"in s){const a=wa(s,e.installId);await r.put(a)}}const _s=()=>{},Ny=[_s,_s,_s,Py,My,_s,Cy,Iy,_s];async function Dy(t,{logger:e}){if(t.oldVersion===0||t.newVersion==null)return;const r=t.oldVersion+1,n=t.newVersion,s=Ny.slice(r,n+1);if(s.length!==0)for(const a of s)await a(t)}function Tn(t,e,r,n){return t.indexNames.contains(e)?t.index(e):t.createIndex(e,r,n)}function Zi({db:t,tx:e},r,n){return t.objectStoreNames.contains(r)?e.objectStore(r):t.createObjectStore(r,n)}const Ry=Ye.V8;async function Ly(t){const e=await t.getInstallId();return Yg("UsageSdkDb",Ry,{async upgrade(r,n,s,a){const i={db:r,oldVersion:n,newVersion:s,tx:a,ctx:{installId:e}};$y(i),await Dy(i,{logger:null})}})}function $y(t){const e=Zi(t,Qe.STORE_NAME_LATEST,{keyPath:"id"});Tn(e,Qe.INDEX_STARTED_AT,"startedAt",{unique:!1}),Tn(e,Qe.INDEX_ENDED_AT,"endedAt",{unique:!1});const r=Zi(t,As.STORE_NAME_LATEST,{keyPath:"id"});Tn(r,As.INDEX_STARTED_AT,"startedAt",{unique:!1}),Tn(r,As.INDEX_ENDED_AT,"endedAt",{unique:!1});const n=Zi(t,dt.STORE_NAME_LATEST,{keyPath:"id"});Tn(n,dt.INDEX_SESSION_ID,"sessionId",{unique:!1}),Tn(n,dt.INDEX_TIMESTAMP,"timestamp",{unique:!1})}function Fy(t){const e=Ly(t),r=t.logger===void 0?console:t.logger;return{indexedDb:e,sessionsRepo:new Qe({db:e,...t}),pageViewsRepo:new As({db:e,...t}),adsRepo:new dt({db:e,...t}),exportBackup:()=>Ay(e),importBackup:n=>xy({dbPromise:e,usageBackup:n,getInstallId:t.getInstallId,logger:r})}}var jy=Object.defineProperty,Uy=(t,e,r)=>e in t?jy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,et=(t,e,r)=>Uy(t,typeof e!="symbol"?e+"":e,r);const ba=class Vs{constructor(e,r){et(this,"sessionsRepo"),et(this,"pageViewsRepo"),et(this,"logger"),et(this,"lastAlivePing"),et(this,"startupPromise"),et(this,"allowSessionUpdates"),et(this,"startupTimeoutId"),et(this,"sessionUpdatedListeners",[]),et(this,"pageViewUpdatedListeners",[]),et(this,"checkSessionsListeners",[]),et(this,"latestTriggerId",0),et(this,"startedAtTimestamp",Date.now()),et(this,"updateSessions",jg(async a=>{var u,l,c;const i=`[update-sessions] [${a.triggerId}]`;if((u=this.logger)==null||u.debug(`${i} Waiting for startup to stop previous sessions...`),await this.startupPromise,(l=this.logger)==null||l.debug(`${i} Processing @ ${new Date(a.timestamp).toLocaleTimeString()}`),this.pingLastAliveAt(),this.invokeCheckSessionsListeners(),await this.enabled()){const m=this.logger?new Lg(this.logger.debug.bind(this.logger)):void 0,d=await this.getComputeDependencies();m==null||m.log(`${i} Got required data after {duration}`);const w=await this.findSessionChanges(a,d);m==null||m.log(`${i} Computed session changes after {duration}`);const A=await this.findPageViewChanges(a,d);m==null||m.log(`${i} Computed page view changes after {duration}`),await this.saveSessionChanges(a.timestamp,w),m==null||m.log(`${i} Session changes committed to the database after {duration}`),await this.savePageViewChanges(a.timestamp,A),m==null||m.log(`${i} Page view changes committed to the database after {duration}`)}else await this.endAllActiveSessions(Date.now());(c=this.logger)==null||c.log(`${i} Done`)})),this.sessionsRepo=e.sessionsRepo,this.pageViewsRepo=e.pageViewsRepo,this.updateSessions=this.updateSessions.bind(this),r===void 0?this.logger=console:this.logger=r;const[n,s]=Ug();this.startupPromise=n,this.allowSessionUpdates=s}setupTriggers(){this.setupCustomTriggers(),this.addStartupTimeout()}addSessionUpdatedListener(e){this.sessionUpdatedListeners.push(e)}addPageViewUpdatedListener(e){this.pageViewUpdatedListeners.push(e)}addCheckSessionsListener(e){this.checkSessionsListeners.push(e)}triggerStartup(e,r){clearTimeout(this.startupTimeoutId),this.startupTimeoutId=void 0,this.startupFlow({cleanupSessions:r,trigger:e,timestamp:this.startedAtTimestamp})}addStartupTimeout(){this.startupTimeoutId=setTimeout(()=>this.triggerStartup("setTimeout",!1),Vs.ALWAYS_STARTUP_AFTER_MS)}triggerSessionCheck(e,r=Date.now()){var s;const n=this.latestTriggerId++;return(s=this.logger)==null||s.log(`[update-sessions] [${n}] Queued by ${e} @ ${new Date(r).toLocaleTimeString()}`),this.updateSessions({timestamp:r,triggerId:n,triggeredBy:e})}async startupFlow({cleanupSessions:e,trigger:r,timestamp:n}){e&&await this.cleanupActiveSessions(n),await this.pingLastAliveAt(!0),await Fg().then(()=>this.allowSessionUpdates()),await this.triggerSessionCheck(r,n)}async cleanupActiveSessions(e){var a,i,o,u,l;const r=await this.getLastAliveAt();if((a=this.logger)==null||a.debug("[on-startup] onStartup()",{lastActivity:r&&new Date(r).toISOString(),now:new Date(e).toISOString()}),r==null){(i=this.logger)==null||i.error("lastActivity was not set yet");return}(o=this.logger)==null||o.log("[on-startup] Ending sessions after quit...");const n=r+Vs.LAST_ALIVE_AT_POLL_INTERVAL_MS,s=Math.min(e,n);(u=this.logger)==null||u.log("[on-startup] Timing details:",{lastActivity:new Date(r).toISOString(),now:new Date(e).toISOString(),quitAt:new Date(n).toISOString(),endAt:new Date(s).toISOString()}),await this.endAllActiveSessions(s),(l=this.logger)==null||l.log("[on-startup] Startup finished!")}async saveSessionChanges(e,r){const n=r.toEnd.map(o=>{var c;const u=new Date(e).toLocaleTimeString();(c=this.logger)==null||c.log(`[change-session] Stop session ${o.appId} @ ${u} (${e-o.startedAt}ms)`);const l=e<o.startedAt?o.startedAt+la:e;return this.sessionsRepo.endSession(o,l)}),s=r.toStart.map(o=>{var u;return(u=this.logger)==null||u.log(`[change-session] Start session ${o.appId} @ ${new Date(o.startedAt).toLocaleTimeString()}`,{session:o}),this.sessionsRepo.startSession(o)}),a=await Promise.allSettled(n),i=await Promise.allSettled(s);this.logSettledErrors("sessions","ending",a),this.logSettledErrors("sessions","starting",i),r.count>0&&this.invokeSessionUpdatedListeners()}async savePageViewChanges(e,r){const n=r.toEnd.map(o=>{var l;const u=new Date(e).toLocaleTimeString();return(l=this.logger)==null||l.log(`[change-session] Stop page view ${o.appId}${o.path} @ ${u} (${e-o.startedAt}ms)`),this.pageViewsRepo.endPageView(o,e)}),s=r.toStart.map(o=>{var u;return(u=this.logger)==null||u.log(`[change-session] Start page view ${o.appId}${o.path} @ ${new Date(o.startedAt).toLocaleTimeString()}`,{session:o}),this.pageViewsRepo.startPageView(o)}),a=await Promise.allSettled(n),i=await Promise.allSettled(s);this.logSettledErrors("page views","ending",a),this.logSettledErrors("page views","starting",i),r.count>0&&this.invokePageViewUpdatedListeners()}logSettledErrors(e,r,n){var a;const s=n.map(i=>{if(i.status==="rejected")return i.reason}).filter(i=>i!=null);s.length>0&&((a=this.logger)==null||a.warn(`[update-sessions] ${s.length}/${n.length} transactions failed when ${r} ${e}`,s))}async endAllActiveSessions(e){var n,s,a;const r=await this.sessionsRepo.getActiveSessions();if(r.length===0){(n=this.logger)==null||n.log("[stop-active-sessions] No active sessions to stop");return}(s=this.logger)==null||s.log("[stop-active-sessions] Stopping all active sessions:",{activeSessions:r,timestamp:e}),await this.saveSessionChanges(e,{toStart:[],toEnd:r,count:r.length}),(a=this.logger)==null||a.log("[stop-active-sessions] All active sessions stopped!")}async pingLastAliveAt(e=!1){var s,a;const r=Date.now(),n=await this.getLastAliveAt()??r;!e&&Math.abs(r-n)>2*Vs.LAST_ALIVE_AT_INTERVAL_MS&&((s=this.logger)==null||s.debug("[SessionMonitor] Long ping interval detected. Cleaning up sessions."),await this.cleanupActiveSessions(r)),(a=this.logger)==null||a.debug("[SessionMonitor] Updating last time app was known to be open",r),await this.setLastAliveAt(r),clearTimeout(this.lastAlivePing),this.lastAlivePing=setTimeout(()=>this.pingLastAliveAt(),Vs.LAST_ALIVE_AT_POLL_INTERVAL_MS)}invokeCheckSessionsListeners(){this.checkSessionsListeners.forEach(e=>e())}invokeSessionUpdatedListeners(){this.sessionUpdatedListeners.forEach(e=>e())}invokePageViewUpdatedListeners(){this.pageViewUpdatedListeners.forEach(e=>e())}};et(ba,"LAST_ALIVE_AT_INTERVAL_MS",Ei),et(ba,"ALWAYS_STARTUP_AFTER_MS",5*la),et(ba,"LAST_ALIVE_AT_POLL_INTERVAL_MS",30*la);let Aa=ba;const zi=1e3;async function Ki(t){return(await we.storage.local.get(t))[t]??void 0}async function Sn(t,e){e===void 0?await we.storage.local.remove(t):await we.storage.local.set({[t]:e})}function Vy(t,e){const r=n=>n[e];return t.reduce((n,s)=>{var i;const a=r(s);return n[a]=((i=n[a])==null?void 0:i.concat(s))??[s],n},{})}function Wy(t,e){const r=n=>n[e];return t.reduce((n,s)=>{const a=r(s);return n[a]=s,n},{})}function By(t){return t.state!=="docked"&&t.state!=="minimized"}function qy(t,e,r,n){return n&&t.audible||t.active&&e.focused&&By(e)&&r}var va={exports:{}};va.exports,function(t,e){var r=200,n="__lodash_hash_undefined__",s=1,a=2,i=9007199254740991,o="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",m="[object Date]",d="[object Error]",w="[object Function]",A="[object GeneratorFunction]",f="[object Map]",g="[object Number]",b="[object Null]",S="[object Object]",x="[object Promise]",E="[object Proxy]",C="[object RegExp]",y="[object Set]",T="[object String]",_="[object Symbol]",P="[object Undefined]",N="[object WeakMap]",U="[object ArrayBuffer]",G="[object DataView]",I="[object Float32Array]",K="[object Float64Array]",L="[object Int8Array]",H="[object Int16Array]",W="[object Int32Array]",O="[object Uint8Array]",Z="[object Uint8ClampedArray]",Q="[object Uint16Array]",ye="[object Uint32Array]",Oe=/[\\^$.*+?()[\]{}|]/g,Ze=/^\[object .+?Constructor\]$/,ze=/^(?:0|[1-9]\d*)$/,fe={};fe[I]=fe[K]=fe[L]=fe[H]=fe[W]=fe[O]=fe[Z]=fe[Q]=fe[ye]=!0,fe[o]=fe[u]=fe[U]=fe[c]=fe[G]=fe[m]=fe[d]=fe[w]=fe[f]=fe[g]=fe[S]=fe[C]=fe[y]=fe[T]=fe[N]=!1;var _t=typeof Pt=="object"&&Pt&&Pt.Object===Object&&Pt,be=typeof self=="object"&&self&&self.Object===Object&&self,ft=_t||be||Function("return this")(),Qr=e&&!e.nodeType&&e,pt=Qr&&!0&&t&&!t.nodeType&&t,kr=pt&&pt.exports===Qr,Or=kr&&_t.process,ir=function(){try{return Or&&Or.binding&&Or.binding("util")}catch{}}(),Pr=ir&&ir.isTypedArray;function Lt(p,k){for(var D=-1,B=p==null?0:p.length,Se=0,se=[];++D<B;){var Ae=p[D];k(Ae,D,p)&&(se[Se++]=Ae)}return se}function Pn(p,k){for(var D=-1,B=k.length,Se=p.length;++D<B;)p[Se+D]=k[D];return p}function en(p,k){for(var D=-1,B=p==null?0:p.length;++D<B;)if(k(p[D],D,p))return!0;return!1}function or(p,k){for(var D=-1,B=Array(p);++D<p;)B[D]=k(D);return B}function Mr(p){return function(k){return p(k)}}function Cs(p,k){return p.has(k)}function Mn(p,k){return p==null?void 0:p[k]}function Cn(p){var k=-1,D=Array(p.size);return p.forEach(function(B,Se){D[++k]=[Se,B]}),D}function Ke(p,k){return function(D){return p(k(D))}}function zt(p){var k=-1,D=Array(p.size);return p.forEach(function(B){D[++k]=B}),D}var Cr=Array.prototype,le=Function.prototype,de=Object.prototype,ne=ft["__core-js_shared__"],pe=le.toString,Me=de.hasOwnProperty,at=function(){var p=/[^.]+$/.exec(ne&&ne.keys&&ne.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),me=de.toString,J=RegExp("^"+pe.call(Me).replace(Oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ve=kr?ft.Buffer:void 0,Kt=ft.Symbol,Ir=ft.Uint8Array,Is=de.propertyIsEnumerable,vo=Cr.splice,cr=Kt?Kt.toStringTag:void 0,Ua=Object.getOwnPropertySymbols,Ns=Ve?Ve.isBuffer:void 0,tn=Ke(Object.keys,Object),rn=Nr(ft,"DataView"),ur=Nr(ft,"Map"),nn=Nr(ft,"Promise"),lr=Nr(ft,"Set"),Ds=Nr(ft,"WeakMap"),sn=Nr(Object,"create"),_o=fr(rn),xo=fr(ur),To=fr(nn),In=fr(lr),Rs=fr(Ds),Ls=Kt?Kt.prototype:void 0,$t=Ls?Ls.valueOf:void 0;function dr(p){var k=-1,D=p==null?0:p.length;for(this.clear();++k<D;){var B=p[k];this.set(B[0],B[1])}}function So(){this.__data__=sn?sn(null):{},this.size=0}function Eo(p){var k=this.has(p)&&delete this.__data__[p];return this.size-=k?1:0,k}function ko(p){var k=this.__data__;if(sn){var D=k[p];return D===n?void 0:D}return Me.call(k,p)?k[p]:void 0}function Oo(p){var k=this.__data__;return sn?k[p]!==void 0:Me.call(k,p)}function Ft(p,k){var D=this.__data__;return this.size+=this.has(p)?0:1,D[p]=sn&&k===void 0?n:k,this}dr.prototype.clear=So,dr.prototype.delete=Eo,dr.prototype.get=ko,dr.prototype.has=Oo,dr.prototype.set=Ft;function jt(p){var k=-1,D=p==null?0:p.length;for(this.clear();++k<D;){var B=p[k];this.set(B[0],B[1])}}function Po(){this.__data__=[],this.size=0}function Mo(p){var k=this.__data__,D=Ln(k,p);if(D<0)return!1;var B=k.length-1;return D==B?k.pop():vo.call(k,D,1),--this.size,!0}function Co(p){var k=this.__data__,D=Ln(k,p);return D<0?void 0:k[D][1]}function Io(p){return Ln(this.__data__,p)>-1}function Ut(p,k){var D=this.__data__,B=Ln(D,p);return B<0?(++this.size,D.push([p,k])):D[B][1]=k,this}jt.prototype.clear=Po,jt.prototype.delete=Mo,jt.prototype.get=Co,jt.prototype.has=Io,jt.prototype.set=Ut;function hr(p){var k=-1,D=p==null?0:p.length;for(this.clear();++k<D;){var B=p[k];this.set(B[0],B[1])}}function No(){this.size=0,this.__data__={hash:new dr,map:new(ur||jt),string:new dr}}function Do(p){var k=$n(this,p).delete(p);return this.size-=k?1:0,k}function Ro(p){return $n(this,p).get(p)}function Lo(p){return $n(this,p).has(p)}function Nn(p,k){var D=$n(this,p),B=D.size;return D.set(p,k),this.size+=D.size==B?0:1,this}hr.prototype.clear=No,hr.prototype.delete=Do,hr.prototype.get=Ro,hr.prototype.has=Lo,hr.prototype.set=Nn;function Dn(p){var k=-1,D=p==null?0:p.length;for(this.__data__=new hr;++k<D;)this.add(p[k])}function $o(p){return this.__data__.set(p,n),this}function Vt(p){return this.__data__.has(p)}Dn.prototype.add=Dn.prototype.push=$o,Dn.prototype.has=Vt;function Xt(p){var k=this.__data__=new jt(p);this.size=k.size}function Fo(){this.__data__=new jt,this.size=0}function jo(p){var k=this.__data__,D=k.delete(p);return this.size=k.size,D}function Uo(p){return this.__data__.get(p)}function Vo(p){return this.__data__.has(p)}function Wo(p,k){var D=this.__data__;if(D instanceof jt){var B=D.__data__;if(!ur||B.length<r-1)return B.push([p,k]),this.size=++D.size,this;D=this.__data__=new hr(B)}return D.set(p,k),this.size=D.size,this}Xt.prototype.clear=Fo,Xt.prototype.delete=jo,Xt.prototype.get=Uo,Xt.prototype.has=Vo,Xt.prototype.set=Wo;function Rn(p,k){var D=jn(p),B=!D&&Fn(p),Se=!D&&!B&&Et(p),se=!D&&!B&&!Se&&Za(p),Ae=D||B||Se||se,Le=Ae?or(p.length,String):[],Be=Le.length;for(var ke in p)Me.call(p,ke)&&!(Ae&&(ke=="length"||Se&&(ke=="offset"||ke=="parent")||se&&(ke=="buffer"||ke=="byteLength"||ke=="byteOffset")||qa(ke,Be)))&&Le.push(ke);return Le}function Ln(p,k){for(var D=p.length;D--;)if(Ga(p[D][0],k))return D;return-1}function Bo(p,k,D){var B=k(p);return jn(p)?B:Pn(B,D(p))}function an(p){return p==null?p===void 0?P:b:cr&&cr in Object(p)?zo(p):Ha(p)}function Va(p){return cn(p)&&an(p)==o}function $s(p,k,D,B,Se){return p===k?!0:p==null||k==null||!cn(p)&&!cn(k)?p!==p&&k!==k:qo(p,k,D,B,$s,Se)}function qo(p,k,D,B,Se,se){var Ae=jn(p),Le=jn(k),Be=Ae?u:Jt(p),ke=Le?u:Jt(k);Be=Be==o?S:Be,ke=ke==o?S:ke;var Xe=Be==S,it=ke==S,Fe=Be==ke;if(Fe&&Et(p)){if(!Et(k))return!1;Ae=!0,Xe=!1}if(Fe&&!Xe)return se||(se=new Xt),Ae||Za(p)?Wa(p,k,D,B,Se,se):Yo(p,k,Be,D,B,Se,se);if(!(D&s)){var ot=Xe&&Me.call(p,"__wrapped__"),yt=it&&Me.call(k,"__wrapped__");if(ot||yt){var Qt=ot?p.value():p,Wt=yt?k.value():k;return se||(se=new Xt),Se(Qt,Wt,D,B,se)}}return Fe?(se||(se=new Xt),Zo(p,k,D,B,Se,se)):!1}function Ho(p){if(!Ya(p)||Jo(p))return!1;var k=js(p)?J:Ze;return k.test(fr(p))}function Fs(p){return cn(p)&&on(p.length)&&!!fe[an(p)]}function Go(p){if(!Qo(p))return tn(p);var k=[];for(var D in Object(p))Me.call(p,D)&&D!="constructor"&&k.push(D);return k}function Wa(p,k,D,B,Se,se){var Ae=D&s,Le=p.length,Be=k.length;if(Le!=Be&&!(Ae&&Be>Le))return!1;var ke=se.get(p);if(ke&&se.get(k))return ke==k;var Xe=-1,it=!0,Fe=D&a?new Dn:void 0;for(se.set(p,k),se.set(k,p);++Xe<Le;){var ot=p[Xe],yt=k[Xe];if(B)var Qt=Ae?B(yt,ot,Xe,k,p,se):B(ot,yt,Xe,p,k,se);if(Qt!==void 0){if(Qt)continue;it=!1;break}if(Fe){if(!en(k,function(Wt,mr){if(!Cs(Fe,mr)&&(ot===Wt||Se(ot,Wt,D,B,se)))return Fe.push(mr)})){it=!1;break}}else if(!(ot===yt||Se(ot,yt,D,B,se))){it=!1;break}}return se.delete(p),se.delete(k),it}function Yo(p,k,D,B,Se,se,Ae){switch(D){case G:if(p.byteLength!=k.byteLength||p.byteOffset!=k.byteOffset)return!1;p=p.buffer,k=k.buffer;case U:return!(p.byteLength!=k.byteLength||!se(new Ir(p),new Ir(k)));case c:case m:case g:return Ga(+p,+k);case d:return p.name==k.name&&p.message==k.message;case C:case T:return p==k+"";case f:var Le=Cn;case y:var Be=B&s;if(Le||(Le=zt),p.size!=k.size&&!Be)return!1;var ke=Ae.get(p);if(ke)return ke==k;B|=a,Ae.set(p,k);var Xe=Wa(Le(p),Le(k),B,Se,se,Ae);return Ae.delete(p),Xe;case _:if($t)return $t.call(p)==$t.call(k)}return!1}function Zo(p,k,D,B,Se,se){var Ae=D&s,Le=Ba(p),Be=Le.length,ke=Ba(k),Xe=ke.length;if(Be!=Xe&&!Ae)return!1;for(var it=Be;it--;){var Fe=Le[it];if(!(Ae?Fe in k:Me.call(k,Fe)))return!1}var ot=se.get(p);if(ot&&se.get(k))return ot==k;var yt=!0;se.set(p,k),se.set(k,p);for(var Qt=Ae;++it<Be;){Fe=Le[it];var Wt=p[Fe],mr=k[Fe];if(B)var un=Ae?B(mr,Wt,Fe,k,p,se):B(Wt,mr,Fe,p,k,se);if(!(un===void 0?Wt===mr||Se(Wt,mr,D,B,se):un)){yt=!1;break}Qt||(Qt=Fe=="constructor")}if(yt&&!Qt){var Un=p.constructor,Vn=k.constructor;Un!=Vn&&"constructor"in p&&"constructor"in k&&!(typeof Un=="function"&&Un instanceof Un&&typeof Vn=="function"&&Vn instanceof Vn)&&(yt=!1)}return se.delete(p),se.delete(k),yt}function Ba(p){return Bo(p,za,Ko)}function $n(p,k){var D=p.__data__;return Xo(k)?D[typeof k=="string"?"string":"hash"]:D.map}function Nr(p,k){var D=Mn(p,k);return Ho(D)?D:void 0}function zo(p){var k=Me.call(p,cr),D=p[cr];try{p[cr]=void 0;var B=!0}catch{}var Se=me.call(p);return B&&(k?p[cr]=D:delete p[cr]),Se}var Ko=Ua?function(p){return p==null?[]:(p=Object(p),Lt(Ua(p),function(k){return Is.call(p,k)}))}:Ka,Jt=an;(rn&&Jt(new rn(new ArrayBuffer(1)))!=G||ur&&Jt(new ur)!=f||nn&&Jt(nn.resolve())!=x||lr&&Jt(new lr)!=y||Ds&&Jt(new Ds)!=N)&&(Jt=function(p){var k=an(p),D=k==S?p.constructor:void 0,B=D?fr(D):"";if(B)switch(B){case _o:return G;case xo:return f;case To:return x;case In:return y;case Rs:return N}return k});function qa(p,k){return k=k??i,!!k&&(typeof p=="number"||ze.test(p))&&p>-1&&p%1==0&&p<k}function Xo(p){var k=typeof p;return k=="string"||k=="number"||k=="symbol"||k=="boolean"?p!=="__proto__":p===null}function Jo(p){return!!at&&at in p}function Qo(p){var k=p&&p.constructor,D=typeof k=="function"&&k.prototype||de;return p===D}function Ha(p){return me.call(p)}function fr(p){if(p!=null){try{return pe.call(p)}catch{}try{return p+""}catch{}}return""}function Ga(p,k){return p===k||p!==p&&k!==k}var Fn=Va(function(){return arguments}())?Va:function(p){return cn(p)&&Me.call(p,"callee")&&!Is.call(p,"callee")},jn=Array.isArray;function Dr(p){return p!=null&&on(p.length)&&!js(p)}var Et=Ns||tc;function ec(p,k){return $s(p,k)}function js(p){if(!Ya(p))return!1;var k=an(p);return k==w||k==A||k==l||k==E}function on(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=i}function Ya(p){var k=typeof p;return p!=null&&(k=="object"||k=="function")}function cn(p){return p!=null&&typeof p=="object"}var Za=Pr?Mr(Pr):Fs;function za(p){return Dr(p)?Rn(p):Go(p)}function Ka(){return[]}function tc(){return!1}t.exports=ec}(va,va.exports);var Hy=va.exports;const zu=Fr(Hy);var Gy=Object.defineProperty,Yy=(t,e,r)=>e in t?Gy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xi=(t,e,r)=>Yy(t,typeof e!="symbol"?e+"":e,r);const _a="tab-history-map",Ku=class Yl{constructor(e){var n;Xi(this,"tabHistoryMap",this.restoreTabHistory()),Xi(this,"lock",new Bs);let r=0;we.tabs.onCreated.addListener(s=>this.lock.runExclusive(async()=>{var a;if(s.id!=null&&(e==null||e.debug(`[referrer] ${r++} tabs.onCreated`,s),s.openerTabId!=null)){const o=(a=(await this.tabHistoryMap)[s.openerTabId])==null?void 0:a[0];o&&await this.addHistory(s.id,o)}})),we.webNavigation.onCommitted.addListener(s=>this.lock.runExclusive(async()=>{e==null||e.debug(`[referrer] ${r++} webNavigation.onCommitted`,s);const{frameId:a,tabId:i,url:o,transitionQualifiers:u}=s;a===0&&((u!=null&&u.includes("forward_back")||u!=null&&u.includes("from_address_bar"))&&await this.addHistory(i,void 0),await this.addHistory(i,o))})),we.runtime.onStartup.addListener(()=>this.resetHistory()),(n=we.runtime.onSuspend)==null||n.addListener(()=>this.resetHistory()),we.tabs.onRemoved.addListener(s=>this.removeHistory(s))}async restoreTabHistory(){return await Ki(_a)??{}}async addHistory(e,r){const n=await this.tabHistoryMap,s=n[e]??(n[e]=[]);r!==s[0]&&s.unshift(this.sanatizeReferrerUrl(r)),s.splice(Yl.MAX_HISTORY_COUNT_PER_TAB),await Sn(_a,n)}sanatizeReferrerUrl(e){if(e)try{const r=new URL(e);return r.search="",r.username="",r.password="",r.hash="",r.href}catch{return}}getReferrerFor(e,r){return this.lock.runExclusive(async()=>{if(e==null||!r)return;const s=(await this.tabHistoryMap)[e];if(s==null)return;const a=s.findIndex(i=>i===r);return a===-1?void 0:s[a+1]})}resetHistory(){return Sn(_a,{})}async removeHistory(e){const r=await this.tabHistoryMap;delete r[e],await Sn(_a,r)}};Xi(Ku,"MAX_HISTORY_COUNT_PER_TAB",10);let Zy=Ku;var zy=Object.defineProperty,Ky=(t,e,r)=>e in t?zy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xs=(t,e,r)=>Ky(t,typeof e!="symbol"?e+"":e,r);const Ji="tab-ad-network",Xy=[{name:"google",regexes:["[?&]gclid=\\w+","[?&]hvnetw=g"]},{name:"facebook",regexes:["[?&]fbclid=\\w+"]},{name:"bing",regexes:["[?&]msclkid=\\w+","[?&]hvnetw=o"]}],Jy={campaign:["utm_campaign","campaignid","adgroupid","cid"],medium:["utm_medium","placement","nb_placement","channel"],source:["utm_source","source"],term:["utm_term","keyword","nb_kwd"]};class Qy{constructor(e,r,n){xs(this,"tabAdNetworkMap",this.restoreTabAdNetwork()),xs(this,"lock",new Bs),xs(this,"logger"),xs(this,"adNetworkGetter"),xs(this,"adFieldGetters");let s=0;this.logger=e,this.adNetworkGetter=r,this.adFieldGetters=n,we.webNavigation.onCommitted.addListener(a=>this.lock.runExclusive(async()=>{const{frameId:i,tabId:o,url:u,transitionQualifiers:l}=a;if(e==null||e.debug(`[ad-traffic-monitor] ${s++} webNavigation.onCommitted for frame ${i} on ${u}`),i!==0)return;if(l!=null&&l.includes("from_address_bar")){await this.removeAdHistory(o);return}const c=Zs(u);if(!c)return;const m=await this.findAdInfo(o);m&&(m==null?void 0:m.host)!==c.hostname&&await this.removeAdHistory(o),await this.processUrl(o,u)}))}async findAdInfo(e){return(await this.tabAdNetworkMap)[e??-1]}async processUrl(e,r){var u,l,c;const n=new URL(r),s=(u=(await this.adNetworkGetter()).find(m=>m.regexes.some(d=>{if(new RegExp(d).test(r))return!0})))==null?void 0:u.name,a=await this.adFieldGetters(),i=this.tryGetParams(n,a.source);if(!s&&!i)return;const o={host:((l=Zs(r))==null?void 0:l.hostname)??"",adNetwork:s,utmSource:i,utmCampaign:this.tryGetParams(n,a.campaign),utmMedium:this.tryGetParams(n,a.medium),utmTerm:this.tryGetParams(n,a.term)};(c=this.logger)==null||c.debug(`[ad-traffic-monitor] Found ad network: ${s??"unknown"}`,o),await this.addAdHistory(e,o)}tryGetParams(e,r){for(const n of r){const s=e.searchParams.get(n);if(s)return s}}async restoreTabAdNetwork(){return await Ki(Ji)??{}}async removeAdHistory(e){const r=await this.tabAdNetworkMap;delete r[e],await Sn(Ji,r)}async addAdHistory(e,r){const n=await this.tabAdNetworkMap;n[e]=r,await Sn(Ji,n)}}var ew=Object.defineProperty,tw=(t,e,r)=>e in t?ew(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,En=(t,e,r)=>tw(t,typeof e!="symbol"?e+"":e,r);const Xu=class ti extends Aa{constructor(e){super(e.db,e.logger),this.config=e,En(this,"referrers"),En(this,"adTrafficMonitor"),En(this,"hasRecentUserActivity",!0),this.referrers=new Zy(this.logger),this.adTrafficMonitor=new Qy(this.logger,e.getAdNetworks,e.getAdFields)}async enabled(){return await this.config.enabled()}setHasRecentUserActivity(e){this.hasRecentUserActivity=e}setupCustomTriggers(){var e,r;this.setupExtensionStartupTriggers(),this.setupExtensionApiTriggers(),this.setupIdleTriggers(),(r=(e=this.config).setupCustomTriggers)==null||r.call(e,this)}getLastAliveAt(){return Ki(ti.LAST_ALIVE_AT_KEY)}async setLastAliveAt(e){await Sn(ti.LAST_ALIVE_AT_KEY,e)}async getComputeDependencies(){const[e,r]=await Promise.all([we.windows.getAll(),we.tabs.query({})]),n=await this.sessionsRepo.getActiveSessions(),s=await this.pageViewsRepo.getActivePageViews();return{isTabActiveWhenPlayingAudio:await this.config.isTabActiveWhenPlayingAudio(),hostnameToTabsMap:r.reduce((a,i)=>{var u,l;const o=(u=Zs(i.url))==null?void 0:u.hostname;return o&&(a[o]??(a[o]=[]),(l=a[o])==null||l.push(i)),a},{}),allActiveSessions:n,allActivePageViews:s,appIdToActiveSessionMap:Vy(n??[],"appId"),windowIdToWindowMap:Wy(e,"id"),processedActiveSessionCache:new Ju,processedActivePageViewCache:new Ju}}findSessionChanges(e,r){var i,o;const n=[],s=[];for(const[u,l]of Object.entries(r.hostnameToTabsMap))if(u)try{if(!(l!=null&&l.length))throw Error("This shouldn't be possible");const c=r.appIdToActiveSessionMap[u],m=!!(c!=null&&c.length),d=!!l.find(w=>this.isTabActive(w,r));!m&&d?n.push({appId:u,startedAt:e.timestamp}):m&&!d&&s.push(...c),m&&r.processedActiveSessionCache.markAsProcessed(c)}catch(c){(i=this.logger)==null||i.error(`[update-sessions] Failed find sessions to change for ${u}:`,c)}return(((o=r.allActiveSessions)==null?void 0:o.filter(u=>!r.processedActiveSessionCache.isProcessed(u)))??[]).forEach(u=>s.push(u)),Promise.resolve({toStart:n,toEnd:s,count:n.length+s.length})}async findPageViewChanges(e,r){var i;const n=Object.values(r.hostnameToTabsMap).flat().filter(o=>!!o&&this.isTabActive(o,r)),s=[],a=[...r.allActivePageViews];for(const o of n){const u=Zs(o.url);if(u==null)continue;const l=r.allActivePageViews.filter(c=>c.appId===(u==null?void 0:u.hostname)&&c.path===u.path&&(u.query?c.query===u.query:!0));if(l.length>0)for(const c of l){const m=a.findIndex(d=>d.id===c.id);m>=0&&a.splice(m,1)}else{const[c,m]=await Promise.all([this.adTrafficMonitor.findAdInfo(o.id),(i=this.referrers)==null?void 0:i.getReferrerFor(o.id,o.url)]),d={adNetwork:(c==null?void 0:c.adNetwork)??void 0,utmSource:(c==null?void 0:c.utmSource)??void 0,utmMedium:(c==null?void 0:c.utmMedium)??void 0,utmCampaign:(c==null?void 0:c.utmCampaign)??void 0,utmTerm:(c==null?void 0:c.utmTerm)??void 0};s.push({appId:u.hostname,path:u.path,query:u.query,startedAt:e.timestamp,referrer:m,...d})}}return{toStart:s,toEnd:a,count:s.length+a.length}}setupExtensionApiTriggers(){we.webNavigation.onCompleted.addListener(async e=>{e.frameId>0||await this.triggerSessionCheck("webNavigation.onCompleted",Math.floor(e.timeStamp))}),we.tabs.onCreated.addListener(()=>this.triggerSessionCheck("tabs.onCreated")),we.tabs.onUpdated.addListener(()=>this.triggerSessionCheck("tabs.onUpdated")),we.tabs.onActivated.addListener(()=>this.triggerSessionCheck("tabs.onActivated")),we.tabs.onRemoved.addListener(()=>this.triggerSessionCheck("tabs.onRemoved")),we.windows.onCreated.addListener(()=>this.triggerSessionCheck("windows.onCreated")),we.windows.onFocusChanged.addListener(()=>this.triggerSessionCheck("windows.onFocusChanged")),we.windows.onRemoved.addListener(()=>this.triggerSessionCheck("windows.onRemoved")),this.onWindowStateChanged(e=>this.triggerSessionCheck("SessionMonitor.onWindowStateChanged",e))}setupIdleTriggers(){}setupExtensionStartupTriggers(){this.config.isOnStartupAvailable()?we.runtime.onStartup.addListener(()=>{this.triggerStartup("runtime.onStartup",!0)}):(we.alarms.clear("ping-last-alive-at"),we.alarms.create("ping-last-alive-at",{delayInMinutes:Aa.LAST_ALIVE_AT_INTERVAL_MS/zi,periodInMinutes:Aa.LAST_ALIVE_AT_INTERVAL_MS/zi}),we.alarms.onAlarm.addListener(r=>{if(r.name==="ping-last-alive-at")return this.pingLastAliveAt()}),this.getLastAliveAt().then(r=>{const n=r!=null&&Date.now()-r>2*Aa.LAST_ALIVE_AT_INTERVAL_MS,s=n?"time since last alive at > 2 * lastAliveInterval":"time since last alive at <= 2 * lastAliveInterval";this.triggerStartup(s,n)})),we.runtime.onInstalled.addListener(r=>{this.triggerStartup("runtime.onInstalled",r.reason!=="install")});const{onSuspend:e}=we.runtime;e==null||e.addListener(()=>this.endAllActiveSessions(Date.now()))}isTabActive(e,r){var s;if(e.windowId==null)return(s=this.logger)==null||s.warn("[update-sessions] Checking if tab without a windowId is active"),!1;const n=r.windowIdToWindowMap[e.windowId];return!!n&&qy(e,n,this.hasRecentUserActivity,r.isTabActiveWhenPlayingAudio)}onWindowStateChanged(e){let r={};this.getWindowStates().then(n=>{r=n}),setInterval(async()=>{const n=Date.now(),s=await this.getWindowStates();zu(r,s)||(e(n),r=s)},ti.WINDOW_STATE_POLLING_INTERVAL_MS)}async getWindowStates(){return(await we.windows.getAll()).reduce((r,n)=>(n.id!=null&&(r[n.id]=n.state),r),{})}};En(Xu,"LAST_ALIVE_AT_KEY","last-activity-time-ms"),En(Xu,"WINDOW_STATE_POLLING_INTERVAL_MS",5*zi);class Ju{constructor(){En(this,"map",{})}markAsProcessed(e){e.forEach(r=>this.map[r.id]=!0)}isProcessed(e){return this.map[e.id]??!1}}const[mv,rw]=Wn("usage-database",()=>Fy({getInstallId:Yn})),nw=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,sw=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,aw=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function iw(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){ow(t);return}return e}function ow(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function cw(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const r=t.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!aw.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(nw.test(t)||sw.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,iw)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}const uw=/#/g,lw=/&/g,dw=/\//g,hw=/=/g,Qi=/\+/g,fw=/%5e/gi,mw=/%60/gi,gw=/%7c/gi,pw=/%20/gi;function yw(t){return encodeURI(""+t).replace(gw,"|")}function eo(t){return yw(typeof t=="string"?t:JSON.stringify(t)).replace(Qi,"%2B").replace(pw,"+").replace(uw,"%23").replace(lw,"%26").replace(mw,"`").replace(fw,"^").replace(dw,"%2F")}function to(t){return eo(t).replace(hw,"%3D")}function Qu(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function ww(t){return Qu(t.replace(Qi," "))}function bw(t){return Qu(t.replace(Qi," "))}function Aw(t=""){const e=Object.create(null);t[0]==="?"&&(t=t.slice(1));for(const r of t.split("&")){const n=r.match(/([^=]+)=?(.*)/)||[];if(n.length<2)continue;const s=ww(n[1]);if(s==="__proto__"||s==="constructor")continue;const a=bw(n[2]||"");e[s]===void 0?e[s]=a:Array.isArray(e[s])?e[s].push(a):e[s]=[e[s],a]}return e}function vw(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(r=>`${to(t)}=${eo(r)}`).join("&"):`${to(t)}=${eo(e)}`:to(t)}function _w(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>vw(e,t[e])).filter(Boolean).join("&")}const xw=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,Tw=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Sw=/^([/\\]\s*){2,}[^/\\]/,Ew=/^\.?\//;function el(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?xw.test(t):Tw.test(t)||(e.acceptRelative?Sw.test(t):!1)}function kw(t="",e){return t.endsWith("/")}function Ow(t="",e){return(kw(t)?t.slice(0,-1):t)||"/"}function Pw(t="",e){return t.endsWith("/")?t:t+"/"}function Mw(t,e){if(Iw(e)||el(t))return t;const r=Ow(e);return t.startsWith(r)?t:Dw(r,t)}function Cw(t,e){const r=Rw(t),n={...Aw(r.search),...e};return r.search=_w(n),Lw(r)}function Iw(t){return!t||t==="/"}function Nw(t){return t&&t!=="/"}function Dw(t,...e){let r=t||"";for(const n of e.filter(s=>Nw(s)))if(r){const s=n.replace(Ew,"");r=Pw(r)+s}else r=n;return r}const tl=Symbol.for("ufo:protocolRelative");function Rw(t="",e){const r=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){const[,m,d=""]=r;return{protocol:m.toLowerCase(),pathname:d,href:m+d,auth:"",host:"",search:"",hash:""}}if(!el(t,{acceptRelative:!0}))return rl(t);const[,n="",s,a=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,i="",o=""]=a.match(/([^#/?]*)(.*)?/)||[];n==="file:"&&(o=o.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:u,search:l,hash:c}=rl(o);return{protocol:n.toLowerCase(),auth:s?s.slice(0,Math.max(0,s.length-1)):"",host:i,pathname:u,search:l,hash:c,[tl]:!n}}function rl(t=""){const[e="",r="",n=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:r,hash:n}}function Lw(t){const e=t.pathname||"",r=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",n=t.hash||"",s=t.auth?t.auth+"@":"",a=t.host||"";return(t.protocol||t[tl]?(t.protocol||"")+"//":"")+s+a+e+r+n}class $w extends Error{constructor(e,r){super(e,r),this.name="FetchError",r!=null&&r.cause&&!this.cause&&(this.cause=r.cause)}}function Fw(t){var u,l,c,m,d;const e=((u=t.error)==null?void 0:u.message)||((l=t.error)==null?void 0:l.toString())||"",r=((c=t.request)==null?void 0:c.method)||((m=t.options)==null?void 0:m.method)||"GET",n=((d=t.request)==null?void 0:d.url)||String(t.request)||"/",s=`[${r}] ${JSON.stringify(n)}`,a=t.response?`${t.response.status} ${t.response.statusText}`:"<no response>",i=`${s}: ${a}${e?` ${e}`:""}`,o=new $w(i,t.error?{cause:t.error}:void 0);for(const w of["request","options","response"])Object.defineProperty(o,w,{get(){return t[w]}});for(const[w,A]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(o,w,{get(){return t.response&&t.response[A]}});return o}const jw=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function nl(t="GET"){return jw.has(t.toUpperCase())}function Uw(t){if(t===void 0)return!1;const e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.buffer?!1:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const Vw=new Set(["image/svg","application/xml","application/xhtml","application/html"]),Ww=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Bw(t=""){if(!t)return"json";const e=t.split(";").shift()||"";return Ww.test(e)?"json":Vw.has(e)||e.startsWith("text/")?"text":"blob"}function qw(t,e,r,n){const s=Hw((e==null?void 0:e.headers)??(t==null?void 0:t.headers),r==null?void 0:r.headers,n);let a;return(r!=null&&r.query||r!=null&&r.params||e!=null&&e.params||e!=null&&e.query)&&(a={...r==null?void 0:r.params,...r==null?void 0:r.query,...e==null?void 0:e.params,...e==null?void 0:e.query}),{...r,...e,query:a,params:a,headers:s}}function Hw(t,e,r){if(!e)return new r(t);const n=new r(e);if(t)for(const[s,a]of Symbol.iterator in t||Array.isArray(t)?t:new r(t))n.set(s,a);return n}async function xa(t,e){if(e)if(Array.isArray(e))for(const r of e)await r(t);else await e(t)}const Gw=new Set([408,409,425,429,500,502,503,504]),Yw=new Set([101,204,205,304]);function sl(t={}){const{fetch:e=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:n=globalThis.AbortController}=t;async function s(o){const u=o.error&&o.error.name==="AbortError"&&!o.options.timeout||!1;if(o.options.retry!==!1&&!u){let c;typeof o.options.retry=="number"?c=o.options.retry:c=nl(o.options.method)?0:1;const m=o.response&&o.response.status||500;if(c>0&&(Array.isArray(o.options.retryStatusCodes)?o.options.retryStatusCodes.includes(m):Gw.has(m))){const d=typeof o.options.retryDelay=="function"?o.options.retryDelay(o):o.options.retryDelay||0;return d>0&&await new Promise(w=>setTimeout(w,d)),a(o.request,{...o.options,retry:c-1})}}const l=Fw(o);throw Error.captureStackTrace&&Error.captureStackTrace(l,a),l}const a=async function(u,l={}){const c={request:u,options:qw(u,l,t.defaults,r),response:void 0,error:void 0};c.options.method&&(c.options.method=c.options.method.toUpperCase()),c.options.onRequest&&await xa(c,c.options.onRequest),typeof c.request=="string"&&(c.options.baseURL&&(c.request=Mw(c.request,c.options.baseURL)),c.options.query&&(c.request=Cw(c.request,c.options.query),delete c.options.query),"query"in c.options&&delete c.options.query,"params"in c.options&&delete c.options.params),c.options.body&&nl(c.options.method)&&(Uw(c.options.body)?(c.options.body=typeof c.options.body=="string"?c.options.body:JSON.stringify(c.options.body),c.options.headers=new r(c.options.headers||{}),c.options.headers.has("content-type")||c.options.headers.set("content-type","application/json"),c.options.headers.has("accept")||c.options.headers.set("accept","application/json")):("pipeTo"in c.options.body&&typeof c.options.body.pipeTo=="function"||typeof c.options.body.pipe=="function")&&("duplex"in c.options||(c.options.duplex="half")));let m;if(!c.options.signal&&c.options.timeout){const w=new n;m=setTimeout(()=>{const A=new Error("[TimeoutError]: The operation was aborted due to timeout");A.name="TimeoutError",A.code=23,w.abort(A)},c.options.timeout),c.options.signal=w.signal}try{c.response=await e(c.request,c.options)}catch(w){return c.error=w,c.options.onRequestError&&await xa(c,c.options.onRequestError),await s(c)}finally{m&&clearTimeout(m)}if((c.response.body||c.response._bodyInit)&&!Yw.has(c.response.status)&&c.options.method!=="HEAD"){const w=(c.options.parseResponse?"json":c.options.responseType)||Bw(c.response.headers.get("content-type")||"");switch(w){case"json":{const A=await c.response.text(),f=c.options.parseResponse||cw;c.response._data=f(A);break}case"stream":{c.response._data=c.response.body||c.response._bodyInit;break}default:c.response._data=await c.response[w]()}}return c.options.onResponse&&await xa(c,c.options.onResponse),!c.options.ignoreResponseError&&c.response.status>=400&&c.response.status<600?(c.options.onResponseError&&await xa(c,c.options.onResponseError),await s(c)):c.response},i=async function(u,l){return(await a(u,l))._data};return i.raw=a,i.native=(...o)=>e(...o),i.create=(o={},u={})=>sl({...t,...u,defaults:{...t.defaults,...u.defaults,...o}}),i}const Ta=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),Zw=Ta.fetch?(...t)=>Ta.fetch(...t):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),zw=Ta.Headers,Kw=Ta.AbortController,Xw=sl({fetch:Zw,Headers:zw,AbortController:Kw});var ro={exports:{}};(function(t,e){(function(r,n){var s="1.0.40",a="",i="?",o="function",u="undefined",l="object",c="string",m="major",d="model",w="name",A="type",f="vendor",g="version",b="architecture",S="console",x="mobile",E="tablet",C="smarttv",y="wearable",T="embedded",_=500,P="Amazon",N="Apple",U="ASUS",G="BlackBerry",I="Browser",K="Chrome",L="Edge",H="Firefox",W="Google",O="Huawei",Z="LG",Q="Microsoft",ye="Motorola",Oe="Opera",Ze="Samsung",ze="Sharp",fe="Sony",_t="Xiaomi",be="Zebra",ft="Facebook",Qr="Chromium OS",pt="Mac OS",kr=" Browser",Or=function(le,de){var ne={};for(var pe in le)de[pe]&&de[pe].length%2===0?ne[pe]=de[pe].concat(le[pe]):ne[pe]=le[pe];return ne},ir=function(le){for(var de={},ne=0;ne<le.length;ne++)de[le[ne].toUpperCase()]=le[ne];return de},Pr=function(le,de){return typeof le===c?Lt(de).indexOf(Lt(le))!==-1:!1},Lt=function(le){return le.toLowerCase()},Pn=function(le){return typeof le===c?le.replace(/[^\d\.]/g,a).split(".")[0]:n},en=function(le,de){if(typeof le===c)return le=le.replace(/^\s\s*/,a),typeof de===u?le:le.substring(0,_)},or=function(le,de){for(var ne=0,pe,Me,at,me,J,Ve;ne<de.length&&!J;){var Kt=de[ne],Ir=de[ne+1];for(pe=Me=0;pe<Kt.length&&!J&&Kt[pe];)if(J=Kt[pe++].exec(le),J)for(at=0;at<Ir.length;at++)Ve=J[++Me],me=Ir[at],typeof me===l&&me.length>0?me.length===2?typeof me[1]==o?this[me[0]]=me[1].call(this,Ve):this[me[0]]=me[1]:me.length===3?typeof me[1]===o&&!(me[1].exec&&me[1].test)?this[me[0]]=Ve?me[1].call(this,Ve,me[2]):n:this[me[0]]=Ve?Ve.replace(me[1],me[2]):n:me.length===4&&(this[me[0]]=Ve?me[3].call(this,Ve.replace(me[1],me[2])):n):this[me]=Ve||n;ne+=2}},Mr=function(le,de){for(var ne in de)if(typeof de[ne]===l&&de[ne].length>0){for(var pe=0;pe<de[ne].length;pe++)if(Pr(de[ne][pe],le))return ne===i?n:ne}else if(Pr(de[ne],le))return ne===i?n:ne;return de.hasOwnProperty("*")?de["*"]:le},Cs={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Mn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Cn={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[w,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[w,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[w,g],[/opios[\/ ]+([\w\.]+)/i],[g,[w,Oe+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[g,[w,Oe+" GX"]],[/\bopr\/([\w\.]+)/i],[g,[w,Oe]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[g,[w,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[g,[w,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[w,g],[/quark(?:pc)?\/([-\w\.]+)/i],[g,[w,"Quark"]],[/\bddg\/([\w\.]+)/i],[g,[w,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[w,"UC"+I]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[g,[w,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[w,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[w,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[w,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[g,[w,"Smart Lenovo "+I]],[/(avast|avg)\/([\w\.]+)/i],[[w,/(.+)/,"$1 Secure "+I],g],[/\bfocus\/([\w\.]+)/i],[g,[w,H+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[w,Oe+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[w,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[w,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[w,Oe+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[w,"MIUI"+kr]],[/fxios\/([\w\.-]+)/i],[g,[w,H]],[/\bqihoobrowser\/?([\w\.]*)/i],[g,[w,"360"]],[/\b(qq)\/([\w\.]+)/i],[[w,/(.+)/,"$1Browser"],g],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[w,/(.+)/,"$1"+kr],g],[/samsungbrowser\/([\w\.]+)/i],[g,[w,Ze+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[g,[w,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[w,"Sogou Mobile"],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[w,g],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[w],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[g,w],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[w,ft],g],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[w,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[w,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[w,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[w,K+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[w,K+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[w,"Android "+I]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[w,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[w,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,w],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[w,[g,Mr,Cs]],[/(webkit|khtml)\/([\w\.]+)/i],[w,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[w,"Netscape"],g],[/(wolvic|librewolf)\/([\w\.]+)/i],[w,g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[w,H+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[w,[g,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[w,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[b,"amd64"]],[/(ia32(?=;))/i],[[b,Lt]],[/((?:i[346]|x)86)[;\)]/i],[[b,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[b,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[b,"armhf"]],[/windows (ce|mobile); ppc;/i],[[b,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[b,/ower/,a,Lt]],[/(sun4\w)[;\)]/i],[[b,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[b,Lt]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,Ze],[A,E]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,Ze],[A,x]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,N],[A,x]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,N],[A,E]],[/(macintosh);/i],[d,[f,N]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,ze],[A,x]],[/(?:honor)([-\w ]+)[;\)]/i],[d,[f,"Honor"],[A,x]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,O],[A,E]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,O],[A,x]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[f,_t],[A,x]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,_t],[A,E]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[A,x]],[/\b(opd2\d{3}a?) bui/i],[d,[f,"OPPO"],[A,E]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[A,x]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[A,x]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,ye],[A,x]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,ye],[A,E]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,Z],[A,E]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,Z],[A,x]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[A,E]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[A,x]],[/(pixel c)\b/i],[d,[f,W],[A,E]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,W],[A,x]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,fe],[A,x]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,fe],[A,E]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[A,x]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,P],[A,E]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,P],[A,x]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[A,E]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,G],[A,x]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,U],[A,E]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,U],[A,x]],[/(nexus 9)/i],[d,[f,"HTC"],[A,E]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[A,x]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[f,"TCL"],[A,E]],[/(itel) ((\w+))/i],[[f,Lt],d,[A,Mr,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[A,E]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[A,x]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[A,x]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[d,[f,"Energizer"],[A,x]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[d,[f,"Cat"],[A,x]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[d,[f,"Smartfren"],[A,x]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[f,"Nothing"],[A,x]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[A,x]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[A,E]],[/(surface duo)/i],[d,[f,Q],[A,E]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[A,x]],[/(u304aa)/i],[d,[f,"AT&T"],[A,x]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[A,x]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[A,E]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[A,E]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[A,E]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[A,E]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[A,E]],[/\b(k88) b/i],[d,[f,"ZTE"],[A,E]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[A,x]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[A,x]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[A,E]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[A,E]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[A,E]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[A,E]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[A,E]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[A,x]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[A,x]],[/\b(ph-1) /i],[d,[f,"Essential"],[A,x]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[A,E]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[A,E]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[A,E]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[A,E]],[/(sprint) (\w+)/i],[f,d,[A,x]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,Q],[A,x]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,be],[A,E]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,be],[A,x]],[/smart-tv.+(samsung)/i],[f,[A,C]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,Ze],[A,C]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,Z],[A,C]],[/(apple) ?tv/i],[f,[d,N+" TV"],[A,C]],[/crkey/i],[[d,K+"cast"],[f,W],[A,C]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,P],[A,C]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,ze],[A,C]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,fe],[A,C]],[/(mitv-\w{5}) bui/i],[d,[f,_t],[A,C]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[A,C]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,en],[d,en],[A,C]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[A,C]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[A,S]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[A,S]],[/(playstation [345portablevi]+)/i],[d,[f,fe],[A,S]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,Q],[A,S]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[f,Ze],[A,y]],[/((pebble))app/i],[f,d,[A,y]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,N],[A,y]],[/droid.+; (glass) \d/i],[d,[f,W],[A,y]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,be],[A,y]],[/droid.+; (glass) \d/i],[d,[f,W],[A,y]],[/(pico) (4|neo3(?: link|pro)?)/i],[f,d,[A,y]],[/; (quest( \d| pro)?)/i],[d,[f,ft],[A,y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[A,T]],[/(aeobc)\b/i],[d,[f,P],[A,T]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[A,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[A,E]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[A,E]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[A,x]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[w,L+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[w,g],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[w,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[w,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,w]],os:[[/microsoft (windows) (vista|xp)/i],[w,g],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[w,[g,Mr,Mn]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,Mr,Mn],[w,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[w,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[w,pt],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,w],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[w,g],[/\(bb(10);/i],[g,[w,G]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[w,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[w,H+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[w,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[w,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[w,K+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[w,Qr],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[w,g],[/(sunos) ?([\w\.\d]*)/i],[[w,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[w,g]]},Ke=function(le,de){if(typeof le===l&&(de=le,le=n),!(this instanceof Ke))return new Ke(le,de).getResult();var ne=typeof r!==u&&r.navigator?r.navigator:n,pe=le||(ne&&ne.userAgent?ne.userAgent:a),Me=ne&&ne.userAgentData?ne.userAgentData:n,at=de?Or(Cn,de):Cn,me=ne&&ne.userAgent==pe;return this.getBrowser=function(){var J={};return J[w]=n,J[g]=n,or.call(J,pe,at.browser),J[m]=Pn(J[g]),me&&ne&&ne.brave&&typeof ne.brave.isBrave==o&&(J[w]="Brave"),J},this.getCPU=function(){var J={};return J[b]=n,or.call(J,pe,at.cpu),J},this.getDevice=function(){var J={};return J[f]=n,J[d]=n,J[A]=n,or.call(J,pe,at.device),me&&!J[A]&&Me&&Me.mobile&&(J[A]=x),me&&J[d]=="Macintosh"&&ne&&typeof ne.standalone!==u&&ne.maxTouchPoints&&ne.maxTouchPoints>2&&(J[d]="iPad",J[A]=E),J},this.getEngine=function(){var J={};return J[w]=n,J[g]=n,or.call(J,pe,at.engine),J},this.getOS=function(){var J={};return J[w]=n,J[g]=n,or.call(J,pe,at.os),me&&!J[w]&&Me&&Me.platform&&Me.platform!="Unknown"&&(J[w]=Me.platform.replace(/chrome os/i,Qr).replace(/macos/i,pt)),J},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return pe},this.setUA=function(J){return pe=typeof J===c&&J.length>_?en(J,_):J,this},this.setUA(pe),this};Ke.VERSION=s,Ke.BROWSER=ir([w,g,m]),Ke.CPU=ir([b]),Ke.DEVICE=ir([d,f,A,S,x,C,E,y,T]),Ke.ENGINE=Ke.OS=ir([w,g]),t.exports&&(e=t.exports=Ke),e.UAParser=Ke;var zt=typeof r!==u&&(r.jQuery||r.Zepto);if(zt&&!zt.ua){var Cr=new Ke;zt.ua=Cr.getResult(),zt.ua.get=function(){return Cr.getUA()},zt.ua.set=function(le){Cr.setUA(le);var de=Cr.getResult();for(var ne in de)zt.ua[ne]=de[ne]}}})(typeof window=="object"?window:Pt)})(ro,ro.exports);var al=ro.exports;const il=Fr(al);var Jw=Object.defineProperty,Qw=(t,e,r)=>e in t?Jw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,eb=(t,e,r)=>Qw(t,e+"",r);class tb extends Error{constructor(){super("Invalid code entered")}}class rb extends Error{constructor(){super("Both devices already belong to a device group")}}class nb extends Error{constructor(){super("Forbidden")}}const ol=class sc extends Error{static matchesMessage(e){return e instanceof Error?e.message===sc.message:!1}constructor(){super(sc.message)}};eb(ol,"message","Not in a device group");let Sa=ol;function Ts(t,e){return Object.entries(t).flatMap(([r,n])=>n.sessions.map(s=>({appId:r,startedAt:s.timestamp*1e3,endedAt:(s.timestamp+s.duration)*1e3,installId:s.install_id,platform:e})))}function cl(t){return new Date(t).toISOString()}function sb(t){const e=Xw.create({retry:3,...t==null?void 0:t.ofetchDefaults}),r=(t==null?void 0:t.formatDeviceName)??(O=>O),n=t==null?void 0:t.logger;function s(O){return e("/v1/android/apps",{query:{app_ids:O.appIds.join(",")}})}async function a(O){const Z=await e("/v1/sync/pairing/generate",{method:"POST",retry:0,query:{install_id:O.installId}});return{code:Z.code,expiration:new Date(Z.expiration*1e3).getTime()}}function i(O){return e("/v1/sync/pairing/validate",{method:"POST",retry:0,query:{install_id:O.installId,code:O.code}}).catch(Z=>{var ye;const Q=(ye=Z.response)==null?void 0:ye.status;throw Q===403?new rb:Q===404?new tb:Z})}function o(O){return e("/v1/sync/pairing/check",{query:{install_id:O.installId}}).catch(Z=>{var Q;if(((Q=Z.response)==null?void 0:Q.status)!==404)throw Z})}async function u(O){return e("/v1/sync/devices",{query:{key:O.deviceGroupKey}}).catch(Z=>{var Q;throw((Q=Z.response)==null?void 0:Q.status)===404?new Sa:Z})}async function l(O){await e("/v1/sync/devices/remove",{method:"POST",retry:0,query:{key:O.deviceGroupKey,install_id:O.installIdToRemove}})}async function c(O){return(await e.raw("/v1/sync/devices/sessions",{method:"HEAD",query:{key:O.deviceGroupKey,install_id:O.installId}}).catch(Q=>{var ye;throw((ye=Q.response)==null?void 0:ye.status)===404?new Sa:Q})).headers.get("Last-Modified")??void 0}async function m(O){return e("/v1/analytics/avg_usage",{query:{app_ids:O.appIds.join(","),gender:O.gender,country_code:O.countryCode}})}async function d(O){return e("/v1/analytics/avg_web_usage",{query:{websites:O.appIds.join(","),gender:O.gender,country_code:O.countryCode}})}async function w(O){return e("/v1/analytics/avg_desktop_usage",{query:{app_names:O.appIds.join(","),gender:O.gender,country_code:O.countryCode}})}async function A(O){return e("/v1/analytics/avg_web_device_usage",{query:{gender:O.gender,country_code:O.countryCode}})}async function f(O){return e("/v1/analytics/avg_desktop_device_usage",{query:{gender:O.gender,country_code:O.countryCode}})}async function g(O){var ze;const{android_apps:Z,websites:Q,windows_apps:ye,mac_apps:Oe,linux_apps:Ze}=await e("/v1/sync/devices/sessions",{query:{key:O.deviceGroupKey,install_id:O.installId,start_time:cl(O.startTime),end_time:cl(O.endTime),app_ids:(ze=O.appIds)==null?void 0:ze.join(",")}}).catch(fe=>{var _t;throw((_t=fe.response)==null?void 0:_t.status)===404?new Sa:fe});return[...Ts(Z,"android"),...Ts(ye??{},"windows"),...Ts(Oe??{},"mac"),...Ts(Ze??{},"linux"),...Ts(Q,"web")].sort((fe,_t)=>fe.startedAt-_t.startedAt)}async function b(O){var ye;if(!O.appId.trim()){const{websites:Oe,diffPrivateWebsites:Ze,...ze}=O;throw n==null||n.error("Missing required parameter 'appId'",ze),Error("Missing required parameter 'appId'")}if(!O.installId.trim()){const{websites:Oe,diffPrivateWebsites:Ze,...ze}=O;throw n==null||n.error("Missing required parameter 'installId'",ze),Error("Missing required parameter 'installId'")}const Z=il(navigator==null?void 0:navigator.userAgent),Q={app_id:O.appId,install_id:O.installId,time_zone:Gn(),device_name:r((ye=Z.browser)==null?void 0:ye.name),device_type:Z.os.name,birth_year:O.birthYear,websites:O.websites,diff_private_websites:O.diffPrivateWebsites};await e("/v1/web/upload",{method:"POST",retry:0,body:Q})}async function S(O){var ye;if(!O.appId.trim()){const{websites:Oe,diffPrivateWebsites:Ze,...ze}=O;throw n==null||n.error("Missing required parameter 'appId'",ze),Error("Missing required parameter 'appId'")}if(!O.installId.trim()){const{websites:Oe,diffPrivateWebsites:Ze,...ze}=O;throw n==null||n.error("Missing required parameter 'installId'",ze),Error("Missing required parameter 'installId'")}const Z=il(navigator==null?void 0:navigator.userAgent),Q={app_id:O.appId,install_id:O.installId,time_zone:Gn(),device_name:r((ye=Z.browser)==null?void 0:ye.name),device_type:Z.os.name,birth_year:O.birthYear,websites:O.websites,diff_private_websites:O.diffPrivateWebsites};await e("/v1/page_views/upload",{method:"POST",retry:0,body:Q})}async function x(O){if(!O.appId.trim()){const{apps:Q,...ye}=O;throw n==null||n.error("Missing required parameter 'appId'",ye),Error("Missing required parameter 'appId'")}if(!O.installId.trim()){const{apps:Q,...ye}=O;throw n==null||n.error("Missing required parameter 'installId'",ye),Error("Missing required parameter 'installId'")}const Z={app_id:O.appId,install_id:O.installId,time_zone:Gn(),device_name:r("App"),device_type:O.platform,birth_year:O.birthYear,apps:O.apps};await e("/v1/desktop/upload",{method:"POST",retry:0,body:Z})}function E(O){return b({appId:O.appId,installId:O.installId,websites:{}})}function C(O){return x({appId:O.appId,installId:O.installId,platform:O.platform})}function y(O){return e("/v1/brands",{query:{install_id:O.installId}}).catch(Z=>{var Q;throw((Q=Z.response)==null?void 0:Q.status)===403?new nb:Z})}function T(O){return e("/v1/sync/config",{query:{key:O.deviceGroupKey}}).catch(Z=>{var Q;throw((Q=Z.response)==null?void 0:Q.status)===404?new Sa:Z})}async function _(O){await e("/v1/sync/config/reset_time",{method:"POST",retry:0,body:O})}async function P(O){await e("/v1/sync/config/daily_reset_time",{method:"POST",retry:0,body:O})}async function N(O){await e("/v1/sync/config/ignore_list/remove",{method:"POST",retry:0,body:O})}async function U(O){await e("/v1/sync/config/ignore_list/add",{method:"POST",retry:0,body:O})}async function G(O){const Z={key:O.key,generic_limits:O.genericLimits};await e("/v1/sync/config/generic_limit/add",{method:"POST",retry:0,body:Z})}async function I(O){const Z={key:O.key,limit_ids:O.limitIds};await e("/v1/sync/config/generic_limit/remove",{method:"POST",retry:0,body:Z})}async function K(O){const Z={app_id:O.appId,install_id:O.installId,time_zone:Gn(),ads:O.ads};await e("/v1/desktop/retail/"+O.website,{method:"POST",retry:0,body:Z})}async function L(O){const Z={app_id:O.appId,time_zone:Gn(),prompts:O.prompts};await e("/v1/ai/analytics",{method:"POST",retry:0,body:Z})}async function H(O){const Z={app_id:O.appId,service:O.service,install_id:O.installId,status:O.status,timestamp:Math.round(Date.now()/1e3)};await e("/v1/subscriptions/status",{method:"POST",retry:0,body:Z})}async function W(O){await e(`/v1/analytics/optout?install_id=${O.installId}&opt_out=${O.optOut}`,{retry:0})}return{getAndroidAppInfo:s,createPairingCode:a,validatePairingCode:i,getMyDeviceGroup:o,getSessionsLastUploadedAt:c,getAverageAppUsage:m,getAverageWebUsage:d,getAverageDesktopUsage:w,getTotalAverageWebUsage:A,getTotalAverageDesktopUsage:f,listDeviceGroupDevices:u,removeDeviceFromDeviceGroup:l,listDeviceGroupSessions:g,uploadSessions:b,uploadPageViews:S,uploadDesktopUsage:x,createDevice:E,createDesktopDevice:C,getBrandMapping:y,getGroupConfig:T,setResetTime:_,setDailyResetTime:P,removeFromIgnoreList:N,addToIgnoreList:U,addGenericUsageLimit:G,removeGenericUsageLimit:I,uploadRetailAds:K,uploadPrompts:L,uploadSubscriptionStatus:H,optOut:W}}const[gv,ab]=Wn("BackgroundApi",()=>sb({ofetchDefaults:{baseURL:"https://stayfocusd.st-panel-api.com"}})),Ea={Android:"android",Web:"web",Desktop:"desktop"},ka={...{...Ea,AppGroup:"app-group"}};6*he.Hour;async function kn(){return await Ol.getValue()||[]}function ib(t,e,r){switch(r){case ka.Web:return t.find(n=>n.websites.includes(e));case ka.Android:return t.find(n=>n.android_apps.find(s=>s.id===e));case ka.Desktop:return t.find(n=>{var s;return(s=n.desktop_apps)==null?void 0:s.find(a=>a.name===e||ob([e],a.alternative_names??[],a.reg_exps??[]))})}}function ob(t,e,r){return t.some(n=>e.includes(n))||r.some(n=>cb(t,n))}function cb(t,e){try{const r=new RegExp("^"+e+"$","i");return t.some(n=>r.test(n))}catch{return!1}}const ub={StayFocusdPage:"https://stayfocusd.com"};var Oa=(t=>(t.BlockedSites="blocked-sites",t.AllExceptAllowed="all-except-allowed",t.All="all",t))(Oa||{});function no(t,e,r,n,s,a=[]){var o,u,l;if(On(t,ub.StayFocusdPage))return;const i=()=>{if(r.some(c=>On(t,c)))return!0};if(e.type==qt.BlockAll)return i()?"allowed":"blocked";if(e.type==qt.Group)return i()?"allowed":Pa(t,e.blocklist,e.brandIds,s);if(e.type==qt.Nuclear){if(((o=e.options)==null?void 0:o.blockType)==Oa.BlockedSites)return i()?"allowed":Pa(t,n,a,s,!0);if(((u=e.options)==null?void 0:u.blockType)==Oa.All)return"blocked-nuclear";if(((l=e.options)==null?void 0:l.blockType)==Oa.AllExceptAllowed)return i()?"allowed":"blocked-nuclear"}}function Pa(t,e,r,n,s=!1){const a=s?"blocked-nuclear":"blocked";if(e&&e.some(i=>On(t,i)))return a;if(r&&r.length>0){let i;return r.forEach(o=>{const u=n.find(m=>m.brand_id.toString()==o);if(!u)return;const l=u.android_apps;if(l&&l.some(m=>On(t,m.id))){i=a;return}const c=u.websites;if(c&&c.some(m=>On(t,m))){i=a;return}}),i}}function On(t,e){return lb(e,t)||fb(e,t)}function ul(t){return t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.replace(/^https:\/\//,"").replace(/^http:\/\//,"").replace(/^www./,"")}function lb(t,e){if(e=ul(e.toLowerCase()),t=ul(t.toLowerCase()),e.indexOf(t)===0)return!0;const r=ll(e),n=ll(t);return t===e||t===r||n===r&&t.length<=e.length&&e.indexOf(t)>=0&&(e.indexOf("/")>=0||e.indexOf("?")>=0)||r.length>n.length&&r.indexOf(t)>-1}function db(t){if(!t)return null;const e=t.match(/^(.[^/]*?:\/\/)?(.[^/]+)/);if(e===null||e.length<2)return t.split("/")[0];let r=e[2];return r.startsWith("www.")&&(r=r.replace("www.","")),r}function ll(t){const e=db(t);if(!e||e.length===0)return"";const r=e.split(".");if(r.length===1)return e;let n=r[r.length-1];return n=r[r.length-2]+"."+n,hb(e)&&(n=r[r.length-3]+"."+n),n}function hb(t){const e=t.split(".");let r=[];if(e.length===1)return!1;const n=e[e.length-2];if(n.length===1||n.length===2&&e.length>3)return!0;if(n.length===3&&e.length>=3){r=["com","edu","gov","mil","net","org","biz","www","pro","int","web","xxx"];for(const s in r)if(n===r[s])return!0}if(n.length===4&&e.length>=3){r=["info","mobi","name","jobs","kiwi","aero","asia","coop"];for(const s in r)if(n===r[s])return!0}if(e.length>=3){const s=e[e.length-3];if(n.length===2&&e.length===3&&s.length>2&&s!=="www")return!0}return!1}function fb(t,e){if(t.indexOf("*")==-1)return!1;t=t.toLowerCase(),e=e.toLowerCase();const r=t.replace("*","");if(e=e||"",e.indexOf(r)===-1)return!1;const n=e.substring(0,e.indexOf(r)+r.length),a=e.substring(n.length-r.length,n.length)===r;return a&&ni("matchesWildcard",`Does ${e} match wildcard  ${t}?`,"YES"),a}class so{constructor(e){ce(this,"obj",{});if(e!=null&&e.length)for(const r of e)this.obj[r]=!0}add(e){return this.obj[e]=!0,this}has(e){return this.obj[e]!=null}toArray(){return Object.keys(this.obj)}}function Ma(t){switch(t){case"android":return Ea.Android;case"web":return Ea.Web;case"windows":case"mac":case"linux":return Ea.Desktop}throw Error(`'${t}' platform not supported yet`)}function mb(t){return Ur("device_platform_"+t.replace("-","_"))}var Ca={exports:{}};Ca.exports,function(t,e){var r=200,n="Expected a function",s="__lodash_hash_undefined__",a=1,i=2,o=9007199254740991,u="[object Arguments]",l="[object Array]",c="[object Boolean]",m="[object Date]",d="[object Error]",w="[object Function]",A="[object GeneratorFunction]",f="[object Map]",g="[object Number]",b="[object Object]",S="[object Promise]",x="[object RegExp]",E="[object Set]",C="[object String]",y="[object Symbol]",T="[object WeakMap]",_="[object ArrayBuffer]",P="[object DataView]",N="[object Float32Array]",U="[object Float64Array]",G="[object Int8Array]",I="[object Int16Array]",K="[object Int32Array]",L="[object Uint8Array]",H="[object Uint8ClampedArray]",W="[object Uint16Array]",O="[object Uint32Array]",Z=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,ye=/^\./,Oe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ze=/[\\^$.*+?()[\]{}|]/g,ze=/\\(\\)?/g,fe=/^\[object .+?Constructor\]$/,_t=/^(?:0|[1-9]\d*)$/,be={};be[N]=be[U]=be[G]=be[I]=be[K]=be[L]=be[H]=be[W]=be[O]=!0,be[u]=be[l]=be[_]=be[c]=be[P]=be[m]=be[d]=be[w]=be[f]=be[g]=be[b]=be[x]=be[E]=be[C]=be[T]=!1;var ft=typeof Pt=="object"&&Pt&&Pt.Object===Object&&Pt,Qr=typeof self=="object"&&self&&self.Object===Object&&self,pt=ft||Qr||Function("return this")(),kr=e&&!e.nodeType&&e,Or=kr&&!0&&t&&!t.nodeType&&t,ir=Or&&Or.exports===kr,Pr=ir&&ft.process,Lt=function(){try{return Pr&&Pr.binding("util")}catch{}}(),Pn=Lt&&Lt.isTypedArray;function en(h,v,M,F){for(var ee=-1,Y=h?h.length:0;++ee<Y;){var ae=h[ee];v(F,ae,M(ae),h)}return F}function or(h,v){for(var M=-1,F=h?h.length:0;++M<F;)if(v(h[M],M,h))return!0;return!1}function Mr(h){return function(v){return v==null?void 0:v[h]}}function Cs(h,v){for(var M=-1,F=Array(h);++M<h;)F[M]=v(M);return F}function Mn(h){return function(v){return h(v)}}function Cn(h,v){return h==null?void 0:h[v]}function Ke(h){var v=!1;if(h!=null&&typeof h.toString!="function")try{v=!!(h+"")}catch{}return v}function zt(h){var v=-1,M=Array(h.size);return h.forEach(function(F,ee){M[++v]=[ee,F]}),M}function Cr(h,v){return function(M){return h(v(M))}}function le(h){var v=-1,M=Array(h.size);return h.forEach(function(F){M[++v]=F}),M}var de=Array.prototype,ne=Function.prototype,pe=Object.prototype,Me=pt["__core-js_shared__"],at=function(){var h=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),me=ne.toString,J=pe.hasOwnProperty,Ve=pe.toString,Kt=RegExp("^"+me.call(J).replace(Ze,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ir=pt.Symbol,Is=pt.Uint8Array,vo=pe.propertyIsEnumerable,cr=de.splice,Ua=Cr(Object.keys,Object),Ns=Dr(pt,"DataView"),tn=Dr(pt,"Map"),rn=Dr(pt,"Promise"),ur=Dr(pt,"Set"),nn=Dr(pt,"WeakMap"),lr=Dr(Object,"create"),Ds=k(Ns),sn=k(tn),_o=k(rn),xo=k(ur),To=k(nn),In=Ir?Ir.prototype:void 0,Rs=In?In.valueOf:void 0,Ls=In?In.toString:void 0;function $t(h){var v=-1,M=h?h.length:0;for(this.clear();++v<M;){var F=h[v];this.set(F[0],F[1])}}function dr(){this.__data__=lr?lr(null):{}}function So(h){return this.has(h)&&delete this.__data__[h]}function Eo(h){var v=this.__data__;if(lr){var M=v[h];return M===s?void 0:M}return J.call(v,h)?v[h]:void 0}function ko(h){var v=this.__data__;return lr?v[h]!==void 0:J.call(v,h)}function Oo(h,v){var M=this.__data__;return M[h]=lr&&v===void 0?s:v,this}$t.prototype.clear=dr,$t.prototype.delete=So,$t.prototype.get=Eo,$t.prototype.has=ko,$t.prototype.set=Oo;function Ft(h){var v=-1,M=h?h.length:0;for(this.clear();++v<M;){var F=h[v];this.set(F[0],F[1])}}function jt(){this.__data__=[]}function Po(h){var v=this.__data__,M=Rn(v,h);if(M<0)return!1;var F=v.length-1;return M==F?v.pop():cr.call(v,M,1),!0}function Mo(h){var v=this.__data__,M=Rn(v,h);return M<0?void 0:v[M][1]}function Co(h){return Rn(this.__data__,h)>-1}function Io(h,v){var M=this.__data__,F=Rn(M,h);return F<0?M.push([h,v]):M[F][1]=v,this}Ft.prototype.clear=jt,Ft.prototype.delete=Po,Ft.prototype.get=Mo,Ft.prototype.has=Co,Ft.prototype.set=Io;function Ut(h){var v=-1,M=h?h.length:0;for(this.clear();++v<M;){var F=h[v];this.set(F[0],F[1])}}function hr(){this.__data__={hash:new $t,map:new(tn||Ft),string:new $t}}function No(h){return Fn(this,h).delete(h)}function Do(h){return Fn(this,h).get(h)}function Ro(h){return Fn(this,h).has(h)}function Lo(h,v){return Fn(this,h).set(h,v),this}Ut.prototype.clear=hr,Ut.prototype.delete=No,Ut.prototype.get=Do,Ut.prototype.has=Ro,Ut.prototype.set=Lo;function Nn(h){var v=-1,M=h?h.length:0;for(this.__data__=new Ut;++v<M;)this.add(h[v])}function Dn(h){return this.__data__.set(h,s),this}function $o(h){return this.__data__.has(h)}Nn.prototype.add=Nn.prototype.push=Dn,Nn.prototype.has=$o;function Vt(h){this.__data__=new Ft(h)}function Xt(){this.__data__=new Ft}function Fo(h){return this.__data__.delete(h)}function jo(h){return this.__data__.get(h)}function Uo(h){return this.__data__.has(h)}function Vo(h,v){var M=this.__data__;if(M instanceof Ft){var F=M.__data__;if(!tn||F.length<r-1)return F.push([h,v]),this;M=this.__data__=new Ut(F)}return M.set(h,v),this}Vt.prototype.clear=Xt,Vt.prototype.delete=Fo,Vt.prototype.get=jo,Vt.prototype.has=Uo,Vt.prototype.set=Vo;function Wo(h,v){var M=Ae(h)||se(h)?Cs(h.length,String):[],F=M.length,ee=!!F;for(var Y in h)J.call(h,Y)&&!(ee&&(Y=="length"||js(Y,F)))&&M.push(Y);return M}function Rn(h,v){for(var M=h.length;M--;)if(Se(h[M][0],v))return M;return-1}function Ln(h,v,M,F){return Bo(h,function(ee,Y,ae){v(F,ee,M(ee),ae)}),F}var Bo=Jo(Va),an=Qo();function Va(h,v){return h&&an(h,v,un)}function $s(h,v){v=on(v,h)?[v]:qa(v);for(var M=0,F=v.length;h!=null&&M<F;)h=h[p(v[M++])];return M&&M==F?h:void 0}function qo(h){return Ve.call(h)}function Ho(h,v){return h!=null&&v in Object(h)}function Fs(h,v,M,F,ee){return h===v?!0:h==null||v==null||!it(h)&&!Fe(v)?h!==h&&v!==v:Go(h,v,Fs,M,F,ee)}function Go(h,v,M,F,ee,Y){var ae=Ae(h),qe=Ae(v),$e=l,ct=l;ae||($e=Et(h),$e=$e==u?b:$e),qe||(ct=Et(v),ct=ct==u?b:ct);var wt=$e==b&&!Ke(h),bt=ct==b&&!Ke(v),mt=$e==ct;if(mt&&!wt)return Y||(Y=new Vt),ae||yt(h)?Ha(h,v,M,F,ee,Y):fr(h,v,$e,M,F,ee,Y);if(!(ee&i)){var kt=wt&&J.call(h,"__wrapped__"),Ot=bt&&J.call(v,"__wrapped__");if(kt||Ot){var Rr=kt?h.value():h,gr=Ot?v.value():v;return Y||(Y=new Vt),M(Rr,gr,F,ee,Y)}}return mt?(Y||(Y=new Vt),Ga(h,v,M,F,ee,Y)):!1}function Wa(h,v,M,F){var ee=M.length,Y=ee;if(h==null)return!Y;for(h=Object(h);ee--;){var ae=M[ee];if(ae[2]?ae[1]!==h[ae[0]]:!(ae[0]in h))return!1}for(;++ee<Y;){ae=M[ee];var qe=ae[0],$e=h[qe],ct=ae[1];if(ae[2]){if($e===void 0&&!(qe in h))return!1}else{var wt=new Vt,bt;if(!(bt===void 0?Fs(ct,$e,F,a|i,wt):bt))return!1}}return!0}function Yo(h){if(!it(h)||cn(h))return!1;var v=ke(h)||Ke(h)?Kt:fe;return v.test(k(h))}function Zo(h){return Fe(h)&&Xe(h.length)&&!!be[Ve.call(h)]}function Ba(h){return typeof h=="function"?h:h==null?Un:typeof h=="object"?Ae(h)?zo(h[0],h[1]):Nr(h):Vn(h)}function $n(h){if(!Za(h))return Ua(h);var v=[];for(var M in Object(h))J.call(h,M)&&M!="constructor"&&v.push(M);return v}function Nr(h){var v=jn(h);return v.length==1&&v[0][2]?Ka(v[0][0],v[0][1]):function(M){return M===h||Wa(M,h,v)}}function zo(h,v){return on(h)&&za(v)?Ka(p(h),v):function(M){var F=Wt(M,h);return F===void 0&&F===v?mr(M,h):Fs(v,F,void 0,a|i)}}function Ko(h){return function(v){return $s(v,h)}}function Jt(h){if(typeof h=="string")return h;if(ot(h))return Ls?Ls.call(h):"";var v=h+"";return v=="0"&&1/h==-1/0?"-0":v}function qa(h){return Ae(h)?h:tc(h)}function Xo(h,v){return function(M,F){var ee=Ae(M)?en:Ln,Y=v?v():{};return ee(M,h,Ba(F),Y)}}function Jo(h,v){return function(M,F){if(M==null)return M;if(!Le(M))return h(M,F);for(var ee=M.length,Y=-1,ae=Object(M);++Y<ee&&F(ae[Y],Y,ae)!==!1;);return M}}function Qo(h){return function(v,M,F){for(var ee=-1,Y=Object(v),ae=F(v),qe=ae.length;qe--;){var $e=ae[++ee];if(M(Y[$e],$e,Y)===!1)break}return v}}function Ha(h,v,M,F,ee,Y){var ae=ee&i,qe=h.length,$e=v.length;if(qe!=$e&&!(ae&&$e>qe))return!1;var ct=Y.get(h);if(ct&&Y.get(v))return ct==v;var wt=-1,bt=!0,mt=ee&a?new Nn:void 0;for(Y.set(h,v),Y.set(v,h);++wt<qe;){var kt=h[wt],Ot=v[wt];if(F)var Rr=ae?F(Ot,kt,wt,v,h,Y):F(kt,Ot,wt,h,v,Y);if(Rr!==void 0){if(Rr)continue;bt=!1;break}if(mt){if(!or(v,function(gr,ln){if(!mt.has(ln)&&(kt===gr||M(kt,gr,F,ee,Y)))return mt.add(ln)})){bt=!1;break}}else if(!(kt===Ot||M(kt,Ot,F,ee,Y))){bt=!1;break}}return Y.delete(h),Y.delete(v),bt}function fr(h,v,M,F,ee,Y,ae){switch(M){case P:if(h.byteLength!=v.byteLength||h.byteOffset!=v.byteOffset)return!1;h=h.buffer,v=v.buffer;case _:return!(h.byteLength!=v.byteLength||!F(new Is(h),new Is(v)));case c:case m:case g:return Se(+h,+v);case d:return h.name==v.name&&h.message==v.message;case x:case C:return h==v+"";case f:var qe=zt;case E:var $e=Y&i;if(qe||(qe=le),h.size!=v.size&&!$e)return!1;var ct=ae.get(h);if(ct)return ct==v;Y|=a,ae.set(h,v);var wt=Ha(qe(h),qe(v),F,ee,Y,ae);return ae.delete(h),wt;case y:if(Rs)return Rs.call(h)==Rs.call(v)}return!1}function Ga(h,v,M,F,ee,Y){var ae=ee&i,qe=un(h),$e=qe.length,ct=un(v),wt=ct.length;if($e!=wt&&!ae)return!1;for(var bt=$e;bt--;){var mt=qe[bt];if(!(ae?mt in v:J.call(v,mt)))return!1}var kt=Y.get(h);if(kt&&Y.get(v))return kt==v;var Ot=!0;Y.set(h,v),Y.set(v,h);for(var Rr=ae;++bt<$e;){mt=qe[bt];var gr=h[mt],ln=v[mt];if(F)var Bl=ae?F(ln,gr,mt,v,h,Y):F(gr,ln,mt,h,v,Y);if(!(Bl===void 0?gr===ln||M(gr,ln,F,ee,Y):Bl)){Ot=!1;break}Rr||(Rr=mt=="constructor")}if(Ot&&!Rr){var Xa=h.constructor,Ja=v.constructor;Xa!=Ja&&"constructor"in h&&"constructor"in v&&!(typeof Xa=="function"&&Xa instanceof Xa&&typeof Ja=="function"&&Ja instanceof Ja)&&(Ot=!1)}return Y.delete(h),Y.delete(v),Ot}function Fn(h,v){var M=h.__data__;return Ya(v)?M[typeof v=="string"?"string":"hash"]:M.map}function jn(h){for(var v=un(h),M=v.length;M--;){var F=v[M],ee=h[F];v[M]=[F,ee,za(ee)]}return v}function Dr(h,v){var M=Cn(h,v);return Yo(M)?M:void 0}var Et=qo;(Ns&&Et(new Ns(new ArrayBuffer(1)))!=P||tn&&Et(new tn)!=f||rn&&Et(rn.resolve())!=S||ur&&Et(new ur)!=E||nn&&Et(new nn)!=T)&&(Et=function(h){var v=Ve.call(h),M=v==b?h.constructor:void 0,F=M?k(M):void 0;if(F)switch(F){case Ds:return P;case sn:return f;case _o:return S;case xo:return E;case To:return T}return v});function ec(h,v,M){v=on(v,h)?[v]:qa(v);for(var F,ee=-1,ae=v.length;++ee<ae;){var Y=p(v[ee]);if(!(F=h!=null&&M(h,Y)))break;h=h[Y]}if(F)return F;var ae=h?h.length:0;return!!ae&&Xe(ae)&&js(Y,ae)&&(Ae(h)||se(h))}function js(h,v){return v=v??o,!!v&&(typeof h=="number"||_t.test(h))&&h>-1&&h%1==0&&h<v}function on(h,v){if(Ae(h))return!1;var M=typeof h;return M=="number"||M=="symbol"||M=="boolean"||h==null||ot(h)?!0:Q.test(h)||!Z.test(h)||v!=null&&h in Object(v)}function Ya(h){var v=typeof h;return v=="string"||v=="number"||v=="symbol"||v=="boolean"?h!=="__proto__":h===null}function cn(h){return!!at&&at in h}function Za(h){var v=h&&h.constructor,M=typeof v=="function"&&v.prototype||pe;return h===M}function za(h){return h===h&&!it(h)}function Ka(h,v){return function(M){return M==null?!1:M[h]===v&&(v!==void 0||h in Object(M))}}var tc=B(function(h){h=Qt(h);var v=[];return ye.test(h)&&v.push(""),h.replace(Oe,function(M,F,ee,Y){v.push(ee?Y.replace(ze,"$1"):F||M)}),v});function p(h){if(typeof h=="string"||ot(h))return h;var v=h+"";return v=="0"&&1/h==-1/0?"-0":v}function k(h){if(h!=null){try{return me.call(h)}catch{}try{return h+""}catch{}}return""}var D=Xo(function(h,v,M){h[M?0:1].push(v)},function(){return[[],[]]});function B(h,v){if(typeof h!="function"||v&&typeof v!="function")throw new TypeError(n);var M=function(){var F=arguments,ee=v?v.apply(this,F):F[0],Y=M.cache;if(Y.has(ee))return Y.get(ee);var ae=h.apply(this,F);return M.cache=Y.set(ee,ae),ae};return M.cache=new(B.Cache||Ut),M}B.Cache=Ut;function Se(h,v){return h===v||h!==h&&v!==v}function se(h){return Be(h)&&J.call(h,"callee")&&(!vo.call(h,"callee")||Ve.call(h)==u)}var Ae=Array.isArray;function Le(h){return h!=null&&Xe(h.length)&&!ke(h)}function Be(h){return Fe(h)&&Le(h)}function ke(h){var v=it(h)?Ve.call(h):"";return v==w||v==A}function Xe(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=o}function it(h){var v=typeof h;return!!h&&(v=="object"||v=="function")}function Fe(h){return!!h&&typeof h=="object"}function ot(h){return typeof h=="symbol"||Fe(h)&&Ve.call(h)==y}var yt=Pn?Mn(Pn):Zo;function Qt(h){return h==null?"":Jt(h)}function Wt(h,v,M){var F=h==null?void 0:$s(h,v);return F===void 0?M:F}function mr(h,v){return h!=null&&ec(h,v,Ho)}function un(h){return Le(h)?Wo(h):$n(h)}function Un(h){return h}function Vn(h){return on(h)?Mr(p(h)):Ko(h)}t.exports=D}(Ca,Ca.exports);var gb=Ca.exports;const dl=Fr(gb),Ia=(t,[e,r])=>t.filter(n=>n.startTime>=e&&n.startTime<r).length,hl=(t,e)=>t.reduce((r,n)=>r+lm(e,[n.startTime,n.endTime]),0);function pb(t,e){return oo({seriesList:fl(t),bucketDuration:e.bucketDuration??he.Hour,getLabel:io(e,gn()),getYValue:hl,isToday:e.isToday,resetTime:e.resetTime})}function yb(t,e){return co({seriesList:ml(t),bucketDuration:he.Day,domain:ao(e),getLabel:r=>hi(r,!1),getYValue:hl,resetTime:e.resetTime})}function wb(t,e){return oo({seriesList:fl(t),bucketDuration:e.bucketDuration??he.Hour,getLabel:io(e,gn()),getYValue:Ia,isToday:e.isToday,resetTime:e.resetTime})}function bb(t,e){return co({seriesList:ml(t),bucketDuration:he.Day,domain:ao(e),getLabel:r=>hi(r,!1),getYValue:Ia,resetTime:e.resetTime})}function Ab(t,e){return oo({seriesList:_b(t),bucketDuration:e.bucketDuration??he.Hour,getLabel:io(e,gn()),getYValue:Ia,isToday:e.isToday,resetTime:e.resetTime})}function vb(t,e){return co({seriesList:xb(t),bucketDuration:he.Day,domain:ao(e),getLabel:r=>hi(r,!1),getYValue:Ia,resetTime:e.resetTime})}function fl(t){const e=Date.now();return t.map(r=>({name:r.name,platform:r.platform,values:r.values.reduce((n,s)=>{const a=Js(s.startedAt),i=s.startedAt-a,o=(s.endedAt??e)-a;if(o<=he.Day)n.push({session:s,startTime:i,endTime:o});else{n.push({session:s,startTime:i,endTime:he.Day});const u=o%he.Day;n.push({session:s,startTime:new Bt(0*he.Hour).ms,endTime:u})}return n},[])}))}function ml(t){const e=Date.now();return t.map(r=>({name:r.name,platform:r.platform,values:r.values.reduce((n,s)=>{const a=s.startedAt,i=s.endedAt??e;return n.push({session:s,startTime:a,endTime:i}),n},[])}))}function _b(t){return t.map(e=>({name:e.name,platform:e.platform,values:e.values.map(r=>{const n=Js(r.timestamp),s=r.timestamp-n;return{ad:r,startTime:s,endTime:s}})}))}function xb(t){return t.map(e=>({name:e.name,platform:e.platform,values:e.values.map(r=>({ad:r,startTime:r.timestamp,endTime:r.timestamp}))}))}function Tb(t,e,r){let n,s;const a=t.flatMap(i=>i.values);if(a.length===0)n=8*he.Hour+e,s=20*he.Hour+he.Second-e;else{const[i,o]=dl(a,d=>d.startTime<r),[u,l]=dl(a,d=>d.endTime<=r),c=o.length>0?Wc(o.map(d=>d.startTime)):Wc(i.map(d=>d.startTime))+he.Day,m=u.length>0?Bc(u.map(d=>d.endTime))+he.Day:Bc(l.map(d=>d.endTime));n=Math.floor(c/e)*e,s=m}return{startTime:n,endTime:s}}function ao(t){return{startTime:t.startDate,endTime:t.endDate}}function io({is24HourFormat:t},e){return r=>fm(r,{is24HourFormat:t,baseTime:e})}function oo({seriesList:t,bucketDuration:e,getLabel:r,getYValue:n,isToday:s,resetTime:a}){const i={labels:[],series:t.map(m=>({name:m.name,values:[],additionalData:m.platform}))},o=Tb(t,e,a),u=Math.max(o.startTime-e,a),l=Math.min(o.endTime,he.Day+a);let c=u;for(const m of fi(u,l,e)){const d=m%he.Day,w=d,A=Math.min(d+e,he.Day);i.labels.push(r(d)),t.forEach((f,g)=>{t[g].values.length>0&&i.series[g].values.push(n(f.values,[w,A]))}),c=m+e}return c<he.Day+a&&(i.labels.push(r(c)),t.forEach((m,d)=>{!s&&m.values.length>0&&i.series[d].values.push(0)})),i}function co({seriesList:t,bucketDuration:e,domain:r,getLabel:n,getYValue:s,resetTime:a}){const i={labels:[],series:t.map(l=>({name:l.name,additionalData:l.platform,values:[]}))},[o,u]=Hc(r.startTime,r.endTime,a);for(const l of fi(o,u,e)){const c=l,m=l+e;i.labels.push(n(c)),t.forEach((d,w)=>{t[w].values.length>0&&i.series[w].values.push(s(d.values,[c,m]))})}return i}async function Ss(){const t=await sr.getValue();let e=[],r=[],n=!1;for(const s in t)t[s].type==qt.BlockAll&&(n=!0),e=e.concat(t[s].blocklist??[]),r=r.concat(t[s].brandIds??[]);return{isBlockAll:n,blocklist:e,brands:r}}const Sb="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let gl=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Sb[r[t]&63];return e};/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */var pl;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(pl||(pl={}));var uo=(t=>(t[t.Duration=0]="Duration",t[t.Ads=1]="Ads",t[t.Sessions=2]="Sessions",t))(uo||{}),lo=(t=>(t[t.All=0]="All",t[t.Blocked=1]="Blocked",t[t.Allowed=2]="Allowed",t))(lo||{}),ho=(t=>(t.AppType="app-type",t.Device="device",t))(ho||{});function Eb(t,e,r){var s;const n=kb(((s=t==null?void 0:t.find(a=>a.install_id===e.createdBy))==null?void 0:s.name)??"web");return(n==="android"||n==="ios")&&r==="web"?"mobile-web":r}function kb(t){const e=t.toLowerCase();return e.includes("android")||e.includes("wear")||e.includes("google sdk")?"android":e.includes("ios")?"ios":e.includes("windows")?"windows":e.includes("mac")?"mac":e.includes("linux")?"linux":(e.includes("web")||e.includes("chrome")||e.includes("firefox")||e.includes("safari"),"web")}class fo{static register(e){this.caches.add(e)}static clearAll(){this.caches.forEach(e=>e.clear())}static cleanupAll(){this.caches.forEach(e=>e.cleanupExpired())}}ce(fo,"caches",new Set);const Ob=he.Minute*5;class Pb{constructor(e=Ob){ce(this,"cache",new Map);this.cacheTime=e,fo.register(this)}get(e){const r=this.cache.get(e);return r?Date.now()-r.timestamp<this.cacheTime?r.data:(this.cache.delete(e),null):null}set(e,r){this.cache.set(e,{data:r,timestamp:Date.now()})}clear(){this.cache.clear()}cleanupExpired(){const e=Date.now();for(const[r,{timestamp:n}]of this.cache.entries())e-n>=this.cacheTime&&this.cache.delete(r)}}const yl={emit(t,...e){for(let r=this.events[t]||[],n=0,s=r.length;n<s;n++)r[n](...e)},events:{},on(t,e){var r;return((r=this.events)[t]||(r[t]=[])).push(e),()=>{var n;this.events[t]=(n=this.events[t])==null?void 0:n.filter(s=>e!==s)}}};function Mb(t){const e=ab();async function r(l,c){return(await t.sessionsRepo.findSessions(l,c)??[]).map(w=>{const A=Gc(w.startedAt)*he.Second,f=w.endedAt!=null?A+Gc(w.endedAt-w.startedAt)*he.Second:null;return{...w,startedAt:A,endedAt:f}}).map(w=>u(w))}const n=new Pb;yl.on("cleanCache",()=>{fo.clearAll()});async function s(l,c,m){if(!m)return[];const d=`${m}_${l}_${c}`,w=n.get(d);if(w)return w;const A=await Yn(),f=hm(l,c,90),b=(await Promise.all(f.map(S=>e.listDeviceGroupSessions({deviceGroupKey:m,startTime:S.startDate,endTime:S.endDate,installId:A})))).flat().filter(S=>!!S).map(S=>({id:S.appId+S.startedAt,appId:S.appId,createdBy:S.installId,startedAt:S.startedAt,endedAt:S.endedAt,imported:!0,platform:S.platform}));return n.set(d,b),b}async function a(l,c,m){const d=await r(l,c),w=await s(l,c,m);return[...d,...w]}async function i(l,c,m){return await s(l,c,m)}async function o(l){if(l.length==0)return{};const c=e.getAndroidAppInfo({appIds:[...l]}),m={};for(const d of await c)m[d.app_id]={displayName:d.display_name,iconUrl:d.icon_url};return m}function u(l){return{...l,platform:"web"}}return{filterSessions:a,filterRemoteSessions:i,findAppMetadata:o}}function Cb(t,e){const r=n=>n[e];return t.reduce((n,s)=>{var i;const a=r(s);return n[a]=((i=n[a])==null?void 0:i.concat(s))??[s],n},{})}const[wv,Ib]=Wn("usage-service",Nb,{logger:Xl});function Nb(t){const e=rw(),r=Mb(e),n=e.adsRepo,s=e.pageViewsRepo;yl.on("dailyReset",async()=>{const g=await s.getActivePageViews();if(g.length==1){const b=g[0];await s.endPageView(g[0],Date.now()),b.startedAt=Date.now(),await s.startPageView(b)}});const a=async()=>qb.getValue(),i=async()=>{const g=await bl.getValue();return new Bt(g.hours,he.Hour).plus(new Bt(g.minutes,he.Minute))},o=async(g,b)=>{const S=await i(),[x,E]=Hc(g,b,S.ms);return{start:x,end:E}},u=g=>Math.round(g/he.Second)*he.Second,l=async(g,b)=>{const{blocklist:S,brands:x}=await Ss(),E=await kn(),C=await Na.getValue();let y;return g==lo.Blocked&&(y="blocked"),g==lo.Allowed&&(y="allowed"),y&&(b=b.filter(T=>no(T.appId,{type:qt.Group,blocklist:S,brandIds:x},C,S,E)==y)),b},c=(g,b)=>g?b.filter(S=>S.appId.includes(g)):b,m=async g=>{const b=new so(await Yb.getValue()),S=new so(await Gb.getValue()),x=new so(await Hb.getValue());return g.filter(({appId:E})=>!(b.has(E)||S.has(E)||x.has(E)))},d=async(g,b,S,x)=>{const E=await bl.getValue(),C=E.hours*he.Hour+E.minutes*he.Minute,y={...g,resetTime:C};let T=await r.filterSessions(g.startDate,g.endDate,g.deviceGroupKey);g.deviceInstallId&&(T=T.filter(P=>P.createdBy==g.deviceInstallId)),T=await l(g.websiteType,T),T=c(g.searchText,T),T=await m(T);const _=await w(T,g);if(g.primaryMetric===uo.Ads){const P=await n.findAds(g.startDate,g.endDate),N=A(_,P);return b(N,y)}return g.primaryMetric===uo.Sessions?S(_,y):x(_,y)},w=async(g,b)=>{switch(b.groupBy){case ho.AppType:{const S={desktop:[],web:[],android:[],"mobile-web":[]};return g.forEach(x=>{var y;const E=Ma(x.platform),C=Eb(b.devices??[],x,E);(y=S[C])==null||y.push(x)}),Object.entries(S).map(([x,E])=>({name:mb(x),platform:x,values:E}))}case ho.Device:{const S=await Yn();return Object.entries(Cb(g,"createdBy")).map(([x,E])=>{var C,y;return{name:S==x?Ur("thisDevice"):((y=(C=b.devices)==null?void 0:C.find(T=>T.install_id===x))==null?void 0:y.name)??x,values:E}})}}return[{values:g}]},A=(g,b)=>g.map(S=>{const x=S.values.map(E=>E.id);return{name:S.name,platform:S.platform,values:b.filter(E=>x.includes(E.sessionId))}}),f=async g=>{const b=await kn();return await Array.from(new Set(g.map(E=>({appId:E.appId,platform:E.platform})))).reduce(async(E,C)=>{var _;const y=await E,T=(_=ib(b,C.appId,Ma(C.platform)))==null?void 0:_.name;return y[C.appId]=T??C.appId,y},Promise.resolve({}))};return{getTodaysUsage:async()=>{const g=await i(),b=new Ct().startOfDay.plus(g),S=b.ms>Date.now()?new Ct(im()).plus(g):b,x=S.add(Bt.DAY),E=await s.findPageViewsByStartedAt(S.ms,x.ms),C=await a();if(C){const T=(await r.filterRemoteSessions(S.ms,x.ms,C==null?void 0:C.key)).map(_=>({id:_.id,path:"",startedAt:_.startedAt,endedAt:_.endedAt,appId:_.appId,createdBy:_.createdBy}));return{local:E,remote:T}}return{local:E,remote:[]}},getUsageHighlights:async(g,b)=>{const{start:S,end:x}=await o(g,b),E=await r.filterSessions(S,x)??[],C=await n.findAds(S,x),{blocklist:y,brands:T}=await Ss(),_=await kn(),P=E.reduce((H,W)=>{const O=new Date(W.startedAt).getHours();return O in H||(H[O]=0),H[O]+=W.endedAt?W.endedAt-W.startedAt:0,H},{}),N=Object.keys(P).reduce((H,W)=>P[H]>P[W]?H:Number(W),0),U=E.reduce((H,W)=>{const O=W.appId;return O in H||(H[O]={count:0,totalDuration:0,blocked:Pa(O,y,T,_)=="blocked"}),H[O].count+=1,H[O].totalDuration+=W.endedAt?W.endedAt-W.startedAt:0,H},{}),G=E.reduce((H,W)=>H+(W.endedAt?u(W.endedAt-W.startedAt):0),0),I=Object.values(U).filter(H=>H.blocked),K=I.length,L=I.reduce((H,W)=>H+W.count,0);return{sessionCount:E.length,totalDuration:G,blockedAppCount:K,blockedSessionCount:L,appCount:Object.keys(U).length,favoriteHour:N,adCount:C.length}},getUsageSummary:async(g,b,S,x)=>{const{start:E,end:C}=await o(g,b);let y=await r.filterSessions(E,C,S);y=await m(y);const T=await n.findAds(E,C);x&&x!="all"&&(y=y.filter(K=>K.createdBy==x));const{blocklist:_,brands:P}=await Ss(),N=await kn(),U=await Na.getValue(),G=await f(y),I=y.reduce((K,L)=>{const H=Oe=>Oe.endedAt?u(Oe.endedAt-Oe.startedAt):0,W=Oe=>T.filter(Ze=>Ze.sessionId==Oe.id).length,O=Ma(L.platform),Z=L.appId,Q=G[Z];K[Q]||(K[Q]={appId:Z,brandName:G[Z],sessionCount:0,totalDuration:0,blocked:Pa(Z,_,P,N)=="blocked",allowed:U.some(Oe=>On(Z,Oe)),adCount:0,valuePerPlatforms:[],platform:Ma(L.platform)});const ye=K[Q].valuePerPlatforms.find(Oe=>Oe.platform==O);return ye?(ye.duration+=H(L),ye.sessionsCount+=1,ye.adsCount+=W(L)):K[Q].valuePerPlatforms.push({platform:O,duration:H(L),sessionsCount:1,adsCount:W(L)}),K[Q].sessionCount+=1,K[Q].adCount+=W(L),K[Q].totalDuration+=H(L),K},{});return Object.values(I)},getMetaDataForApps:async g=>{const b=g.reduce((x,E)=>(E.platform==ka.Android&&x.add(E.appId),x),new Set),S=await r.findAppMetadata(Array.from(b));return g.map(x=>({...x,...S[x.appId]}))},getChartData:async g=>{const{start:b,end:S}=await o(g.startDate,g.endDate);return g.startDate=b,g.endDate=S,g.isDailyChart?d(g,vb,bb,yb):d(g,Ab,wb,pb)},uploadAll:async()=>{await t.uploadAll()}}}function Db(){async function t(){return Fb.getValue()}async function e(){const s=await $b.getValue();return s==null?void 0:s.some(a=>new Date().getDay()==a)}async function r(){const s=new Date,a=await vl.getValue();if(a&&s.getTime()>a.timestamp)return await vl.setValue(null),await Al.setValue(a.time),qc(s,a.time);const i=await Al.getValue();return qc(s,i)}async function n(){return await r()&&await e()&&await t()}return{isEnabled:t,isActiveDay:e,isActiveHours:r,isActive:n}}Wn("timer-service",Lb);const Rb="default",Es=Ur("default");function Lb(){const t=Ib(),e=Db(),r=async()=>{const c=await sr.getValue();if(!Object.values(c).find(d=>d.name==Es)){const d=[],w={id:gl(),name:Es,allowedTimeMs:Bt.HOUR.ms,blocklist:[],brandIds:d,type:qt.Group,isEnabled:!0,isSynced:!1};c[w.id]=w,await sr.setValue(c)}return Object.values(c)};async function n(){await sr.migrate(),s=await r(),a=await Na.getValue(),i=(await Ss()).blocklist,o=await kn()}n();let s=[],a=[],i=[],o=[];Ol.watch(async()=>{o=await kn()}),sr.watch(async()=>{s=await r(),i=(await Ss()).blocklist}),Na.watch(c=>{a=c});const u=(c,m,d)=>`https://${c}${m}${d?`?${d}`:""}`,l=async(c,m)=>{const d=s.map(b=>{let S=c?no(c,b,a,i,o):void 0;return b.type==qt.Nuclear&&(S="blocked-nuclear"),{timer:b,relation:S}}).filter(m);if(d.length==0)return[];const w=await t.getTodaysUsage(),A=[...w.local,...w.remote],f=Date.now(),g=await e.isActive();return d.map(({timer:b,relation:S})=>{let x=!1,E=0;return b.type==qt.Nuclear?E=f-(b.startTime??f):g?E=(b.isSynced?A:w.local).filter(y=>{const T=no(u(y.appId,y.path,y.query),b,a,i,o);return T==="blocked"||T==="blocked-nuclear"}).reduce((y,T)=>(T.endedAt==null&&(x=!0),y+(T.endedAt??f)-T.startedAt),0):E=0,{timer:b,relation:S,timeLeftMs:b.allowedTimeMs-E,active:x}})};return{getPopupTimer:async c=>{const m=await l(c,({timer:d,relation:w})=>w!=null||d.name===Es);if(m.length===0)throw Error("No timers found");return m.toSorted((d,w)=>{const A=wl[d.relation??"undefined"],f=wl[w.relation??"undefined"];return A!==f?A-f:d.timer.type==w.timer.type&&d.timer.name==Es?-1:f})[0]},getAllTimers:c=>l(c,()=>!0),getAllTimersByType:c=>l(void 0,m=>m.timer.type==c),getTimerById:async c=>{const m=await l(void 0,d=>d.timer.id==c);return m.length==1?m[0]:null},upsertTimer:async c=>{const m=await sr.getValue();m[c.id]=c,await sr.setValue(m)},deleteTimer:async c=>{const m=await sr.getValue();if(m[c].name==Es)throw Error("Cannot delete the default timer");delete m[c],await sr.setValue(m)}}}const wl={"blocked-nuclear":1,blocked:2,allowed:3,undefined:4};Ne(R.FirstSensorTowerInstallDate);const bl=ie(R.ResetTime,{fallback:xm,version:2,migrations:{2:t=>yi(t,()=>gi(t))}});Ne(R.ResetTimeQueue);const Al=ie(R.ActiveHours,{fallback:Tm,version:2,migrations:{2:t=>yi(t,()=>{const e=t.split("|");return{start:gi(e[0]),end:gi(e[1])}})}}),vl=Ne(R.ActiveHoursQueue),$b=ie(R.ActiveDays,{fallback:_m,version:2,migrations:{2:t=>yi(t,()=>t.split("|").map(r=>Number(r)))}});Ne(R.CurrentUrl),Ne(R.CurrentTabId),Zc(pi(R.UrlsBeforeBlockedStorage),{serializer:"map",fallback:new Map}),Zc(pi(R.LastResetTime),{serializer:"time",fallback:new Ct(0)}),ie(R.Theme,{fallback:"light"});const _l=ie(R.DisableSync,{fallback:Sm});ie(R.BlockAllWebsitesAllowedTime,{fallback:vm}),ie(R.DisableUpdatePopup,{fallback:Em});const Fb=ie(R.Activated,{fallback:km}),xl=Ne(R.HasAcceptedToS),Tl=Ne(R.HasAcceptedPrivacyPolicy),jb=Ne(R.Is18OrOlder),Ub=Ne(R.Age);Ne(R.PromptBirthYearAt),Ne(R.PromptBirthYearInterval),ie(R.PromptReview,{fallback:Om}),Ne(R.PromptReviewAt),Ne(R.PromptReviewInterval);const Vb=Ne(R.ExplicitlyDeclinedPrivacyPolicy),Wb=Ne(R.ShowOnboardingAgainAt),Bb=Ne(R.ShowOnboardingAgainCount);ie(R.ChallengeRequired,{fallback:Pm}),ie(R.HideAllowSiteLink,{fallback:Mm}),Ne(R.ChallengeText);const Na=Qs(ie(R.Whitelist,{fallback:[]}),ie(R.Whitelist,{fallback:[]},!0),[]),Sl=Ne(R.RemoteConfig),El=Ne(R.RemoteConfigLastFetchedAt);Ne(R.CustomStayFocusdMsg),ie(R.IsActivateSwitchShown,{fallback:Cm}),Ne(R.ShowedInitialTutorial),Ne(R.StayFreePairingPromoDismissedStorage),ie(R.NotificationSettings,{fallback:Nm}),ie(R.TrackTabsPlayingAudio,{fallback:Im}),Ne(R.NuclearQueue),ie(R.YoutubeHomePageHidden,{fallback:It}),ie(R.YoutubeShortsHidden,{fallback:It}),ie(R.YoutubeCommentsHidden,{fallback:It}),ie(R.YoutubeRecommendedHidden,{fallback:It}),ie(R.YoutubeSubscriptionsHidden,{fallback:It}),ie(R.YoutubeExploreHidden,{fallback:It}),ie(R.YoutubeTrendsHidden,{fallback:It}),ie(R.YoutubeTopBarHidden,{fallback:It}),ie(R.YoutubeEndCardsDisabled,{fallback:It}),ie(R.YoutubeBlackWhiteMode,{fallback:It}),ie(R.YoutubeAutoplayDisabled,{fallback:It}),ie(R.TiktokExploreTabHidden,{fallback:Jn}),ie(R.TiktokLiveTabHidden,{fallback:Jn}),ie(R.TiktokCommentsTabHidden,{fallback:Jn}),ie(R.TiktokSearchTabHidden,{fallback:Jn}),ie(R.TikTokBlackWhiteMode,{fallback:Jn});function kl(){return t=>Object.values(t).reduce((r,n)=>{if(n.type==qt.Group&&!n.hasOwnProperty("isEnabled")&&!n.hasOwnProperty("isSynced")){const s=gl();n.isEnabled=!0,n.isSynced=!1,n.id!=Rb&&(n.name=n.id),n.id=s,r[s]=n}else r[n.id]=n;return r},{})}const sr=Qs(ie(R.Timers,{fallback:{},version:2,migrations:{2:kl()}}),ie(R.Timers,{fallback:{},version:2,migrations:{2:kl()}},!0),{}),Ol=ie(R.AppGroups,{fallback:[]});Qs(ie(R.BlockedGroups,{fallback:[]}),ie(R.BlockedGroups,{fallback:[]},!0),[]),Qs(ie(R.WhitelistNew,{fallback:[]}),ie(R.WhitelistNew,{fallback:[]},!0),[]);const qb=ie(R.DeviceGroup,{defaultValue:null}),Hb=ie(R.IgnoredApps,{defaultValue:[]}),Gb=ie(R.IgnoredDesktopApps,{defaultValue:[]}),Yb=ie(R.IgnoredWebsites,{defaultValue:[]});R.ActiveDays,R.ResetTimeQueue,R.ActiveHoursQueue,R.ActiveHours,R.Activated,R.ChallengeRequired,R.ChallengeText,R.CustomStayFocusdMsg,R.TrackTabsPlayingAudio,R.DisableSync,R.Theme,R.HideAllowSiteLink,R.IsActivateSwitchShown,R.ResetTime,R.NotificationSettings,R.YoutubeAutoplayDisabled,R.YoutubeCommentsHidden,R.YoutubeEndCardsDisabled,R.YoutubeExploreHidden,R.YoutubeHomePageHidden,R.YoutubeRecommendedHidden,R.YoutubeShortsHidden,R.YoutubeSubscriptionsHidden,R.YoutubeTopBarHidden,R.YoutubeTrendsHidden,R.YoutubeBlackWhiteMode,R.TiktokLiveTabHidden,R.TiktokCommentsTabHidden,R.TiktokSearchTabHidden,R.TiktokExploreTabHidden,R.TikTokBlackWhiteMode,R.Timers,R.Whitelist,R.BlockedGroups;function Zb(t){const e=new Set;let r={...t.defaultConfig},n,s;async function a(){try{const l=await Promise.all(t.urls.map(w=>fetch(w))),c=await Promise.all(l.map(w=>w.json())),m={...t.defaultConfig,...Object.assign({},...c)},d=r;return n=Date.now(),r=m,await t.persistConfig(m),await t.persistLastFetchedTime(n),e.forEach(w=>{zu(m,d)||w(m,d)}),m}catch(l){throw new Error(`Failed to fetch remote config: ${String(l)}`)}}function i(l){return e.add(l),()=>{e.delete(l)}}const o=t.restoreConfig(),u=t.restoreLastFetchedTime();return o&&u?s=Promise.all([o,u]).then(([l,c])=>(l&&(r=l,n=c),r)):s=Promise.resolve(r),{fetchLatest:a,addChangeListener:i,get value(){return r},get lastFetchedTime(){return n},get restoredPromise(){return new Promise((l,c)=>{s.then(()=>l(r)).catch(c)})}}}var zb=Object.defineProperty,Kb=(t,e,r)=>e in t?zb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ks=(t,e,r)=>Kb(t,typeof e!="symbol"?e+"":e,r);const Xb=`"use strict";(()=>{var Fe=Object.create;var kt=Object.defineProperty;var Le=Object.getOwnPropertyDescriptor;var He=Object.getOwnPropertyNames;var Be=Object.getPrototypeOf,Ve=Object.prototype.hasOwnProperty;var ke=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var qe=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of He(t))!Ve.call(e,s)&&s!==r&&kt(e,s,{get:()=>t[s],enumerable:!(o=Le(t,s))||o.enumerable});return e};var Ct=(e,t,r)=>(r=e!=null?Fe(Be(e)):{},qe(t||!e||!e.__esModule?kt(r,"default",{value:e,enumerable:!0}):r,e));var ut=ke((qt,Wt)=>{"use strict";(function(e){if(typeof qt=="object")Wt.exports=e();else if(typeof define=="function"&&define.amd)define(e);else{var t;try{t=window}catch{t=self}t.SparkMD5=e()}})(function(e){"use strict";var t=function(f,h){return f+h&4294967295},r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function o(f,h,i,n,u,a){return h=t(t(h,f),t(n,a)),t(h<<u|h>>>32-u,i)}function s(f,h){var i=f[0],n=f[1],u=f[2],a=f[3];i+=(n&u|~n&a)+h[0]-680876936|0,i=(i<<7|i>>>25)+n|0,a+=(i&n|~i&u)+h[1]-389564586|0,a=(a<<12|a>>>20)+i|0,u+=(a&i|~a&n)+h[2]+606105819|0,u=(u<<17|u>>>15)+a|0,n+=(u&a|~u&i)+h[3]-1044525330|0,n=(n<<22|n>>>10)+u|0,i+=(n&u|~n&a)+h[4]-176418897|0,i=(i<<7|i>>>25)+n|0,a+=(i&n|~i&u)+h[5]+1200080426|0,a=(a<<12|a>>>20)+i|0,u+=(a&i|~a&n)+h[6]-1473231341|0,u=(u<<17|u>>>15)+a|0,n+=(u&a|~u&i)+h[7]-45705983|0,n=(n<<22|n>>>10)+u|0,i+=(n&u|~n&a)+h[8]+1770035416|0,i=(i<<7|i>>>25)+n|0,a+=(i&n|~i&u)+h[9]-1958414417|0,a=(a<<12|a>>>20)+i|0,u+=(a&i|~a&n)+h[10]-42063|0,u=(u<<17|u>>>15)+a|0,n+=(u&a|~u&i)+h[11]-1990404162|0,n=(n<<22|n>>>10)+u|0,i+=(n&u|~n&a)+h[12]+1804603682|0,i=(i<<7|i>>>25)+n|0,a+=(i&n|~i&u)+h[13]-40341101|0,a=(a<<12|a>>>20)+i|0,u+=(a&i|~a&n)+h[14]-1502002290|0,u=(u<<17|u>>>15)+a|0,n+=(u&a|~u&i)+h[15]+1236535329|0,n=(n<<22|n>>>10)+u|0,i+=(n&a|u&~a)+h[1]-165796510|0,i=(i<<5|i>>>27)+n|0,a+=(i&u|n&~u)+h[6]-1069501632|0,a=(a<<9|a>>>23)+i|0,u+=(a&n|i&~n)+h[11]+643717713|0,u=(u<<14|u>>>18)+a|0,n+=(u&i|a&~i)+h[0]-373897302|0,n=(n<<20|n>>>12)+u|0,i+=(n&a|u&~a)+h[5]-701558691|0,i=(i<<5|i>>>27)+n|0,a+=(i&u|n&~u)+h[10]+38016083|0,a=(a<<9|a>>>23)+i|0,u+=(a&n|i&~n)+h[15]-660478335|0,u=(u<<14|u>>>18)+a|0,n+=(u&i|a&~i)+h[4]-405537848|0,n=(n<<20|n>>>12)+u|0,i+=(n&a|u&~a)+h[9]+568446438|0,i=(i<<5|i>>>27)+n|0,a+=(i&u|n&~u)+h[14]-1019803690|0,a=(a<<9|a>>>23)+i|0,u+=(a&n|i&~n)+h[3]-187363961|0,u=(u<<14|u>>>18)+a|0,n+=(u&i|a&~i)+h[8]+1163531501|0,n=(n<<20|n>>>12)+u|0,i+=(n&a|u&~a)+h[13]-1444681467|0,i=(i<<5|i>>>27)+n|0,a+=(i&u|n&~u)+h[2]-51403784|0,a=(a<<9|a>>>23)+i|0,u+=(a&n|i&~n)+h[7]+1735328473|0,u=(u<<14|u>>>18)+a|0,n+=(u&i|a&~i)+h[12]-1926607734|0,n=(n<<20|n>>>12)+u|0,i+=(n^u^a)+h[5]-378558|0,i=(i<<4|i>>>28)+n|0,a+=(i^n^u)+h[8]-2022574463|0,a=(a<<11|a>>>21)+i|0,u+=(a^i^n)+h[11]+1839030562|0,u=(u<<16|u>>>16)+a|0,n+=(u^a^i)+h[14]-35309556|0,n=(n<<23|n>>>9)+u|0,i+=(n^u^a)+h[1]-1530992060|0,i=(i<<4|i>>>28)+n|0,a+=(i^n^u)+h[4]+1272893353|0,a=(a<<11|a>>>21)+i|0,u+=(a^i^n)+h[7]-155497632|0,u=(u<<16|u>>>16)+a|0,n+=(u^a^i)+h[10]-1094730640|0,n=(n<<23|n>>>9)+u|0,i+=(n^u^a)+h[13]+681279174|0,i=(i<<4|i>>>28)+n|0,a+=(i^n^u)+h[0]-358537222|0,a=(a<<11|a>>>21)+i|0,u+=(a^i^n)+h[3]-722521979|0,u=(u<<16|u>>>16)+a|0,n+=(u^a^i)+h[6]+76029189|0,n=(n<<23|n>>>9)+u|0,i+=(n^u^a)+h[9]-640364487|0,i=(i<<4|i>>>28)+n|0,a+=(i^n^u)+h[12]-421815835|0,a=(a<<11|a>>>21)+i|0,u+=(a^i^n)+h[15]+530742520|0,u=(u<<16|u>>>16)+a|0,n+=(u^a^i)+h[2]-995338651|0,n=(n<<23|n>>>9)+u|0,i+=(u^(n|~a))+h[0]-198630844|0,i=(i<<6|i>>>26)+n|0,a+=(n^(i|~u))+h[7]+1126891415|0,a=(a<<10|a>>>22)+i|0,u+=(i^(a|~n))+h[14]-1416354905|0,u=(u<<15|u>>>17)+a|0,n+=(a^(u|~i))+h[5]-57434055|0,n=(n<<21|n>>>11)+u|0,i+=(u^(n|~a))+h[12]+1700485571|0,i=(i<<6|i>>>26)+n|0,a+=(n^(i|~u))+h[3]-1894986606|0,a=(a<<10|a>>>22)+i|0,u+=(i^(a|~n))+h[10]-1051523|0,u=(u<<15|u>>>17)+a|0,n+=(a^(u|~i))+h[1]-2054922799|0,n=(n<<21|n>>>11)+u|0,i+=(u^(n|~a))+h[8]+1873313359|0,i=(i<<6|i>>>26)+n|0,a+=(n^(i|~u))+h[15]-30611744|0,a=(a<<10|a>>>22)+i|0,u+=(i^(a|~n))+h[6]-1560198380|0,u=(u<<15|u>>>17)+a|0,n+=(a^(u|~i))+h[13]+1309151649|0,n=(n<<21|n>>>11)+u|0,i+=(u^(n|~a))+h[4]-145523070|0,i=(i<<6|i>>>26)+n|0,a+=(n^(i|~u))+h[11]-1120210379|0,a=(a<<10|a>>>22)+i|0,u+=(i^(a|~n))+h[2]+718787259|0,u=(u<<15|u>>>17)+a|0,n+=(a^(u|~i))+h[9]-343485551|0,n=(n<<21|n>>>11)+u|0,f[0]=i+f[0]|0,f[1]=n+f[1]|0,f[2]=u+f[2]|0,f[3]=a+f[3]|0}function c(f){var h=[],i;for(i=0;i<64;i+=4)h[i>>2]=f.charCodeAt(i)+(f.charCodeAt(i+1)<<8)+(f.charCodeAt(i+2)<<16)+(f.charCodeAt(i+3)<<24);return h}function l(f){var h=[],i;for(i=0;i<64;i+=4)h[i>>2]=f[i]+(f[i+1]<<8)+(f[i+2]<<16)+(f[i+3]<<24);return h}function d(f){var h=f.length,i=[1732584193,-271733879,-1732584194,271733878],n,u,a,S,M,D;for(n=64;n<=h;n+=64)s(i,c(f.substring(n-64,n)));for(f=f.substring(n-64),u=f.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<u;n+=1)a[n>>2]|=f.charCodeAt(n)<<(n%4<<3);if(a[n>>2]|=128<<(n%4<<3),n>55)for(s(i,a),n=0;n<16;n+=1)a[n]=0;return S=h*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),M=parseInt(S[2],16),D=parseInt(S[1],16)||0,a[14]=M,a[15]=D,s(i,a),i}function p(f){var h=f.length,i=[1732584193,-271733879,-1732584194,271733878],n,u,a,S,M,D;for(n=64;n<=h;n+=64)s(i,l(f.subarray(n-64,n)));for(f=n-64<h?f.subarray(n-64):new Uint8Array(0),u=f.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<u;n+=1)a[n>>2]|=f[n]<<(n%4<<3);if(a[n>>2]|=128<<(n%4<<3),n>55)for(s(i,a),n=0;n<16;n+=1)a[n]=0;return S=h*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),M=parseInt(S[2],16),D=parseInt(S[1],16)||0,a[14]=M,a[15]=D,s(i,a),i}function m(f){var h="",i;for(i=0;i<4;i+=1)h+=r[f>>i*8+4&15]+r[f>>i*8&15];return h}function g(f){var h;for(h=0;h<f.length;h+=1)f[h]=m(f[h]);return f.join("")}g(d("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(t=function(f,h){var i=(f&65535)+(h&65535),n=(f>>16)+(h>>16)+(i>>16);return n<<16|i&65535}),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function f(h,i){return h=h|0||0,h<0?Math.max(h+i,0):Math.min(h,i)}ArrayBuffer.prototype.slice=function(h,i){var n=this.byteLength,u=f(h,n),a=n,S,M,D,Vt;return i!==e&&(a=f(i,n)),u>a?new ArrayBuffer(0):(S=a-u,M=new ArrayBuffer(S),D=new Uint8Array(M),Vt=new Uint8Array(this,u,S),D.set(Vt),M)}}();function y(f){return/[\\u0080-\\uFFFF]/.test(f)&&(f=unescape(encodeURIComponent(f))),f}function x(f,h){var i=f.length,n=new ArrayBuffer(i),u=new Uint8Array(n),a;for(a=0;a<i;a+=1)u[a]=f.charCodeAt(a);return h?u:n}function R(f){return String.fromCharCode.apply(null,new Uint8Array(f))}function v(f,h,i){var n=new Uint8Array(f.byteLength+h.byteLength);return n.set(new Uint8Array(f)),n.set(new Uint8Array(h),f.byteLength),i?n:n.buffer}function W(f){var h=[],i=f.length,n;for(n=0;n<i-1;n+=2)h.push(parseInt(f.substr(n,2),16));return String.fromCharCode.apply(String,h)}function A(){this.reset()}return A.prototype.append=function(f){return this.appendBinary(y(f)),this},A.prototype.appendBinary=function(f){this._buff+=f,this._length+=f.length;var h=this._buff.length,i;for(i=64;i<=h;i+=64)s(this._hash,c(this._buff.substring(i-64,i)));return this._buff=this._buff.substring(i-64),this},A.prototype.end=function(f){var h=this._buff,i=h.length,n,u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a;for(n=0;n<i;n+=1)u[n>>2]|=h.charCodeAt(n)<<(n%4<<3);return this._finish(u,i),a=g(this._hash),f&&(a=W(a)),this.reset(),a},A.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},A.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},A.prototype.setState=function(f){return this._buff=f.buff,this._length=f.length,this._hash=f.hash,this},A.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},A.prototype._finish=function(f,h){var i=h,n,u,a;if(f[i>>2]|=128<<(i%4<<3),i>55)for(s(this._hash,f),i=0;i<16;i+=1)f[i]=0;n=this._length*8,n=n.toString(16).match(/(.*?)(.{0,8})$/),u=parseInt(n[2],16),a=parseInt(n[1],16)||0,f[14]=u,f[15]=a,s(this._hash,f)},A.hash=function(f,h){return A.hashBinary(y(f),h)},A.hashBinary=function(f,h){var i=d(f),n=g(i);return h?W(n):n},A.ArrayBuffer=function(){this.reset()},A.ArrayBuffer.prototype.append=function(f){var h=v(this._buff.buffer,f,!0),i=h.length,n;for(this._length+=f.byteLength,n=64;n<=i;n+=64)s(this._hash,l(h.subarray(n-64,n)));return this._buff=n-64<i?new Uint8Array(h.buffer.slice(n-64)):new Uint8Array(0),this},A.ArrayBuffer.prototype.end=function(f){var h=this._buff,i=h.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u,a;for(u=0;u<i;u+=1)n[u>>2]|=h[u]<<(u%4<<3);return this._finish(n,i),a=g(this._hash),f&&(a=W(a)),this.reset(),a},A.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},A.ArrayBuffer.prototype.getState=function(){var f=A.prototype.getState.call(this);return f.buff=R(f.buff),f},A.ArrayBuffer.prototype.setState=function(f){return f.buff=x(f.buff,!0),A.prototype.setState.call(this,f)},A.ArrayBuffer.prototype.destroy=A.prototype.destroy,A.ArrayBuffer.prototype._finish=A.prototype._finish,A.ArrayBuffer.hash=function(f,h){var i=p(new Uint8Array(f)),n=g(i);return h?W(n):n},A})});var N=class e{constructor(t,r){this.operation=t;this.data=r}static NONCE="z3ZCw_12v";nonce=e.NONCE;static fromObject(t){return!t||t.nonce!==e.NONCE?null:new e(t.operation,t.data)}validate(){return this.nonce===e.NONCE}};var z=class{crawlId;installId;zys;dateCrawlStarted;dateCrawled;crawlUrl;fragmentIndex;youTubeChannelId;youTubeChannelName;youTubeVideoId;constructor(t,r,o,s,c,l,d,p){this.crawlId=t,this.installId=r,this.zys=o,this.dateCrawlStarted=s,this.dateCrawled=c,this.crawlUrl=l,this.fragmentIndex=d,Object.assign(this,p)}get ads(){return this.zys}set ads(t){this.zys=t}};var lt=Ct(ut(),1);var _=class{x;y;width;height;text;sourceUrls;hash;hashOverride;type;typeOverride;canvases;svgs;depth;adRuleId;dedupeKey;duration;language;youTubeId;netflixData;tikTokData;twitterData;vastData;outerHtml;static minWidth=120;static minHeight=28;static minimumVideoToAdAreaRatio=.5;static minimumImageToAdAreaRatio=.05;constructor(t){this.x=t.x??0,this.y=t.y??0,this.width=t.width,this.height=t.height,this.text=t.text??"",this.sourceUrls=t.sourceUrls??[],this.hash=t.hash??"",this.type=t.type,this.canvases=[],this.svgs=[],this.depth=0,this.adRuleId=t.adRuleId,this.duration=t.duration,this.language=t.language,this.youTubeId=t.youTubeId,this.netflixData=t.netflixData,this.tikTokData=t.tikTokData,this.twitterData=t.twitterData,this.vastData=t.vastData}};var w=class e{u;t;h;d;width;height;constructor(t){this.u=e.qualifyURL(t.url,t.doc),this.t=t.urlType,this.d=t.depth,this.width=t.width,this.height=t.height}get url(){return this.u}set url(t){this.u=t}get urlType(){return this.t}set urlType(t){this.t=t}get depth(){return this.d}set depth(t){this.d=t}get hash(){return this.h}set hash(t){this.h=t}static SourceUrlTags=new Set(["A","DIV","IFRAME","IMG","LINK","SCRIPT","SPAN","VIDEO"]);static qualifyURL(t,r){if(!t||new RegExp("^(?:\\\\w+-extension)|(?:about)|(?:blob)|(?:javascript):").test(t))return"";r=r||document;let o=r.createElement("a");return o.href=t,o.href}};async function Y(e,t){if(!e)return[];let r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,c=>w.SourceUrlTags.has(c.nodeName)||c?.shadowRoot?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),o=[],s=r.currentNode;for(;s;){o.push(...await We(s,t));let c=s?.shadowRoot;c&&o.push(...await Y(c?.firstElementChild,t)),s=r.nextNode()}return o.filter(c=>c.url)}async function We(e,t){if(!e||!w.SourceUrlTags.has(e.nodeName))return[];if(e.nodeName=="IMG")return[await jt(e,t)];if(e.nodeName=="DIV"||e.nodeName=="SPAN"){let s=/url\\(['"]?([^'"]+)['"]?\\)/gi,c=getComputedStyle(e).getPropertyValue("background-image");return Promise.all(Array.from(c.matchAll(s)).filter(l=>l).map(l=>l[1]).map(async l=>{try{let d=new Image;return d.src=l,await d.decode(),jt(d,t)}catch{return new w({url:l,urlType:7,depth:t,doc:e?.ownerDocument})}}))}if(e.nodeName==="VIDEO"){if(e=e.hasAttribute("src")?e:e.querySelector("source"),!e)return[];let s=e.getBoundingClientRect(),c=Math.round(s.width),l=Math.round(s.height);return[new w({url:e.getAttribute("src"),urlType:4,depth:t,width:c,height:l,doc:e.ownerDocument})]}if(e.nodeName==="IFRAME")return[new w({url:e.getAttribute("src"),urlType:1,depth:t,width:e.offsetWidth,height:e.offsetHeight,doc:e.ownerDocument})];let r=null,o=0;switch(e.nodeName){case"SCRIPT":r=e.getAttribute("src"),o=6;break;case"LINK":r=e.getAttribute("href"),o=6;break;case"A":r=e.getAttribute("href"),o=8;break}return[new w({url:r,urlType:o,depth:t,doc:e.ownerDocument})]}async function jt(e,t){let r=e.getAttribute("src"),o=e.getBoundingClientRect(),s=Math.round(e.naturalWidth||o.width),c=Math.round(e.naturalHeight||o.height);if(!(s||c)&&r)try{let d=new Image;d.src=r,await d.decode(),s=d.naturalWidth,c=d.naturalHeight}catch{}let l=0;return(o.width||s)<2&&(o.height||c)<2||s===43&&c===22||o.y+window.scrollY<5&&(o.width||s)<85&&(o.height||c)<=20?l=7:l=3,new w({url:r,urlType:l,depth:t,width:o.width||s,height:o.height||c,doc:e.ownerDocument})}async function ht(e,t){e.sourceUrls=ft(e.sourceUrls,l=>l.u);let r=e.sourceUrls.filter(l=>l.t===3||l.t===4),s=r.filter(l=>l.t===3).sort((l,d)=>(l.width||0)*(l.height||0)-(d.width||0)*(d.height||0)).pop(),c=r.filter(l=>l.t===4);if(e.type=e.typeOverride??(r.length===1&&(r[0].width||0)>=e.width-2&&(r[0].height||0)>=e.height-2?r[0].t===3?1:3:c.length===1&&(c[0].width||0)*(c[0].height||0)>=e.width*e.height*_.minimumVideoToAdAreaRatio?3:7),e.hashOverride)return e.hash=e.hashOverride;if(e.type===7&&!c.length&&(s?.width||0)*(s?.height||0)<e.width*e.height*_.minimumImageToAdAreaRatio)return e.hash="";for(let l of r)l.h=await dt(l.u||"",t);if(e.hash=r.filter(l=>l.h).reduce((l,d)=>X(l,d.h),"")||"",e.type===3&&!e.hash&&(e.hash=j(r[0].u??"",!0)),e.type===7&&e.text){let l=j(e.text.toLowerCase(),!0);e.hash=X(e.hash,l)}if(e.hash||(e.canvases?.length&&(e.hash=e.canvases.reduce((l,d)=>X(j(d),l),e.hash)),e.svgs?.length&&(e.hash=e.svgs.reduce((l,d)=>X(j(d),l),e.hash))),e.type===7&&e.hash){let l=j(Ge(Gt(Math.round(e.height)),Gt(Math.round(e.width))),!0);e.hash=X(e.hash,l)}r.forEach(l=>{l.h&&(l.h=btoa(l.h))}),e.hash=btoa(e.hash)}async function dt(e,t){try{return j(await t(e))}catch(r){return b(r),""}}function j(e,t){if(je(e)==="arraybuffer"){let r=e;return r.byteLength===0?"":lt.default.ArrayBuffer.hash(r,!0)}else{let r=e;return t?lt.default.hash(r,!0):lt.default.hashBinary(r,!0)}}function je(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}function X(e,t){if(!t)return e||"";if(!e)return t;if(e.length<t.length){let c=e;e=t,t=c}let r=e.length,o=t.length,s="";for(let c=0;c<o;c++)s+=String.fromCharCode(e.charCodeAt(c)^t.charCodeAt(c));for(let c=o;c<r;c++)s+=String.fromCharCode(e.charCodeAt(c));return s}function Gt(e){let t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e,!0),t}function Ge(e,t){let r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r.buffer}var B=3e3;var Tt="pc",Nt="ca",tt=72e5,Q=null;function b(...e){Q&&(e=e||[],e=e.map(t=>t?.stack&&t.message?{error:t.message,stack:t.stack}:t),e=e.map(t=>typeof t!="object"||t instanceof String?t:JSON.stringify(t)),e.length==1?Q(e[0]):Q(e))}function Xt(e){Q=e||Q}var pt=class{constructor(t,r,o,s){let c=Kt(t);c==="object"?(this.left=0,Object.assign(this,t)):c==="number"&&(this.left=Math.round(Math.max(t||0,0))||0,this.top=Math.round(Math.max(r||0,0))||0,this.width=Math.round(Math.max(o||0,0))||0,this.height=Math.round(Math.max(s||0,0))||0)}get bottom(){return this.top+this.height}get right(){return this.left+this.width}toString(){return\`\${this.width}x\${this.height}@\${this.left},\${this.top}\`}};function $e(){return("10000000-1000-1000-1000"+-1e11).replace(/[01]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}function Kt(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}function Je(e,t){let r={},o=Object.keys(t);for(let s=0,c=o.length;s<c;s++){let l=o[s];if(t.hasOwnProperty(l)){let d=t[l];if(d==null||d===""&&e[l]||d instanceof Array&&!d.length&&e[l]?.length||(l==="top"||l==="left"||l==="X"||l==="Y")&&e[l]>0)continue;r[l]=t[l]}}return Object.assign(e,t)}function E(e){try{return e()}catch{return null}}var rn=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").map(e=>e.charCodeAt(0));function Yt(e){return e.tagName?.toUpperCase?.()||E(()=>e.outerHTML.substr(1,e.outerHTML.indexOf(" ")-1).toUpperCase())||""}function $t(e){let t=0,r="",o={" ":1,"\\f":1,"\\n":1,"\\r":1,"	":1,"\\v":1,"\\xA0":1,"\\u2028":1,"\\u2029":1};for(let s=0,c=e.length;s<c;s++)o[e.charAt(s)]?(t||(r+=" "),t=1):(t=0,r+=e.charAt(s));return r.trim()}function U(){return ze(C.location.hostname)}function ze(e){return e.split(".").slice(e.endsWith(".uk")||e.endsWith(".jp")?-3:-2).join(".")}function yt(){let e=new Set(["aarp.org","abc.com","aol.com","attn.com","atttvnow.com","brainly.com","bravotv.com","cartoonnetwork.com","cbs.com","cbssports.com","chron.com","citationmachine.net","cnet.com","cnn.com","crunchyroll.com","dailymail.co.uk","delish.com","discoveryplus.com","easybib.com","espn.com","fandom.com","foxbusiness.com","foxnews.com","fubo.tv","genius.com","go.cnn.com","go.com","goodhousekeeping.com","happykids.tv","hulu.com","imdb.com","investigationdiscovery.com","linkedin.com","locast.org","mlb.com","msn.com","music.amazon.com","music.apple.com","music.youtube.com","mytuner-radio.com","nexusmods.com","nfl.com","nhl.com","nypost.com","nytimes.com","paramountplus.com","pch.com","philo.com","playstation.com","pluto.tv","rawstory.com","realtor.com","refinery29.com","seattlepi.com","sfgate.com","sling.com","spanishdict.com","sporcle.com","steampowered.com","tablotv.com","therokuchannel.roku.com","try.frndlytv.com","tubitv.com","tv.apple.com","tv.youtube.com","twitch.tv","uproxx.com","usatoday.com","vudu.com","washingtonpost.com","watch.hgtv.com","watch.spectrum.net","weather.com","www3.nhk.or.jp","xbox.com","xfinity.com","yahoo.com","yelp.com","youtubekids.com"]);return T&&(e.has(C.location.hostname)||e.has(U()))}function O(e){e.documentElement&&(e=e.documentElement);let t=Yt(e);if(e.offsetParent===null&&t!=="BODY"&&t!=="HTML"&&t!=="FRAME")return new pt;let o=(e.ownerDocument||document).defaultView||C,s=e.getBoundingClientRect();return new pt(s.left+o.scrollX,s.top+o.scrollY,s.width,s.height)}var Jt=["background-image","display","visibility","z-index","border-top-width","border-left-width","border-bottom-width","border-right-width","padding-top","padding-left","padding-bottom","padding-right","position","width","height","top","bottom","left","right","font-size"];function Xe(e){if(e._pm_st)return e.style&&(e._pm_st=Je(e._pm_st,JSON.parse(JSON.stringify(e.style,Jt)))),e._pm_st;let t=e.ownerDocument?.defaultView;typeof window<"u"&&(!t||!t.opener)&&(t=window);let r=JSON.parse(JSON.stringify(t.getComputedStyle(e),Jt));return e._pm_st=r,r}function Qt(e,t){let r=e.nodeName,o=Xe(e),s=O(e);if(o?.display!=="none"&&s&&s.width>20&&s.height>20)if(r==="CANVAS"&&!e.matches(".__pm_marker"))try{t.canvases.push(e.toDataURL("image/jpeg",.2))}catch{}else r==="SVG"&&t.svgs.push(e.outerHTML)}function wt(e){if(!e)return"";let t=e?.ownerDocument||document,r=t.defaultView.NodeFilter;if(Kt(e)==="htmldocument"&&e.body&&(e=e.body),!e)return"";let o={SCRIPT:1,NOSCRIPT:1,STYLE:1},s=Yt(e);if(s==="HTML"&&(e=e.querySelector("body")),!e)return"";let c=function(m){try{return m.nodeType===3?r.FILTER_ACCEPT:!m.tagName||o[m.tagName]||m.offsetParent===null?r.FILTER_REJECT:r.FILTER_ACCEPT}catch{return r.FILTER_REJECT}};if(e.nodeType!==3&&(!s||o[s]))return"";let l=t.createTreeWalker(e,r.SHOW_ELEMENT|r.SHOW_TEXT,{acceptNode:c},!0),d={"LEARN MORE":1,REPLAY:1},p=[];for(;e;){if(e.nodeType===3){let m=$t(e.nodeValue||"");!d[m.toUpperCase()]&&!p.includes(m)&&p.push(m)}e=l.nextNode()}return p.length?$t(p.join(" ")):""}function V(e,t){return C.requestIdleCallback?{id:C.requestIdleCallback(e,{timeout:t}),isIdleCallback:!0}:{id:setTimeout(e,t),isIdleCallback:!1}}var Z=null;function P(e){Z=e||Z}function Rt(){Z=null}function Zt(){if(typeof window>"u")return;let e=function(d,p,m,g){V(()=>{!Z||!d||Z(d,p,m,g)},1e4)},t=d=>new TextDecoder("utf-8").decode(new Uint8Array(d)),r=function(d,p){try{if(p=d.currentTarget||p,p=p._datadog_xhr||p,p.readyState===4&&p.status>=200&&p.status<=210){let m=E(()=>p.responseXML),g=E(()=>p.responseText)||E(()=>t(p.response)||JSON.stringify(p.response))||E(()=>m.documentElement.outerHTML);(g||m)&&e(g,m,p.reponseType==="json",p.responseURL)}}catch{}},o=XMLHttpRequest.prototype.send;function s(){let d=this.onreadystatechange,p=arguments;this.onreadystatechange=function(m){return r(m,this),d?.apply?.(this,arguments)},o.apply(this,p)}XMLHttpRequest.prototype.send=s;let c=C.fetch,l=function(){return c.apply(this,arguments).then(async d=>{let p=d.headers.get("Content-Type");if(p&&(p.includes("text")||p.includes("json")||p.includes("xml")||p.includes("javascript"))){let m=d.clone(),g=await m.text();e(g,null,p.includes("json"),m.url)}return d})};C.fetch=l}function Pt(e){if(!e)return null;let t=null;return e=(e+"").trim(),e=="start"?t=0:e.indexOf(":")>=0?t=E(()=>Math.round(e.split(":").reduce((r,o,s,c)=>r+parseFloat(o)*Math.pow(60,c.length-s-1),0)))||t:isNaN(e)||(t=Math.round(parseFloat(e))),t}var te,$,ee,It,H,mt,gt;function re(e){H[e.dedupeKey]?.depth>e.depth||H[e.dedupeKey]?.depth===e.depth&&H[e.dedupeKey].adRuleId<e.adRuleId||(H[e.dedupeKey]=e)}function Ke(){let e=C.location;return e.href.indexOf("youtube.com/watch")===-1?e.origin+e.pathname:e.href}async function Ye(e){await Promise.all(e.map(t=>ht(t,L)))}async function Qe(){let e=Object.values(H),t=Object.values(mt);return H={},mt={},await Ye(e),new z(te,At,e.concat(t).filter(r=>r.hash),$-(F?.TimeOffset||0),Date.now()-(F?.TimeOffset||0),It,ee++,gt)}function I(e,t,r){if(!T){q(top,new N(Tt,[e,t]));return}e.forEach(o=>mt[o.hash]=o),gt=t||gt,k(r)}var zt=0;async function k(e){let t=Date.now();if(t-zt>B||e){zt=t;let r=await Qe();Mt?.(JSON.stringify(r))}}function ne(){if(!T)return;te=$e(),$=Date.now(),ee=0;let e=F?.ParsedSiteConfigs[U()];if(e){let t=new RegExp(e).exec(location.href);It=t?t.slice(1).join(""):location.protocol+"://"+location.hostname}else It=Ke();H={},mt={},gt=void 0}function Ze(e,t){return e.reduce(function(r,o){return(r[t(o)]=r[t(o)]||[]).push(o),r},{})}function ft(e,t){return Object.values(Ze(e,t)).map(r=>r[0])}function q(e,t){e.postMessage(t,"*")}var se=Ct(ut(),1);var tr=/^https:\\/\\/hulu-ad-asset\\/([0-9]+)$/,ie=100,et=new Map,rt=new Map;function ae(){b("HULU AD CAPTURE"),P((e,t,r,o)=>{try{if(!o?.includes("playlist")&&(!o?.includes("manifest.mpd")||r))return;if(o?.includes("playlist")&&er(e).forEach(d=>et.set(d.id,d.url)),o?.includes("manifest.mpd")&&!r){let l=E(()=>t?.documentElement||e&&new DOMParser().parseFromString(e,"application/xml").documentElement);rr(l).forEach(p=>rt.set(p.id,p.ad))}let s=[],c=[];rt.forEach((l,d)=>{let p=et.get(d);p&&(l.sourceUrls.push(new w({url:p,urlType:8})),s.push(l),c.push(d))}),c.forEach(l=>{et.delete(l),rt.delete(l)}),s.length&&I(s,void 0,!0),(et.size>ie||rt.size>ie)&&(et.clear(),rt.clear())}catch(s){b(s)}})}function er(e){try{return JSON.parse(e).breaks?.filter(t=>t.type!=="BlankAdBreakInfo"&&t.url&&t.clickthrough).map(t=>{let r=tr.exec(t.url);return r?{id:r[1],url:t.clickthrough}:null}).filter(t=>t)}catch(t){return b(t),[]}}function rr(e){var t=Array.from(e.querySelectorAll("Period[id^='ad-']"));return t.length?t.map(r=>{try{let o=Array.from(r.querySelectorAll("AdaptationSet[mimeType='video/mp4'] Representation")),s=Array.from(r.querySelectorAll("AdaptationSet[mimeType='audio/mp4'] Representation"));if(!o.length||!s.length)return null;let c=r.querySelector("AssetIdentifier")?.attributes.value.value,l=o.reduce(oe),d=l.querySelector("BaseURL").textContent,p=l.attributes,g=s.reduce(oe).querySelector("BaseURL").textContent;if(!c||!d||!g)return null;let y=parseInt(p.width.value),x=parseInt(p.height.value);return{id:c,ad:new _({width:y,height:x,sourceUrls:[new w({url:d,urlType:4,width:y,height:x}),new w({url:g,urlType:9})],hash:btoa(se.default.hash(d,!0)),type:3,duration:nr(r.attributes.duration.value)})}}catch(o){return b(o),null}}).filter(r=>r):[]}function oe(e,t){return parseInt(e.attributes.bandwidth.value)<parseInt(t.attributes.bandwidth.value)?e:t}function nr(e){let t=e.match(/PT(\\d+(\\.\\d+)?)S/);return t?Math.round(t[1]):null}var _t={},ce=!1;function ue(){if(b("NETFLIX AD CAPTURE"),!(typeof window>"u")){if(!ce){let e=Object.defineProperty;Object.defineProperty=function(r,o,s){return Date.now()-$<tt&&V(()=>{if(Object.hasOwn(r,"isAd")&&r.isAd){let c=ir(r);c&&(_t[c.hash]=c)}}),e(r,o,s)},ce=!0}I(Object.values(_t)),_t={}}}function ir(e){let t=e.movieId;if(!t||_t[t])return;let r=e.video_tracks[0].streams[0],o=r.res_w,s=r.res_h,c=e.audio_tracks[0].streams[0];return new _({hash:("n+++"+t).padEnd(t.length+4+(t.length+4)*6%8/2,"=").replace("===","A=="),type:3,sourceUrls:[new w({url:r.urls[0].url,urlType:4,width:o,height:s}),new w({url:c.urls[0].url,urlType:9})],width:o,height:s,duration:e.duration,language:c.language,netflixData:{id:t}})}function le(){b("TIKTOK AD CAPTURE"),P((e,t,r,o)=>{try{if(!o||!o.includes("item_list"))return;let s=or(e);I(s)}catch{}})}function or(e){return JSON.parse(e).itemList.filter(o=>o.isAd===!0).map(o=>{let s=o.ad_info,c=o.author,l=o.video;return new _({width:l.width,height:l.height,hash:s.ad_id,type:105,tikTokData:{adId:s.ad_id,creativeId:s.creative_id,postId:o.id,advertiserId:s.advertiser_id,accountName:c.uniqueId,displayName:c.nickname,caption:o.desc,cta:s.button_text,landingPage:s.web_url}})})}var nt=[];async function Ut(){b("TWITTER AD CAPTURE"),P((e,t,r,o)=>{try{if(!o||!o.includes("HomeTimeline")&&!(o.includes("/conversation/")&&o.includes("/"+/\\d+$/.exec(window.location.pathname)[0]+".json")))return;let s=sr(e);nt=nt.concat(s)}catch{}}),await ar()}function sr(e){let t=JSON.parse(e);return([].concat.apply([],t?.data?.home?.home_timeline_urt?.instructions?.filter?.(s=>s?.type=="TimelineAddEntries")?.map?.(s=>s.entries))||[]).map(s=>s.content?.itemContent).filter(s=>s?.promotedMetadata).map(s=>{let c=s.tweet_results?.result?.card?.legacy?.binding_values?.filter?.(d=>d?.key=="unified_card")?.map?.(d=>JSON.parse(d.value?.string_value))?.[0],l=c?.destination_objects?.browser_1?.data?.url_data?.url||c?.destination_objects?.browser_with_docked_media_1?.url_data?.url;return{id_str:s?.tweet_results?.result?.rest_id,screen_name:s?.tweet_results?.result?.core?.user_results?.result?.legacy?.screen_name,cardDestination:l,advertiserId:s?.promotedMetadata?.advertiser_results?.result?.rest_id,user_id_str:s?.tweet_results?.result?.legacy?.user_id_str}}).filter(s=>s.id_str&&s.screen_name)}async function ar(){if(!it)return;let e=await cr(document,nt),t=e.map(r=>r.twitterData.tid);nt=nt.filter(r=>!t.includes(r.id_str)),I(e)}async function cr(e,t){let o=Array.from(e.querySelectorAll("div.tweet.promoted-tweet"));o.length||(o=Array.from(e.querySelectorAll("article div>svg")).map(c=>c.parentElement.querySelector("span")).filter(c=>c?.textContent&&c.textContent.length<50).map(c=>c.closest("article"))),o.length||(o=Array.from(document.querySelectorAll("span")).filter(c=>c.textContent==="Ad").map(c=>c.closest("article")));let s=[];for(let c=0;c<o.length;c++){let l=o[c],d=Array.from(l.querySelectorAll("div>span,a span")).map(v=>v.textContent).filter(v=>v?.startsWith("@"))[0];d=d.startsWith("@")?d.substring(1):d;let p=null,m=null;for(m of t)if(m.screen_name==d&&(p=m.id_str,p))break;if(!p)continue;let g=wt(l);g&&(g=g.replace(new RegExp("# (\\\\w)","gi"),"#$1"));let y=O(l),x=new _({x:y.left,y:y.top,width:y.width,height:y.height,text:g,sourceUrls:(await Y(l.querySelector(".tweet-details-fixer")||l)).concat([new w({url:m.cardDestination,urlType:8})]).filter(v=>v.url&&!v.url.includes("/profile_images/")&&!v.url.includes(p+"/retweets")&&!v.url.includes(p+"/likes")&&!v.url.includes("/using-twitter/how-to")),hash:("t+++"+p).padEnd(p.length+4+(p.length+4)*6%8/2,"=").replace("===","A=="),type:l.querySelector("video")||l.querySelector(".PlayableMedia")?105:Array.from(l.querySelectorAll("img")).filter(v=>v.naturalWidth>200&&v.naturalHeight>40).length?104:l.querySelector("iframe")?102:103,twitterData:{taid:m.advertiserId||m.user_id_str||0,tid:p,tsn:d}}),R=(x.sourceUrls||[]).filter(v=>v?.url);x.sourceUrls=ft(R,v=>v.url),s.push(x)}return s}function Ot(){b("VAST AD CAPTURE"),P((e,t,r)=>{try{let o=e.substring(0,500),s=o.indexOf('"ad_id":')>=0||o.indexOf('"ad_type"')>=0,c=[];if(r||s)ur(e,c);else if(o.indexOf("<VAST ")>=0||o.indexOf("<vmap:AdBreak ")>=0){let l=E(()=>t?.documentElement||e&&new DOMParser().parseFromString(e,"application/xml").documentElement);lr(l,c)}else return;Promise.allSettled(c).then(l=>{b("Ads found.",l.map(d=>d.value)),I(l.map(d=>d.value).filter(d=>d))})}catch(o){b(o)}})}function ur(e,t){let r=E,o=r(()=>e&&JSON.parse(e)),s=r(()=>o.items);s?.length&&Array.from(s).forEach(c=>{let l=r(()=>c.media.streamurl);if(!l)return;let d=r(()=>c.clickthrough),p=r(()=>c.media.duration),m=r(()=>c.ad_id||c.ad_video_id),g=r(()=>c.title);m&&U()==="peacocktv.com"&&(m=m.split(".")[0]);let y=r(()=>c.system);t.push(dt(l,L).then(x=>new _({width:1920,height:1080,sourceUrls:[new w({url:l,urlType:4}),new w({url:d,urlType:8}),new w({url:"http://"+y,urlType:1})].filter(v=>v.url),hash:btoa(x)||m,type:3,duration:Math.round(p),vastData:{Id:m,Title:g,System:y}})))})}function lr(e,t){let r=E,o=r(()=>e?.querySelectorAll("VAST Ad"));o&&Array.from(o).forEach(s=>{let c=s.querySelector("Creatives Creative");if(!c)return;let l=c.querySelector("MediaFiles");if(!l)return;let d=r(()=>c.querySelector("VideoClicks ClickThrough").textContent.trim())||r(()=>document.querySelector(".AdUnitView a").href.trim()),p=r(()=>Pt(c.querySelector("Duration").textContent)),m=r(()=>l.querySelector("MediaFile[type='video/mp4'],MediaFile[type='application/dash+xml'],MediaFile[type='video/mpd']").textContent.trim());if(!m){let h=c.querySelector("AdParameters"),i={},n,u=new RegExp("<(\\\\w+)>([^<]+)</\\\\1>","gi");for(;(n=u.exec(h.textContent))!==null;)i[n[1]]=n[2];p=r(()=>Pt(i.adDuration)),d=r(()=>i.clickUrl);let a=i.JsParameters;if(!a)return;let S=JSON.parse(a);m=r(()=>S.videos[0].url),m&&(p=p||S.duration,d=d||S.clickThruUrl||S.clickThroughUrl)}if(!m)return;let g=c.getAttribute("AdID")||c.getAttribute("AdId")||c.getAttribute("adid")||s.getAttribute("id");if(!g)return;U()==="peacocktv.com"&&(g=g.split(".")[0]);let y=r(()=>s.querySelector("AdTitle").textContent.trim()),x=r(()=>s.querySelector("AdSystem").textContent.trim()),R=s.querySelector("Extension"),v=r(()=>R.querySelector("CreativeParameter[name='_fw_advertiser_name']").textContent.trim())||r(()=>R.querySelector("CreativeParameter[name='fw_advertiser_name']").textContent.trim())||r(()=>R.querySelector("CreativeParameter[name='fw_advertiser']").textContent.trim()),W=r(()=>R.querySelector("CreativeParameter[name='fw_brand']").textContent.trim()),A=r(()=>R.querySelector("CreativeParameter[name='industry']").textContent.trim()),f=r(()=>R.querySelector("CreativeParameter[name='ccr_measurement']").textContent.trim());t.push(dt(m,L).then(h=>new _({width:1920,height:1080,sourceUrls:[new w({url:m,urlType:4}),new w({url:d,urlType:8}),new w({url:f,urlType:0})].filter(i=>i.url),hash:btoa(h)||g,type:3,duration:Math.round(p),vastData:{Id:g,Adv:v,Brand:W,Cat:A,Title:y,System:x}})))})}var de=Ct(ut(),1);function hr(e){return e?new URL(e).searchParams.get("v"):null}var Dt;function bt(){return Dt||(Dt=document.querySelector("#movie_player")),Dt}function dr(){return E(()=>{let e=JSON.parse(bt().getDebugText());return e.ad_debug_videoId||e.addebug_videoId||e.ad_videoId})}function fr(){return E(()=>{let e=document.querySelector("#upload-info a.yt-simple-endpoint"),t=e.href.split("/");return{youTubeChannelId:t[t.length-1],youTubeChannelName:e.textContent.trim(),youTubeVideoId:E(()=>hr(window.location.href))}})}function pr(){let e=E(()=>document.querySelector(".ytp-ad-player-overlay-instream-info .ytp-ad-button-text").textContent);if(e&&yr.test(e)){let t=e.indexOf("http://")===0||e.indexOf("https://")===0?e:"https://"+e.toLowerCase();return new w({url:t,urlType:8})}return null}function mr(e){return e?btoa(de.default.hash("YouTube+"+e,!0)):null}function gr(){return E(()=>bt().getAdState()>0||JSON.parse(bt().getDebugText()).addebug_videoId)}var yr=new RegExp("^(?:https?://)?[a-z0-9.-]+(\\\\.[a-z]+)+(?:$|/)"),fe={};function he(e){[e?.playerAds??[],e?.adPlacements??[]].flat().map(t=>(t.adPlacementRenderer?.renderer?.linearAdSequenceRenderer?.linearAds?.map(r=>r?.instreamVideoAdRenderer)??[]).concat([t.adPlacementRenderer?.renderer?.instreamVideoAdRenderer])).flat().filter(t=>t).map(function(t){let r=t?.playerOverlay?.instreamAdPlayerOverlayRenderer?.visitAdvertiserRenderer?.buttonRenderer?.navigationEndpoint?.urlEndpoint?.url;return r?{videoId:t.externalVideoId,lp:r}:null}).filter(t=>t).reduce((t,r)=>Object.assign(t,{[r.videoId]:new w({url:r.lp,urlType:8})}),fe)}function pe(){try{if(P((p,m,g,y)=>{try{if(!y||!y.includes("/ad_break?")&&!y.includes("/player?"))return;he(JSON.parse(p))}catch(x){b(x)}}),!gr())return k();he(window.ytInitialPlayerResponse);let e=0,t=640,r=360,o=0,s=0,c=bt(),l=c.querySelector("a.ytp-title-link"),d=c.querySelector("video");if(d){e=d.duration||0;let p=O(d);t=p?.width||t,r=p?.height||r,o=p?.left||o,s=p?.top||s}V(()=>{let p=dr()||void 0,m=fe[p]??pr(),g=fr(),y=m?[m]:[],x=new _({x:o,y:s,width:t,height:r,text:l?.textContent,sourceUrls:y,hash:mr(p),type:3,duration:Math.round(e),youTubeId:p});I([x],g)})}catch(e){b(e)}}var ot=class{constructor(t=null){this.log=t,this.#t.log=t??(()=>{})}simplifyTree(t){let r;for(;;){if(r=this.#t[t.r],!r)throw new Error(\`Rule \${t.r} not implemented.\`);if(r!==this.#t.PassOn||!t.c||!t.c.length)break;t=t.c[0]}return t.c&&t.c.length&&(t.c=t.c.map(o=>this.simplifyTree(o))),t}debugPrintParseTree(t,r=0){this.log(\`\${" ".repeat(r*2)}\${t.r}: \${this.#t.GetText(t)}\`),t.c&&t.c.length&&t.c.forEach(o=>this.debugPrintParseTree(o,r+1))}isValidRuleName(t){return t.indexOf("TerminalNode")===0||!!this.#t[t]}evaluate(t,r){return this.#t.evaluate(t,r)}#t=class{static#s=0;static evaluate(t,r,o){try{if(!this[t.r])throw new Error(t.r+" is not a parser rule function.");return this[t.r](t,r,o)}catch(s){this.log("Error "+t.r+' at "'+this.GetText(t)+'": '+s)}}static#i=new RegExp(\`(?:^['"])|(?:['"]$)\`,"g");static#o=new RegExp("\\\\s+","g");static#a=this;static PassOn(t,r){return this.evaluate(t.c[0],r)}static NoOp(t){this.log(\`Unimplemented rule: \${t.r} at "\${this.GetText(t.t)}".\`)}static ExpStmt=this.PassOn;static ExpSequence=this.PassOn;static LitExp=this.PassOn;static Literal=this.PassOn;static ArrayLitExp=this.PassOn;static ArrayLit=this.PassOn;static ArrowFuncBody=this.PassOn;static ObjectLitExp=this.PassOn;static IdName=this.PassOn;static MultOperator=this.NoOp;static AdditionOperator=this.NoOp;static RelationalOperator=this.NoOp;static EqualityOperator=this.NoOp;static ReservedWord=this.NoOp;static AssignExp=this.NoOp;static VarModifier=this.NoOp;static FormalParameterList=this.NoOp;static FormalParameterArg=this.NoOp;static PropAssign=this.NoOp;static Exp=this.NoOp;static Assignable=this.NoOp;static AnonFunc=this.NoOp;static ArrowFuncParameters=this.NoOp;static PropName(t){return t.c?t.c[0].t:this.#r(t.t)}static ObjectLit(t,r){let o={};return t.c.forEach(s=>this.PropExpAssign(s,r,o)),o}static PropExpAssign(t,r,o){let s=this.evaluate(t.c[0],r),c=this.evaluate(t.c[1],r);o[s]=c}static#r(t){return t?.replaceAll(this.#i,"")}static StrLit(t){return this.#r(t?.t)}static NumLit(t){return Number.parseFloat(t?.t)}static IntLit(t){return Number.parseInt(t?.t)}static BoolLit(t){return t.t&&t.t=="true"}static NullLit(){return null}static IdExp(t,r){return this.evaluate(t.c[0],r)}static Id(t,r){return r[t.t]}static FuncExp(t,r){return this.evaluate(t.c[0],r)}static ArrowFunc(t,r){let o=t.c[0]?.c?.map(c=>this.#e(c)).flat(),s=this;return function(...c){o.forEach((d,p)=>{r[d]=c[p]});let l=s.evaluate(t.c[1],r);return o.forEach(d=>{delete r[d]}),l}}static AnonFuncDecl(t,r){let o=t.c[0]?.c?.map(c=>this.#e(c)).flat(),s=this;return function(...c){o.forEach((d,p)=>{r[d]=c[p]});let l=s.evaluate(t.c[1],r);return o.forEach(d=>{delete r[d]}),l}}static#e(t,r=null){return r=r??[],t.c?.forEach(o=>this.#e(o,r)),t.t&&r.push(t.t),r}static#c(t,r=0){this.log(\`\${"  ".repeat(r)}\${t.r}: \${this.GetText(t)}\`)}static GetText(t){return this.#e(t).join(" ")}static ElementList(t,r){return t.c.map(o=>this.evaluate(o,r))}static ArrayElem=this.PassOn;static ArgsExp(t,r){let o=t.c[0],s=this.evaluate(t.c[1],r),c=this.evaluate(o,r,s);return typeof c=="function"&&(c=c.apply(o._this??null,s)),delete o._this,c}static Args(t,r){return t.c.map(o=>this.evaluate(o,r))}static Arg(t,r){return this.evaluate(t.c[0],r)}static MemberDotExp(t,r,o){return this.#n(t,r,o,!0)}static MemberIndexExp(t,r,o){return this.#n(t,r,o)}static#n(t,r,o,s){let c=this.evaluate(t.c[0],r),l=s?t.c[1].t:this.evaluate(t.c[1],r);return this["_x_"+l]?this["_x_"+l](c,...o??[]):(t._this=c,c[l])}static ErrorNodeImpl(t){this.log(\`Error parsing \${t.r} at \${t.t} (unexpected token?)\`)}static AdditiveExp(t,r){switch(t.c[1].t){case"+":return this.evaluate(t.c[0],r)+this.evaluate(t.c[2],r);case"-":return this.evaluate(t.c[0],r)-this.evaluate(t.c[2],r);default:throw new Error("Unknown binary operator "+t.c[1].t)}}static MultiplicativeExp(t,r){switch(t.c[1].t){case"*":return this.evaluate(t.c[0],r)*this.evaluate(t.c[2],r);case"/":return this.evaluate(t.c[0],r)/this.evaluate(t.c[2],r);case"%":return this.evaluate(t.c[0],r)%this.evaluate(t.c[2],r);default:throw new Error("Unknown binary operator "+t.c[1].t)}}static RelationalExp(t,r){switch(t.c[1].t){case">":return this.evaluate(t.c[0],r)>this.evaluate(t.c[2],r);case"<":return this.evaluate(t.c[0],r)<this.evaluate(t.c[2],r);case">=":return this.evaluate(t.c[0],r)>=this.evaluate(t.c[2],r);case"<=":return this.evaluate(t.c[0],r)<=this.evaluate(t.c[2],r);default:throw new Error("Unknown binary operator "+t.c[1].t)}}static EqualityExp(t,r){switch(t.c[1].t){case"==":return this.evaluate(t.c[0],r)==this.evaluate(t.c[2],r);case"!=":return this.evaluate(t.c[0],r)!=this.evaluate(t.c[2],r);case"===":return this.evaluate(t.c[0],r)===this.evaluate(t.c[2],r);case"!==":return this.evaluate(t.c[0],r)!==this.evaluate(t.c[2],r);default:throw new Error("Unknown binary operator "+t.c[1].t)}}static TernaryExp(t,r){return this.evaluate(t.c[0],r)?this.evaluate(t.c[1],r):this.evaluate(t.c[2],r)}static CoalesceExp(t,r){return this.evaluate(t.c[0],r)??this.evaluate(t.c[1],r)}static InstanceofExp(t,r){return this.evaluate(t.c[0],r)instanceof this.evaluate(t.c[1],r)}static LogicalAndExp(t,r){return this.evaluate(t.c[0],r)&&this.evaluate(t.c[1],r)}static LogicalOrExp(t,r){return this.evaluate(t.c[0],r)||this.evaluate(t.c[1],r)}static UnaryPlusExp(t,r){return+this.evaluate(t.c[0],r)}static UnaryMinusExp(t,r){return-this.evaluate(t.c[0],r)}static BitNotExp(t,r){return~this.evaluate(t.c[0],r)}static NotExp(t,r){return!this.evaluate(t.c[0],r)}static ParenthesizedExp(t,r){return this.evaluate(t.c[0],r)}static Eos(){return null}static _x_query(t,r){return Array.from(t?.querySelectorAll(r)??[])}static _x_where(t,r){return t?.filter(r)}static _x_select(t,...r){let o=r.length;if(!r||o===0)throw new Error("Method 'select' expects on or more arrow functions.");return t?.map((s,c)=>{if(o>1){let l=[];for(let d=0;d<o-1;d++)l[d]=r[d](s,...d==0?[c]:l);return r[o-1](s,...l)}else return r[0](s,c)})}static _x_width(t){return t?.offsetWidth}static _x_height(t){return t?.offsetHeight}static _x_text(t){return t?.textContent?.trim()?.replaceAll(this.#o," ")}static _x_parent(t){return t?.parentNode}static _x_matchRegExp(t,r,o){return t.match(new RegExp(r,o))}}};function Ft(e){if(e.checkVisibility&&!e.checkVisibility({checkOpacity:!0,checkVisibilityCSS:!0}))return!1;let t=e.ownerDocument,r=t.defaultView,o=r?.getComputedStyle(e);if(o&&(o.opacity==="0"||o.visibility==="hidden"))return!1;let s=e.getBoundingClientRect();if(!s||s.width<=0||s.height<=0)return!1;let{top:c,left:l,right:d,bottom:p}=s;if(d<0||p<0)return!1;let m=r?.innerWidth||t.documentElement.clientWidth,g=r?.innerHeight||t.documentElement.clientHeight;if(c>g||l>m)return!1;let y=e.parentNode;if(y&&y instanceof Element&&getComputedStyle(y).overflow==="hidden"){let x=y.getBoundingClientRect();if(p<x.top||c>x.bottom||d<x.left||l>x.right)return!1}return!0}function me(e,t){return r=>new Promise(o=>{let s=e+"-response",c=Math.random(),l=p=>{let{type:m,payload:g,nonce:y}=p.data??{};m!==s||y!==c||(o(g),d())},d=()=>{window.removeEventListener("message",l)};window.addEventListener("message",l),s==="getFrameId-response"?r.postMessage(new N("getFrameId",c),"*"):window.postMessage({type:e,nonce:c,payload:r},"*"),t&&setTimeout(o,t)})}var ye,we,Ae,J,xt=new Set,St=new Set,Lt=new Set,ct=!1,Ht=[],_e=[],Mt,L,F,At,it,C=typeof window>"u"?{location:{hostname:""}}:window,T=C.top===C.self,wr=(Math.random()+1).toString(36).substring(2),Ar=2e3,be=7e3,_r=5*be,br=2e3;function at(e,t,...r){let o=setTimeout(e,t,...r);return xt.add(o),o}function st(e,t,...r){let o=setInterval(e,t,...r);return St.add(o),o}function Bt(e,t){let r=V(e,t);return r.isIdleCallback?Lt.add(r.id):xt.add(r.id),r}var vr={"hulu.com":[ae],"netflix.com":[ue],"tiktok.com":[le],"twitter.com":[Ut],"x.com":[Ut],"youtube.com":[pe]};ct||(typeof U<"u"&&(J=U()),typeof yt<"u"&&(yt()||ve())&&Zt());function ve(){return vr[J]}function xr(){if(!T||!it)return;if(yt()){Ot();let s=new Set,c=()=>{let l=Array.from(C.frames).concat(Array.from(document.querySelectorAll("frame,iframe")).map(d=>E(d.contentWindow)).filter(d=>d));for(let d=0;d<l.length;d++)try{let p=l[d];if(!p||s.has(p))continue;q(p,new N(Nt,tt-(Date.now()-$))),s.add(p)}catch(p){b(p)}};c(),st(c,5e3)}let e=Date.now(),t=ve(),r=function(s){e=Date.now(),Bt(async()=>{for(let c=0,l=t?.length;t&&c<l;c++)await t[c].call();T&&(t||s)&&k()},B-500)},o=st(r,B);r(!0),st(()=>{Date.now()-e>B*5&&(clearInterval(o),St.delete(o),o=st(r,B),r(!0))},B)}function xe(){T&&(J=U(),xt=new Set,St=new Set,Lt=new Set,ne(),k())}function Sr(){if(!T)return;let e=F.AdRules.filter(o=>!o.Hostnames||o.Hostnames.startsWith("^")&&!o.Hostnames.includes(J)),t=F.AdRules.filter(o=>o.Hostnames&&!o.Hostnames.startsWith("^")&&o.Hostnames.includes(J)),r=e.concat(t);at(()=>{kr();let o=st(()=>{ge(r)},be);ge(r),at(()=>{t.length?r=t:clearInterval(o)},_r)},Ar)}var Er=new Set(["facebook.com","hulu.com","netflix.com","twitter.com","x.com"]);function Se(){xr(),Er.has(J)||Sr(),at(Tr,tt)}function Cr(e){if(!T)return;let t=C.location.href.split("#")[0];setInterval(()=>{let r=C.location.href.split("#")[0];r!==t&&(t=r,e())},1e3)}function Ee(){xt.forEach(e=>clearTimeout(e)),St.forEach(e=>clearInterval(e)),Lt.forEach(e=>cancelIdleCallback(e))}function Ir(){Ee(),xe(),Se()}function Tr(){Rt(),Ee()}function Nr(e){ct?ht(e,L).then(()=>window.dispatchEvent(new CustomEvent("displayAdFound",{detail:e}))):re(e)}async function Rr(e){try{let t=N.fromObject(e.data);if(!t)return;let r=t.data;switch(t.operation){case Nt:r>0&&(Ot(),at(Rt,r));break;case Tt:I(r[0],r[1]);break;case"extractDisplayAd":T||await vt(document.documentElement,r);break;case"displayAdFound":T&&Nr(r);break;case"getFrameId":q(e.source,{type:"getFrameId-response",payload:wr,nonce:r});break}}catch(t){b(t);return}}function Pr(){function e(){C.addEventListener("message",Rr,!0)}e();let t=setInterval(e,200);setTimeout(clearInterval,1e4,t)}function Mr(e){we=e.getInstallId,ct=e.isRuleEditor,Mt=e.sendData,L=e.fetchHttpResponse,ye=e.getExternalConfiguration?t=>e.getExternalConfiguration(t):null,Xt(e.pm_log)}function Ce(e){Ae=me("getFrameId",1e3),L=e.fetchHttpResponse,Pr(),T&&(Mr(e),we().then(t=>At=t).then(t=>ye()).then(t=>F=t||{EnabledPct:0}).then(t=>{it=Array.from(At).map(r=>r.charCodeAt(0)).reduce((r,o)=>r+o,0)%100<F.EnabledPct,it&&(xe(),Se(),Cr(Ir))}))}async function Ur(e,t){ct||(T||(t.dedupeKey=await Ae(e.ownerDocument.defaultView)),t.dedupeKey??=\`\${t.width}x\${t.height} @ \${t.x},\${t.y}\`),q(top,new N("displayAdFound",t))}async function Or(e,t){if(e){let r=O(e);(t.isFromIFrame||e.nodeName!=="IFRAME")&&(t.x+=r.left,t.y+=r.top),t.sourceUrls.push(...await Y(e,t.depth)),t.text+=wt(e)+" ";let o=Array.from(e.querySelectorAll("canvas, svg"));o.length&&o.forEach(s=>Qt(s,t))}}async function vt(e,t){if(await Or(e,t),e.nodeName==="IFRAME"){t.depth++,t.outerHtml=e.outerHTML;try{await vt(e.contentWindow.document.documentElement,t)}catch{q(e.contentWindow,new N("extractDisplayAd",t));try{var r=e.contentWindow.frames;for(let s=0,c=r.length;s<c;s++)try{q(r[s],new N("extractDisplayAd",t))}catch(l){b(l)}}catch(s){b(s)}}}else{e.nodeName==="HTML"&&(t.outerHtml+=\`<!-- IFRAME Content -->\${e.outerHTML}\`);let o;if(t.isFromIFrame){if(e.scrollWidth<=t.width-5||e.scrollHeight<=t.height-5)return;o=Array.from(e.querySelectorAll("iframe")).filter(s=>(s.scrollWidth>=t.width||s.scrollHeight>=t.height)&&s.scrollWidth>=_.minWidth&&s.scrollHeight>=_.minHeight&&Ft(s))}else o=Array.from(e.querySelectorAll("iframe")).filter(s=>Ft(s)).sort((s,c)=>s.scrollWidth*s.scrollHeight-c.scrollWidth*c.scrollHeight).slice(0,1);o?.length?await Promise.allSettled(o.map(s=>{let c={...t,width:Math.min(t.width,s.offsetWidth),height:Math.min(t.height,s.offsetHeight),sourceUrls:t.sourceUrls.map(l=>l)};return vt(s,c)})):(t.text=t.textOverride??t.text.trim(),Ur(e,t))}}function Dr(e,t,r){try{let o=new ot,s=o.evaluate(t,{doc:document});Ht.forEach(c=>s.push(...o.evaluate(t,{doc:c}))),_e.forEach(c=>{c.doc.defaultView&&s.push(...o.evaluate(t,{doc:c.doc}).map(l=>Ie(l)?(l.x??=c.x,l.y??=c.y,l.depth??=c.depth,l):{element:l,x:c.x,y:c.y,depth:c.depth}))}),s&&s.forEach(async c=>await Lr(e,c,r))}catch{}}function Fr(e){e.forEach(t=>Dr(t.Id,t.ParseTree))}async function Lr(e,t,r){let o={};Ie(t)&&(o=t,t=t.element,delete o.element);let s=new _({width:t.offsetWidth,height:t.offsetHeight,adRuleId:e});s.isFromIFrame=t.nodeName==="IFRAME",ct&&(s.adRuleName=r,s.tabUrl=location.href),Object.assign(s,o),await vt(t,s)}function ge(e){T&&Bt(t=>{t.didTimeout||(Fr(e),at(k,br))},4e3)}function Hr(e){let t=Date.now(),r=null;for(;r=e[0];){for(var o=null;o=r.nextNode();)if(o.shadowRoot&&(e.push(document.createTreeWalker(o.shadowRoot,NodeFilter.SHOW_ELEMENT)),Ht.push(o.shadowRoot)),Date.now()-t>50)return!1;e.shift()}return!0}function Br(){Ht=[];let e=[];try{e.push(document.createTreeWalker(document.body,NodeFilter.SHOW_ELEMENT))}catch{}let t=!1,r=0;for(;!t&&r++<100;)Bt(()=>t||=Hr(e))}function Vr(){_e=Array.from(document.querySelectorAll("iframe")).filter(e=>e.src&&new URL(e.src).origin==top.location.origin&&e.offsetWidth>=_.minWidth&&e.offsetHeight>=_.minHeight).map(e=>{try{let t=e.contentWindow,r=O(e),o=r.left,s=r.top,c=1;for(;t?.parent&&t.parent!==top;)t=t.parent,r=O(t.frameElement),o+=r.left,s+=r.top,c++;return{doc:e.contentDocument,x:o,y:s,depth:c}}catch{return null}}).filter(e=>e)}function kr(){Br(),Vr()}function Ie(e){return!(e instanceof Node)&&e.element}function Te(...e){console.log("[injected-script]",...Array.isArray(e)?e:[e])}function Et(e,t){return r=>new Promise(o=>{let s=t+"-response",c=Math.random(),l=p=>{let{type:m,payload:g,nonce:y}=p.data??{};m!==s||y!==c||(e?.("Got response:",{name:t,payload:r,response:g}),o(g),d())},d=()=>{window.removeEventListener("message",l)};window.addEventListener("message",l),e?.("Sending message:",{name:t,payload:r}),window.postMessage({type:t,payload:r,nonce:c},"*")})}function Ne(e,t){return r=>{e?.("Sending message:",{type:t,payload:r}),window.postMessage({type:t,payload:r},"*")}}var Re="ads#INIT",Pe="ads#SEND_DATA",Me="ads#GET_INSTALL_ID",Ue="ads#GET_EXTERNAL_CONFIG",Oe="ads#FETCH_HTTP_RESPONSE";function De(e){let t=e.enableLogs?Te:void 0;t?.("Recieved init event",{config:e});let r=Ne(t,Pe),o=Et(t,Me),s=Et(t,Ue),c=Et(t,Oe);Ce({getInstallId:o,fetchHttpResponse:c,sendData:r,pm_log:t,getExternalConfiguration:s})}function qr(){window.addEventListener("message",({data:e})=>{e?.type===Re&&De(e.payload)})}qr();})();
`;var Pl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ml(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Cl={exports:{}};(function(t,e){(function(r,n){n(t)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Pl,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const n="The message port closed before a response was received.",s=a=>{const i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(i).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(T,_=void 0){super(_),this.createItem=T}get(T){return this.has(T)||this.set(T,this.createItem(T)),super.get(T)}}const u=y=>y&&typeof y=="object"&&typeof y.then=="function",l=(y,T)=>(..._)=>{a.runtime.lastError?y.reject(new Error(a.runtime.lastError.message)):T.singleCallbackArg||_.length<=1&&T.singleCallbackArg!==!1?y.resolve(_[0]):y.resolve(_)},c=y=>y==1?"argument":"arguments",m=(y,T)=>function(_,...P){if(P.length<T.minArgs)throw new Error(`Expected at least ${T.minArgs} ${c(T.minArgs)} for ${y}(), got ${P.length}`);if(P.length>T.maxArgs)throw new Error(`Expected at most ${T.maxArgs} ${c(T.maxArgs)} for ${y}(), got ${P.length}`);return new Promise((N,U)=>{if(T.fallbackToNoCallback)try{_[y](...P,l({resolve:N,reject:U},T))}catch(G){console.warn(`${y} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,G),_[y](...P),T.fallbackToNoCallback=!1,T.noCallback=!0,N()}else T.noCallback?(_[y](...P),N()):_[y](...P,l({resolve:N,reject:U},T))})},d=(y,T,_)=>new Proxy(T,{apply(P,N,U){return _.call(N,y,...U)}});let w=Function.call.bind(Object.prototype.hasOwnProperty);const A=(y,T={},_={})=>{let P=Object.create(null),N={has(G,I){return I in y||I in P},get(G,I,K){if(I in P)return P[I];if(!(I in y))return;let L=y[I];if(typeof L=="function")if(typeof T[I]=="function")L=d(y,y[I],T[I]);else if(w(_,I)){let H=m(I,_[I]);L=d(y,y[I],H)}else L=L.bind(y);else if(typeof L=="object"&&L!==null&&(w(T,I)||w(_,I)))L=A(L,T[I],_[I]);else if(w(_,"*"))L=A(L,T[I],_["*"]);else return Object.defineProperty(P,I,{configurable:!0,enumerable:!0,get(){return y[I]},set(H){y[I]=H}}),L;return P[I]=L,L},set(G,I,K,L){return I in P?P[I]=K:y[I]=K,!0},defineProperty(G,I,K){return Reflect.defineProperty(P,I,K)},deleteProperty(G,I){return Reflect.deleteProperty(P,I)}},U=Object.create(y);return new Proxy(U,N)},f=y=>({addListener(T,_,...P){T.addListener(y.get(_),...P)},hasListener(T,_){return T.hasListener(y.get(_))},removeListener(T,_){T.removeListener(y.get(_))}}),g=new o(y=>typeof y!="function"?y:function(T){const _=A(T,{},{getContent:{minArgs:0,maxArgs:0}});y(_)}),b=new o(y=>typeof y!="function"?y:function(T,_,P){let N=!1,U,G=new Promise(H=>{U=function(W){N=!0,H(W)}}),I;try{I=y(T,_,U)}catch(H){I=Promise.reject(H)}const K=I!==!0&&u(I);return I!==!0&&!K&&!N?!1:((H=>{H.then(W=>{P(W)},W=>{let O;W&&(W instanceof Error||typeof W.message=="string")?O=W.message:O="An unexpected error occurred",P({__mozWebExtensionPolyfillReject__:!0,message:O})}).catch(W=>{console.error("Failed to send onMessage rejected reply",W)})})(K?I:G),!0)}),S=({reject:y,resolve:T},_)=>{a.runtime.lastError?a.runtime.lastError.message===n?T():y(new Error(a.runtime.lastError.message)):_&&_.__mozWebExtensionPolyfillReject__?y(new Error(_.message)):T(_)},x=(y,T,_,...P)=>{if(P.length<T.minArgs)throw new Error(`Expected at least ${T.minArgs} ${c(T.minArgs)} for ${y}(), got ${P.length}`);if(P.length>T.maxArgs)throw new Error(`Expected at most ${T.maxArgs} ${c(T.maxArgs)} for ${y}(), got ${P.length}`);return new Promise((N,U)=>{const G=S.bind(null,{resolve:N,reject:U});P.push(G),_.sendMessage(...P)})},E={devtools:{network:{onRequestFinished:f(g)}},runtime:{onMessage:f(b),onMessageExternal:f(b),sendMessage:x.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:x.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},C={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":C},services:{"*":C},websites:{"*":C}},A(a,E,i)};r.exports=s(chrome)}})})(Cl);var Jb=Cl.exports;const Os=Ml(Jb);var Il={exports:{}};(function(t){var e=function(){var r=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function i(u,l){if(!a[u]){a[u]={};for(var c=0;c<u.length;c++)a[u][u.charAt(c)]=c}return a[u][l]}var o={compressToBase64:function(u){if(u==null)return"";var l=o._compress(u,6,function(c){return n.charAt(c)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(u){return u==null?"":u==""?null:o._decompress(u.length,32,function(l){return i(n,u.charAt(l))})},compressToUTF16:function(u){return u==null?"":o._compress(u,15,function(l){return r(l+32)})+" "},decompressFromUTF16:function(u){return u==null?"":u==""?null:o._decompress(u.length,16384,function(l){return u.charCodeAt(l)-32})},compressToUint8Array:function(u){for(var l=o.compress(u),c=new Uint8Array(l.length*2),m=0,d=l.length;m<d;m++){var w=l.charCodeAt(m);c[m*2]=w>>>8,c[m*2+1]=w%256}return c},decompressFromUint8Array:function(u){if(u==null)return o.decompress(u);for(var l=new Array(u.length/2),c=0,m=l.length;c<m;c++)l[c]=u[c*2]*256+u[c*2+1];var d=[];return l.forEach(function(w){d.push(r(w))}),o.decompress(d.join(""))},compressToEncodedURIComponent:function(u){return u==null?"":o._compress(u,6,function(l){return s.charAt(l)})},decompressFromEncodedURIComponent:function(u){return u==null?"":u==""?null:(u=u.replace(/ /g,"+"),o._decompress(u.length,32,function(l){return i(s,u.charAt(l))}))},compress:function(u){return o._compress(u,16,function(l){return r(l)})},_compress:function(u,l,c){if(u==null)return"";var m,d,w={},A={},f="",g="",b="",S=2,x=3,E=2,C=[],y=0,T=0,_;for(_=0;_<u.length;_+=1)if(f=u.charAt(_),Object.prototype.hasOwnProperty.call(w,f)||(w[f]=x++,A[f]=!0),g=b+f,Object.prototype.hasOwnProperty.call(w,g))b=g;else{if(Object.prototype.hasOwnProperty.call(A,b)){if(b.charCodeAt(0)<256){for(m=0;m<E;m++)y=y<<1,T==l-1?(T=0,C.push(c(y)),y=0):T++;for(d=b.charCodeAt(0),m=0;m<8;m++)y=y<<1|d&1,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=d>>1}else{for(d=1,m=0;m<E;m++)y=y<<1|d,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=0;for(d=b.charCodeAt(0),m=0;m<16;m++)y=y<<1|d&1,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=d>>1}S--,S==0&&(S=Math.pow(2,E),E++),delete A[b]}else for(d=w[b],m=0;m<E;m++)y=y<<1|d&1,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=d>>1;S--,S==0&&(S=Math.pow(2,E),E++),w[g]=x++,b=String(f)}if(b!==""){if(Object.prototype.hasOwnProperty.call(A,b)){if(b.charCodeAt(0)<256){for(m=0;m<E;m++)y=y<<1,T==l-1?(T=0,C.push(c(y)),y=0):T++;for(d=b.charCodeAt(0),m=0;m<8;m++)y=y<<1|d&1,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=d>>1}else{for(d=1,m=0;m<E;m++)y=y<<1|d,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=0;for(d=b.charCodeAt(0),m=0;m<16;m++)y=y<<1|d&1,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=d>>1}S--,S==0&&(S=Math.pow(2,E),E++),delete A[b]}else for(d=w[b],m=0;m<E;m++)y=y<<1|d&1,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=d>>1;S--,S==0&&(S=Math.pow(2,E),E++)}for(d=2,m=0;m<E;m++)y=y<<1|d&1,T==l-1?(T=0,C.push(c(y)),y=0):T++,d=d>>1;for(;;)if(y=y<<1,T==l-1){C.push(c(y));break}else T++;return C.join("")},decompress:function(u){return u==null?"":u==""?null:o._decompress(u.length,32768,function(l){return u.charCodeAt(l)})},_decompress:function(u,l,c){var m=[],d=4,w=4,A=3,f="",g=[],b,S,x,E,C,y,T,_={val:c(0),position:l,index:1};for(b=0;b<3;b+=1)m[b]=b;for(x=0,C=Math.pow(2,2),y=1;y!=C;)E=_.val&_.position,_.position>>=1,_.position==0&&(_.position=l,_.val=c(_.index++)),x|=(E>0?1:0)*y,y<<=1;switch(x){case 0:for(x=0,C=Math.pow(2,8),y=1;y!=C;)E=_.val&_.position,_.position>>=1,_.position==0&&(_.position=l,_.val=c(_.index++)),x|=(E>0?1:0)*y,y<<=1;T=r(x);break;case 1:for(x=0,C=Math.pow(2,16),y=1;y!=C;)E=_.val&_.position,_.position>>=1,_.position==0&&(_.position=l,_.val=c(_.index++)),x|=(E>0?1:0)*y,y<<=1;T=r(x);break;case 2:return""}for(m[3]=T,S=T,g.push(T);;){if(_.index>u)return"";for(x=0,C=Math.pow(2,A),y=1;y!=C;)E=_.val&_.position,_.position>>=1,_.position==0&&(_.position=l,_.val=c(_.index++)),x|=(E>0?1:0)*y,y<<=1;switch(T=x){case 0:for(x=0,C=Math.pow(2,8),y=1;y!=C;)E=_.val&_.position,_.position>>=1,_.position==0&&(_.position=l,_.val=c(_.index++)),x|=(E>0?1:0)*y,y<<=1;m[w++]=r(x),T=w-1,d--;break;case 1:for(x=0,C=Math.pow(2,16),y=1;y!=C;)E=_.val&_.position,_.position>>=1,_.position==0&&(_.position=l,_.val=c(_.index++)),x|=(E>0?1:0)*y,y<<=1;m[w++]=r(x),T=w-1,d--;break;case 2:return g.join("")}if(d==0&&(d=Math.pow(2,A),A++),m[T])f=m[T];else if(T===w)f=S+S.charAt(0);else return null;g.push(f),m[w++]=S+f.charAt(0),d--,S=f,d==0&&(d=Math.pow(2,A),A++)}}};return o}();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(Il);var Qb=Il.exports;const eA=Ml(Qb);function tA(t){if(!t)return Promise.resolve(new ArrayBuffer(0));try{const e="data:application/octet-binary;base64,"+t;return fetch(e).then(r=>r.arrayBuffer(),()=>new ArrayBuffer(0))}catch{return Promise.resolve(new ArrayBuffer(0))}}var Da=(t=>(t.UPLOAD_CRAWL="ads#CRAWL",t.GET_PM_EXTERNAL_CONFIG="ads#GET_EXTERNAL_CONFIGURATION",t.FETCH_HTTP_RESPONSE="ads#FETCH_HTTP_RESPONSE",t))(Da||{});function Ra(t){try{return JSON.parse(t)}catch{return}}async function rA(t){return(await Os.storage.local.get(t))[t]}async function Nl(t,e){const r={};r[t]=e,await Os.storage.local.set(r)}async function Dl(t,e,r){let n=await(r?null:rA(t));return n==null&&(n=await e(),await Nl(t,n)),n}function Rl(t){return t.split(".").slice(t.endsWith(".uk")||t.endsWith(".jp")?-3:-2).join(".")}async function Ll(t){const e=await Dl("configTs",Date.now),r=Date.now()-e>18e5;return Dl("config",async()=>{const n=await t({type:Da.GET_PM_EXTERNAL_CONFIG,payload:void 0}),s=Ra(n);if(s!=null)return s.TimeOffset=s.Now&&Date.now()-s.Now||0,nA(s),sA(s),aA(s),Nl("configTs",Date.now()),s},r)}function nA(t){var e;(e=t.AdRules)==null||e.filter(r=>{const n=eA.decompressFromUTF16(r.ParseTreeString||"")??"";return r.ParseTree=Ra(n),r.ParseTree==null?!1:(delete r.ParseTreeString,!0)})}function sA(t){var e;t.ParsedSiteConfigs=(e=t.SiteConfigs)==null?void 0:e.reduce((r,n)=>(r[n.d]=n.r,r),{}),delete t.SiteConfigs}function aA(t){var e;t.ParsedUrlBlackList=(e=t.UrlBlackList)==null?void 0:e.filter(r=>r.BlockAllAds).reduce((r,n)=>{var s;return(r[s=Rl(n.Hostname)]??(r[s]=[])).push(n.UrlRegex),r},{}),delete t.UrlBlackList}function $l(){return window.self===window.top}class iA{constructor(e){this.config=e}async inject(e){return new Promise((r,n)=>{const s=this.defineOnCspError(n),a=()=>{var i,o;try{document.addEventListener("securitypolicyviolation",s);const u=document.createElement(e),l=()=>{var d,w;this.config.keepInDom||u.remove(),(w=(d=this.config).onInjected)==null||w.call(d)},c=this.getManifestVersion();c===3?u.onload=l:setTimeout(l),this.setSrc(u,c),(i=this.config.logger)==null||i.log(u);const m=(o=document.documentElement)==null?void 0:o.firstElementChild;m==null||m.insertBefore(u,m.firstChild),document.removeEventListener("securitypolicyviolation",s),r()}catch(u){n(u)}finally{document.removeEventListener("DOMContentLoaded",a)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a()})}defineOnCspError(e){return r=>{e==null||e(Error("Blocked by CSP: "+JSON.stringify({host:window.location.hostname,blockedUri:r.blockedURI,violatedDirective:r.violatedDirective,originalPolicy:r.originalPolicy})))}}getManifestVersion(){return typeof __AD_FINDER_MANIFEST_VERSION__=="number"?__AD_FINDER_MANIFEST_VERSION__:Os.runtime.getManifest().manifest_version}setSrc(e,r){if(r===3){if(!this.config.mv3Path)throw Error("mv3Path config must be passed for Manifest V3 extensions");e.src=Os.runtime.getURL(this.config.mv3Path)}else if(r===2){if(!this.config.mv2Content)throw Error("mv2Content config must be passed for Manifest V2 extensions");e.innerHTML=this.config.mv2Content}else throw Error(`Unsupported manifest version ${r}`)}}class oA{constructor(e){this.config=e}sendMessage(e,r,n,s){const a={type:e,payload:r,nonce:s};window.postMessage(a,"*",n)}onMessage(e,r){window.addEventListener("message",async n=>{var s,a;const{type:i,payload:o,nonce:u}=n.data??{};if(i!==e)return;(s=this.config.logger)==null||s.debug("[ad-finder-custom-event] Recieved message:",{type:i,payload:o});const l=await r(o);if(l===void 0)return;const{response:c,transferables:m}=l;(a=this.config.logger)==null||a.debug("[ad-finder-custom-event] Sending response:",{name:i,payload:o,response:c}),this.sendMessage(i+this.config.responseSuffix,c,m,u)})}}const cA="ads#INIT",uA="ads#SEND_DATA",lA="ads#GET_INSTALL_ID",dA="ads#GET_EXTERNAL_CONFIG",hA="ads#FETCH_HTTP_RESPONSE",mo=class ri{constructor(e){ks(this,"injector"),ks(this,"messenger"),this.config=e,this.injector=new iA({logger:e.logger,keepInDom:e.keepPathmaticsInDom,mv2Content:Xb,mv3Path:e.mv3PathmaticsPath,onInjected:this.initPathmaticsScript.bind(this)}),this.messenger=new oA({logger:e.logger,responseSuffix:ri.MESSENGER_SUFFIX})}async isSupportedSite(){var e,r;const n=Rl(location.hostname);if(!$l())return!(location.hostname===ri.GOOGLE_AUTH_HOSTNAME||ri.SUBFRAME_DOMAIN_BLOCKLIST.has(n));const s=await Ll(this.config.sendMessageToBackground);return s!=null?!((r=(e=s.ParsedUrlBlackList)==null?void 0:e[n])!=null&&r.some(a=>new RegExp(a).test(location.href))):!1}async start(){var e,r,n,s,a,i;if(!document.documentElement){(e=this.config.logger)==null||e.log("Page is blank, stopping pathmatics",window.location.hostname);return}const o=await this.isSupportedSite();if((r=this.config.logger)==null||r.log("Is supported site?",o),!o){(n=this.config.logger)==null||n.log("Not supported site, stopping pathmatics",window.location.hostname);return}try{(s=this.config.logger)==null||s.log("Starting Pathmatics ad-finder...",{url:window.location.href}),this.setupMessageListeners(),await this.injector.inject("script"),(a=this.config.logger)==null||a.log("Pathmatics ad-finder injected!")}catch(u){(i=this.config.logger)==null||i.error("Failed to start Pathmatics ad-finder",u)}}setupMessageListeners(){if(Os.storage==null)throw Error("The storage permission is required for pathmatics' ad-finder");this.messenger.onMessage(hA,async e=>{const r=await this.config.sendMessageToBackground({type:Da.FETCH_HTTP_RESPONSE,payload:e}),n=await tA(r);return{response:n,transferables:[n]}}),$l()&&(this.messenger.onMessage(lA,async()=>({response:await this.config.getInstallId()})),this.messenger.onMessage(uA,async e=>{var r,n,s,a,i;const o=Ra(e);if(o==null)return;const u=o.crawlId;let l=o.zys??[];if(typeof l=="string"&&(l=Ra(l)),l==null)return;const c=Date.now();for(const m of l){const d={id:`${u}-${m.hash}`,type:"pathmatics",timestamp:c,details:m};(r=this.config.logger)==null||r.log("Ad detected",d);try{await((s=(n=this.config).onAdDetected)==null?void 0:s.call(n,d))}catch(w){(a=this.config.logger)==null||a.error("onAdDetected failed",{err:w})}}await this.config.sendMessageToBackground({type:Da.UPLOAD_CRAWL,payload:o}).catch((i=this.config.logger)==null?void 0:i.error)}),this.messenger.onMessage(dA,async()=>({response:await Ll(this.config.sendMessageToBackground)})))}initPathmaticsScript(){var e;(e=this.config.logger)==null||e.log("Initializing script");const r={enableLogs:this.config.enablePathmaticsLogs??!1};this.messenger.sendMessage(cA,r)}};ks(mo,"MESSENGER_SUFFIX","-response"),ks(mo,"SUBFRAME_DOMAIN_BLOCKLIST",new Set(["google.com","okta.com","amazon.com"])),ks(mo,"GOOGLE_AUTH_HOSTNAME","accounts.youtube.com");var fA={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(Pl,function(){var r=function(a,i){if(i=i||{},typeof a!="function")throw new s("fetch must be a function");if(typeof i!="object")throw new s("defaults must be an object");if(i.retries!==void 0&&!n(i.retries))throw new s("retries must be a positive integer");if(i.retryDelay!==void 0&&!n(i.retryDelay)&&typeof i.retryDelay!="function")throw new s("retryDelay must be a positive integer or a function returning a positive integer");if(i.retryOn!==void 0&&!Array.isArray(i.retryOn)&&typeof i.retryOn!="function")throw new s("retryOn property expects an array or function");var o={retries:3,retryDelay:1e3,retryOn:[]};return i=Object.assign(o,i),function(u,l){var c=i.retries,m=i.retryDelay,d=i.retryOn;if(l&&l.retries!==void 0)if(n(l.retries))c=l.retries;else throw new s("retries must be a positive integer");if(l&&l.retryDelay!==void 0)if(n(l.retryDelay)||typeof l.retryDelay=="function")m=l.retryDelay;else throw new s("retryDelay must be a positive integer or a function returning a positive integer");if(l&&l.retryOn)if(Array.isArray(l.retryOn)||typeof l.retryOn=="function")d=l.retryOn;else throw new s("retryOn property expects an array or function");return new Promise(function(w,A){var f=function(b){var S=typeof Request<"u"&&u instanceof Request?u.clone():u;a(S,l).then(function(x){if(Array.isArray(d)&&d.indexOf(x.status)===-1)w(x);else if(typeof d=="function")try{return Promise.resolve(d(b,null,x)).then(function(E){E?g(b,null,x):w(x)}).catch(A)}catch(E){A(E)}else b<c?g(b,null,x):w(x)}).catch(function(x){if(typeof d=="function")try{Promise.resolve(d(b,x,null)).then(function(E){E?g(b,x,null):A(x)}).catch(function(E){A(E)})}catch(E){A(E)}else b<c?g(b,x,null):A(x)})};function g(b,S,x){var E=typeof m=="function"?m(b,S,x):m;setTimeout(function(){f(++b)},E)}f(0)})}};function n(a){return Number.isInteger(a)&&a>=0}function s(a){this.name="ArgumentError",this.message=a}return r})})(fA);const mA={productSelector:['div[aria-label="Product"]'],sponsoredRegex:["/s\\s*p\\s*o\\s*n/i","/s\\s*p\\s*a\\s*a\\s*h/i","/s\\s*p\\s*a\\s*w\\s*h/i","/a\\s*d\\s*v\\s*e\\s*r\\s*t\\s*i\\s*s\\s*e\\s*r/i","/i\\s*s\\s*\\s*a\\s*n\\s*\\s*a\\s*d/i","/p\\s*a\\s*i\\s*d\\s*\\s*a\\s*d/i"],companyName:[".e-1f1gsmn",".e-1opt332",".e-lyu7du",".e-czl9lw"],searchTerm:["#search-bar-input"],productTitle:[".e-u2e78b",".e-1exr31r",".e-wrmemy",".e-pp216q",".e-1ptz7jy",".e-147kl2c",".e-9773mu",".e-xahufp"],productSize:[".e-owckh2",".e-1hb8rq9",".e-1188c9v",".e-zjik7",".e-an4oxa",".e-cauxk8"],productPrice:[".e-1jioxed > span.screen-reader-only",".e-2feaft > span.screen-reader-only",".e-1ybpdrh > span.screen-reader-only",".e-1ghw7u1 > span.screen-reader-only",".e-hlbpyw > span.screen-reader-only",".e-1jioxed > span.screen-reader-only",".e-vzof3s > span.screen-reader-only",".e-3tcizb > span.screen-reader-only",".e-t5lw1y > span.e-13d1dsr",".e-1s70q1o"]};function gA(t){var e=pA(wA(bA(yA(t),8*t.length)));return e.toLowerCase()}function pA(t){for(var e,r="0123456789ABCDEF",n="",s=0;s<t.length;s++)e=t.charCodeAt(s),n+=r.charAt(e>>>4&15)+r.charAt(15&e);return n}function yA(t){for(var e=Array(t.length>>2),r=0;r<e.length;r++)e[r]=0;for(r=0;r<8*t.length;r+=8)e[r>>5]|=(255&t.charCodeAt(r/8))<<r%32;return e}function wA(t){for(var e="",r=0;r<32*t.length;r+=8)e+=String.fromCharCode(t[r>>5]>>>r%32&255);return e}function bA(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var r=1732584193,n=-271733879,s=-1732584194,a=271733878,i=0;i<t.length;i+=16){var o=r,u=n,l=s,c=a;n=st(n=st(n=st(n=st(n=nt(n=nt(n=nt(n=nt(n=rt(n=rt(n=rt(n=rt(n=tt(n=tt(n=tt(n=tt(n,s=tt(s,a=tt(a,r=tt(r,n,s,a,t[i+0],7,-680876936),n,s,t[i+1],12,-389564586),r,n,t[i+2],17,606105819),a,r,t[i+3],22,-1044525330),s=tt(s,a=tt(a,r=tt(r,n,s,a,t[i+4],7,-176418897),n,s,t[i+5],12,1200080426),r,n,t[i+6],17,-1473231341),a,r,t[i+7],22,-45705983),s=tt(s,a=tt(a,r=tt(r,n,s,a,t[i+8],7,1770035416),n,s,t[i+9],12,-1958414417),r,n,t[i+10],17,-42063),a,r,t[i+11],22,-1990404162),s=tt(s,a=tt(a,r=tt(r,n,s,a,t[i+12],7,1804603682),n,s,t[i+13],12,-40341101),r,n,t[i+14],17,-1502002290),a,r,t[i+15],22,1236535329),s=rt(s,a=rt(a,r=rt(r,n,s,a,t[i+1],5,-165796510),n,s,t[i+6],9,-1069501632),r,n,t[i+11],14,643717713),a,r,t[i+0],20,-373897302),s=rt(s,a=rt(a,r=rt(r,n,s,a,t[i+5],5,-701558691),n,s,t[i+10],9,38016083),r,n,t[i+15],14,-660478335),a,r,t[i+4],20,-405537848),s=rt(s,a=rt(a,r=rt(r,n,s,a,t[i+9],5,568446438),n,s,t[i+14],9,-1019803690),r,n,t[i+3],14,-187363961),a,r,t[i+8],20,1163531501),s=rt(s,a=rt(a,r=rt(r,n,s,a,t[i+13],5,-1444681467),n,s,t[i+2],9,-51403784),r,n,t[i+7],14,1735328473),a,r,t[i+12],20,-1926607734),s=nt(s,a=nt(a,r=nt(r,n,s,a,t[i+5],4,-378558),n,s,t[i+8],11,-2022574463),r,n,t[i+11],16,1839030562),a,r,t[i+14],23,-35309556),s=nt(s,a=nt(a,r=nt(r,n,s,a,t[i+1],4,-1530992060),n,s,t[i+4],11,1272893353),r,n,t[i+7],16,-155497632),a,r,t[i+10],23,-1094730640),s=nt(s,a=nt(a,r=nt(r,n,s,a,t[i+13],4,681279174),n,s,t[i+0],11,-358537222),r,n,t[i+3],16,-722521979),a,r,t[i+6],23,76029189),s=nt(s,a=nt(a,r=nt(r,n,s,a,t[i+9],4,-640364487),n,s,t[i+12],11,-421815835),r,n,t[i+15],16,530742520),a,r,t[i+2],23,-995338651),s=st(s,a=st(a,r=st(r,n,s,a,t[i+0],6,-198630844),n,s,t[i+7],10,1126891415),r,n,t[i+14],15,-1416354905),a,r,t[i+5],21,-57434055),s=st(s,a=st(a,r=st(r,n,s,a,t[i+12],6,1700485571),n,s,t[i+3],10,-1894986606),r,n,t[i+10],15,-1051523),a,r,t[i+1],21,-2054922799),s=st(s,a=st(a,r=st(r,n,s,a,t[i+8],6,1873313359),n,s,t[i+15],10,-30611744),r,n,t[i+6],15,-1560198380),a,r,t[i+13],21,1309151649),s=st(s,a=st(a,r=st(r,n,s,a,t[i+4],6,-145523070),n,s,t[i+11],10,-1120210379),r,n,t[i+2],15,718787259),a,r,t[i+9],21,-343485551),r=xr(r,o),n=xr(n,u),s=xr(s,l),a=xr(a,c)}return Array(r,n,s,a)}function La(t,e,r,n,s,a){return xr(AA(xr(xr(e,t),xr(n,a)),s),r)}function tt(t,e,r,n,s,a,i){return La(e&r|~e&n,t,e,s,a,i)}function rt(t,e,r,n,s,a,i){return La(e&n|r&~n,t,e,s,a,i)}function nt(t,e,r,n,s,a,i){return La(e^r^n,t,e,s,a,i)}function st(t,e,r,n,s,a,i){return La(r^(e|~n),t,e,s,a,i)}function xr(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function AA(t,e){return t<<e|t>>>32-e}const go=1e3;function Fl(t){return Array.from({length:t},()=>Math.random().toString(36).charAt(2)).join("")}async function vA(t){var l;const e=t.promptConfig;if(!await t.enabled())return;const n=localStorage.getItem(e.storageKey),s=n?JSON.parse(n):{conversations:{}};let a=Fl(16),i=0;const o=()=>{const c=window.location.href;if(!c.includes(t.chatGptUrl))return;let m=_A(document.body,c,t,a);m.length<i&&(a=Fl(16)),i=m.length,m=m.filter(d=>{var A;const w=d.conversation_id;return!((A=s.conversations[w])!=null&&A.includes(d.text))&&!e.forbiddenWords.some(f=>d.text.includes(" "+f))}),xA(t,m),m.forEach(d=>{const w=d.conversation_id;s.conversations[w]||(s.conversations[w]=[]),s.conversations[w].push(d.text)}),localStorage.setItem(e.storageKey,JSON.stringify(s))};setTimeout(o,e.loadDelay??3*go);const u=setInterval(o,e.pollInterval??10*go);(l=e.signal)==null||l.addEventListener("abort",()=>clearInterval(u))}function _A(t,e,r,n){const a=t.querySelectorAll('div[data-message-author-role="user"]'),i=e.includes(r.conversationUrl)?e:n,o=gA(i),u=e.split("/c/"),c=`a[href="/c/${u.length>1?u[1]:""}"]`,m=t.querySelector(c);if(!a)return[];const d=Math.round(Date.now()/go);let w=Array.from(a).map((A,f)=>{var g,b;return{timestamp:d,service:"chatgpt.com",type:"web",conversation_id:o,conversation_summary:((g=m==null?void 0:m.textContent)==null?void 0:g.trim())||"",conversation_order:f+1,text:((b=A.textContent)==null?void 0:b.trim())||""}});return w=w.filter(A=>A.text.length>0),w}async function xA(t,e){if(e.length===0||!await t.enabled())return;const n={appId:t.appId,prompts:e};await t.api.uploadPrompts(n)}async function TA(t){if(!await t.enabled())return;const r=window.location.href;if(!(r==t.chatGptUrl||r.includes(t.conversationUrl)))return;const n=t.statusConfig,s=localStorage.getItem(n.storageKey),a=await SA(document.body,n);a!=s&&(await t.api.uploadSubscriptionStatus({appId:t.appId,installId:t.installId,service:"chatgpt.com",status:a}),localStorage.setItem(n.storageKey,a))}async function SA(t,e){var r;try{await new Promise(a=>setTimeout(a,1e3));let n=null;for(const a of e.textContainerSelectors)if(n=t.querySelector(a),n!=null)break;if(n==null)return"unknown";const s=(r=n.textContent)==null?void 0:r.trim();return s==null||s===""?"unknown":e.premiumUserStrings.some(a=>s.includes(a))?"premium":e.freeUserStrings.some(a=>s.includes(a))?"free":"unknown"}catch{return"unknown"}}const EA=["drug","alcohol","porn"],kA="https://chatgpt.com/",OA="https://chatgpt.com/c/",PA=["nav > .flex-col > a > span > div > div > span:nth-child(1)","nav > .flex-col > a > span > div > div"],MA=["Add Team workspace","Invite members","View plans"],CA=["Upgrade plan","Renew Plus","The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."];async function IA(t){const e=vA(t),r=TA(t);await Promise.all([e,r])}2*he.Hour;const NA="https://stayfocusd.st-panel-api.com/v1/remote_config/stayfocusd",DA="https://stayfocusd.st-panel-api.com/v1/remote_config/shared-web-config",RA={uploadWebUsage:!0,bugsnagIngoreMatches:["Extension context invalidated.","Could not establish connection. Receiving end does not exist.","The browser is shutting down.",'{\\s*"?isTrusted"?:\\s*true\\s*}',"Failed to execute 'abort' on 'IDBTransaction': The transaction has finished.","Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.","^IO error: \\.\\.\\.\\/.+?: .*? \\(ChromeMethodBFE: .*\\)$","Cannot access contents of the page. Extension manifest must request permission to access the respective host.","The extensions gallery cannot be scripted."],instacartSelectors:mA,forbiddenPromptWords:EA,chatGptUrl:kA,chatGptConversationUrl:OA,chatGptStatusSelectors:PA,chatGptPremiumStrings:MA,chatGptFreeStrings:CA,adNetworks:Xy,adFields:Jy};X.object({uploadWebUsage:X.boolean(),bugsnagIngoreMatches:X.array(X.string()),pageViewIgnoreList:X.array(X.string()).optional(),instacartSelectors:X.object({productSelector:X.array(X.string()),sponsoredRegex:X.array(X.string()),companyName:X.array(X.string()),searchTerm:X.array(X.string()),productTitle:X.array(X.string()),productSize:X.array(X.string()),productPrice:X.array(X.string())}),forbiddenPromptWords:X.array(X.string()),chatGptUrl:X.string(),chatGptConversationUrl:X.string(),chatGptStatusSelectors:X.array(X.string()),chatGptPremiumStrings:X.array(X.string()),chatGptFreeStrings:X.array(X.string()),adNetworks:X.array(X.object({name:X.string(),regexes:X.array(X.string())})),adFields:X.object({source:X.array(X.string()),campaign:X.array(X.string()),medium:X.array(X.string()),term:X.array(X.string())})});const po=LA({urls:[NA,DA],defaultConfig:RA});function LA(t){const{urls:e,defaultConfig:r}=t,n=Zb({urls:e,defaultConfig:r,persistConfig:s=>Sl.setValue(s),persistLastFetchedTime:s=>El.setValue(s),restoreConfig:async()=>await Sl.getValue()??void 0,restoreLastFetchedTime:async()=>await El.getValue()??void 0});return{fetchLatest:n.fetchLatest,addChangeListener:n.addChangeListener,getLastFetchedTime(){return n.lastFetchedTime},getRestoredPromise(){return n.restoredPromise},getValue(){return n.value}}}function jl(){async function t(){if(await jb.getValue())return!1;const o=await Ub.getValue();return o&&o<18}async function e(){return await Wb.getValue()??0}async function r(){return await Bb.getValue()??0}async function n(){return await xl.getValue()??!1}async function s(){const i=await Tl.getValue(),o=po.getValue().uploadWebUsage;return(i??!1)&&o}async function a(){if(await t()||await Vb.getValue())return!0;if(!await xl.getValue())return!1;const l=await Tl.getValue(),c=await e(),m=await r();return!!l||Date.now()<c||m>3}return{isOnboardingCompleted:a,hasAcceptedToS:n,canUploadData:s}}function bv(t){return t}function Av(t){return t}const $A={matches:["*://*/*"],async main(t){ni("Loaded promp-collector.cs.ts"),await po.getRestoredPromise();const e=po.getValue();IA({api:Td(),appId:"laankejkbhbdhmipfmgcngdelahlfoji",installId:await Yn(),chatGptUrl:e.chatGptUrl,conversationUrl:e.chatGptConversationUrl,promptConfig:{forbiddenWords:e.forbiddenPromptWords,storageKey:"@stayfree/prompt-collector",signal:t.signal},statusConfig:{storageKey:"@stayfree/chatgpt-status",textContainerSelectors:e.chatGptStatusSelectors,premiumUserStrings:e.chatGptPremiumStrings,freeUserStrings:e.chatGptFreeStrings},enabled:async()=>await jl().hasAcceptedToS()})}};function $a(t,...e){}const FA={debug:(...t)=>$a(console.debug,...t),log:(...t)=>$a(console.log,...t),warn:(...t)=>$a(console.warn,...t),error:(...t)=>$a(console.error,...t)},ja=class ja extends Event{constructor(e,r){super(ja.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=r}};ce(ja,"EVENT_NAME",wo("wxt:locationchange"));let yo=ja;function wo(t){var e;return`${(e=Zn==null?void 0:Zn.runtime)==null?void 0:e.id}:prompt-collector:${t}`}function jA(t){let e,r;return{run(){e==null&&(r=new URL(location.href),e=t.setInterval(()=>{let n=new URL(location.href);n.href!==r.href&&(window.dispatchEvent(new yo(n,r)),r=n)},1e3))}}}const Ms=class Ms{constructor(e,r){ce(this,"isTopFrame",window.self===window.top);ce(this,"abortController");ce(this,"locationWatcher",jA(this));ce(this,"receivedMessageIds",new Set);this.contentScriptName=e,this.options=r,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return Zn.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,r){const n=setInterval(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(e,r){const n=setTimeout(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(e){const r=requestAnimationFrame((...n)=>{this.isValid&&e(...n)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(e,r){const n=requestIdleCallback((...s)=>{this.signal.aborted||e(...s)},r);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(e,r,n,s){var a;r==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(a=e.addEventListener)==null||a.call(e,r.startsWith("wxt:")?wo(r):r,n,{...s,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),FA.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:Ms.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){var a,i,o;const r=((a=e.data)==null?void 0:a.type)===Ms.SCRIPT_STARTED_MESSAGE_TYPE,n=((i=e.data)==null?void 0:i.contentScriptName)===this.contentScriptName,s=!this.receivedMessageIds.has((o=e.data)==null?void 0:o.messageId);return r&&n&&s}listenForNewerScripts(e){let r=!0;const n=s=>{if(this.verifyScriptStartedEvent(s)){this.receivedMessageIds.add(s.data.messageId);const a=r;if(r=!1,a&&(e!=null&&e.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}};ce(Ms,"SCRIPT_STARTED_MESSAGE_TYPE",wo("wxt:content-script-started"));let bo=Ms;const UA=Symbol("null");let VA=0;class WA extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[e]=arguments;if(e!=null){if(typeof e[Symbol.iterator]!="function")throw new TypeError(typeof e+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[r,n]of e)this.set(r,n)}}_getPublicKeys(e,r=!1){if(!Array.isArray(e))throw new TypeError("The keys parameter must be an array");const n=this._getPrivateKey(e,r);let s;return n&&this._publicKeys.has(n)?s=this._publicKeys.get(n):r&&(s=[...e],this._publicKeys.set(n,s)),{privateKey:n,publicKey:s}}_getPrivateKey(e,r=!1){const n=[];for(let s of e){s===null&&(s=UA);const a=typeof s=="object"||typeof s=="function"?"_objectHashes":typeof s=="symbol"?"_symbolHashes":!1;if(!a)n.push(s);else if(this[a].has(s))n.push(this[a].get(s));else if(r){const i=`@@mkm-ref-${VA++}@@`;this[a].set(s,i),n.push(i)}else return!1}return JSON.stringify(n)}set(e,r){const{publicKey:n}=this._getPublicKeys(e,!0);return super.set(n,r)}get(e){const{publicKey:r}=this._getPublicKeys(e);return super.get(r)}has(e){const{publicKey:r}=this._getPublicKeys(e);return super.has(r)}delete(e){const{publicKey:r,privateKey:n}=this._getPublicKeys(e);return!!(r&&super.delete(r)&&this._publicKeys.delete(n))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}new WA;const Ul="@wxt-dev/analytics";function BA(t){var e;if(typeof chrome>"u"||!((e=chrome==null?void 0:chrome.runtime)!=null&&e.id))throw Error("Cannot use WXT analytics in contexts without access to the browser.runtime APIs");return t==null&&console.warn("[@wxt-dev/analytics] Config not provided to createAnalytics. If you're using WXT, add the 'analytics' property to '<srcDir>/app.config.ts'."),location.pathname==="/background.js"?qA(t):HA()}function qA(t){var w;const e=(t==null?void 0:t.userId)??Ao("wxt-analytics:user-id"),r=(t==null?void 0:t.userProperties)??Ao("wxt-analytics:user-properties",{}),n=(t==null?void 0:t.enabled)??Ao("local:wxt-analytics:enabled",!1),s=chrome.runtime.getPlatformInfo(),a=al.UAParser();let i=Promise.resolve(e.getValue()).then(A=>A??globalThis.crypto.randomUUID()),o=r.getValue();const u=chrome.runtime.getManifest(),l=()=>({timestamp:Date.now(),sessionId:void 0,language:navigator.language,referrer:void 0,screen:void 0,url:location.href,title:void 0}),c=async A=>{const f=await s;return{meta:A,user:{id:await i,properties:{version:(t==null?void 0:t.version)??u.version_name??u.version,wxtMode:"production",wxtBrowser:"chrome",arch:f.arch,os:f.os,browser:a.browser.name,browserVersion:a.browser.version,...await o}}}},m={identify:async(A,f={},g=l())=>{var S,x;i=Promise.resolve(A),o=Promise.resolve(f),await Promise.all([(S=e.setValue)==null?void 0:S.call(e,A),(x=r.setValue)==null?void 0:x.call(r,f)]);const b=await c(g);t!=null&&t.debug&&console.debug("[@wxt-dev/analytics] identify",b),await n.getValue()?await Promise.allSettled(d.map(E=>E.identify(b))):t!=null&&t.debug&&console.debug("[@wxt-dev/analytics] Analytics disabled, identify() not uploaded")},page:async(A,f=l())=>{var S,x;const b={...await c(f),page:{url:(f==null?void 0:f.url)??((S=globalThis.location)==null?void 0:S.href),location:A,title:(f==null?void 0:f.title)??((x=globalThis.document)==null?void 0:x.title)}};t!=null&&t.debug&&console.debug("[@wxt-dev/analytics] page",b),await n.getValue()?await Promise.allSettled(d.map(E=>E.page(b))):t!=null&&t.debug&&console.debug("[@wxt-dev/analytics] Analytics disabled, page() not uploaded")},track:async(A,f,g=l())=>{const S={...await c(g),event:{name:A,properties:f}};t!=null&&t.debug&&console.debug("[@wxt-dev/analytics] track",S),await n.getValue()?await Promise.allSettled(d.map(x=>x.track(S))):t!=null&&t.debug&&console.debug("[@wxt-dev/analytics] Analytics disabled, track() not uploaded")},setEnabled:async A=>{var f;await((f=n.setValue)==null?void 0:f.call(n,A))},autoTrack:()=>()=>{}},d=((w=t==null?void 0:t.providers)==null?void 0:w.map(A=>A(m,t)))??[];return chrome.runtime.onConnect.addListener(A=>{A.name===Ul&&A.onMessage.addListener(({fn:f,args:g})=>{var b;(b=m[f])==null||b.call(m,...g)})}),m}function HA(){const t=chrome.runtime.connect({name:Ul}),e=Date.now(),r=()=>{var a;return{sessionId:e,timestamp:Date.now(),language:navigator.language,referrer:((a=globalThis.document)==null?void 0:a.referrer)||void 0,screen:globalThis.window?`${globalThis.window.screen.width}x${globalThis.window.screen.height}`:void 0,url:location.href,title:document.title||void 0}},n=a=>(...i)=>{t.postMessage({fn:a,args:[...i,r()]})},s={identify:n("identify"),page:n("page"),track:n("track"),setEnabled:n("setEnabled"),autoTrack:a=>{const i=o=>{var l,c;const u=o.target;!u||!GA.has(u.tagName)&&!YA.has(u.getAttribute("role"))||s.track("click",{tagName:(l=u.tagName)==null?void 0:l.toLowerCase(),id:u.id||void 0,className:u.className||void 0,textContent:((c=u.textContent)==null?void 0:c.substring(0,50))||void 0,href:u.href})};return a.addEventListener("click",i,{capture:!0,passive:!0}),()=>{a.removeEventListener("click",i)}}};return s}function Ao(t,e){return{getValue:async()=>(await chrome.storage.local.get(t))[t]??e,setValue:r=>chrome.storage.local.set({[t]:r})}}const GA=new Set(["A","BUTTON","INPUT","SELECT","TEXTAREA"]),YA=new Set(["button","link","checkbox","menuitem","tab","radio"]);function ZA(t){return e=>(r,n)=>t(r,n,e)}const zA=100,KA=ZA((t,e,r)=>{const n=async(s,a,i)=>{const o=new URL(e!=null&&e.debug?"/debug/mp/collect":"/mp/collect","https://www.google-analytics.com");r.apiSecret&&o.searchParams.set("api_secret",r.apiSecret),r.measurementId&&o.searchParams.set("measurement_id",r.measurementId);const u={language:s.meta.language,screen:s.meta.screen,...s.user.properties},l=Object.fromEntries(Object.entries(u).map(([c,m])=>[c,m==null?void 0:{value:m}]));await fetch(o.href,{method:"POST",body:JSON.stringify({client_id:s.user.id,consent:{ad_user_data:"DENIED",ad_personalization:"DENIED"},user_properties:l,events:[{name:a,params:{session_id:s.meta.sessionId,engagement_time_msec:zA,...i}}]})})};return{identify:()=>Promise.resolve(),page:s=>n(s,"page_view",{page_title:s.page.title,page_location:s.page.location}),track:s=>n(s,s.event.name,s.event.properties)}}),XA={analytics:{providers:[KA({measurementId:"G-RD9W7TJ9TZ",apiSecret:"XaR9YDEpQc6GG_m2eeA5Jw"})],userId:{getValue:Yn,setValue:()=>{}},enabled:{getValue:async()=>{const{canUploadData:t}=jl();return await t()},setValue:()=>{}}}};function JA(){return XA}BA(JA().analytics);function vv(){}function Fa(t,...e){}const QA={debug:(...t)=>Fa(console.debug,...t),log:(...t)=>Fa(console.log,...t),warn:(...t)=>Fa(console.warn,...t),error:(...t)=>Fa(console.error,...t)};return(async()=>{try{const{main:t,...e}=$A,r=new bo("prompt-collector",e);return await t(r)}catch(t){throw QA.error('The content script "prompt-collector" crashed on startup!',t),t}})()}();
promptCollector;
