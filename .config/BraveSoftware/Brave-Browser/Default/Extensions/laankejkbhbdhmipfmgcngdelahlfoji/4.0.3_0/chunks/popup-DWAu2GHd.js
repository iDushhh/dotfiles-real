import{v as W,b as z,c as J,V as X,a as Y}from"./tailwind-Be1c9XZh.js";import{an as d,aE as c,av as s,ac as w,ad as t,b as V,ay as r,G as l,aG as $,L as Z,ah as k,au as T,ao as D,ax as tt,aK as et,ak as A,al as G,aL as E,aM as q,ar as st,aN as Q,aw as x,aA as nt,aO as j,C as S,aP as ot,aQ as at,aR as rt,aS as it,aT as B,c as lt,aU as ut,d as ct,aV as pt,aW as mt,aX as dt,D as ft,aY as _t,F as gt,T as bt,h as vt,aZ as ht,aq as L,r as yt,aH as H,aI as kt,aJ as $t}from"./_virtual_wxt-plugins-DZjI-rY3.js";import{_ as wt,a as Tt,b as Pt}from"./ActiveToggle.vue_vue_type_script_setup_true_lang-DXeA1k-m.js";import{g as C}from"./extension-url-B8Q1y1nE.js";import{u as St}from"./useMutation-RL6hm5Ow.js";import{p as Ct}from"./immer-CwDZyRGJ.js";import{u as Ot}from"./useAddAllowedPatternMutation-BUZQGU94.js";import{_ as At}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Gt,_ as xt}from"./Logo.vue_vue_type_script_setup_true_lang-BFRi7uGo.js";import"./birth-year-prompt-utils-BLD6wE-E.js";const Bt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ut(u,e){return c(),d("svg",Bt,e[0]||(e[0]=[s("path",{fill:"currentColor",d:"M14 3v2h3.59l-9.83 9.83l1.41 1.41L19 6.41V10h2V3m-2 16H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7h-2z"},null,-1)]))}const Rt={name:"mdi-open-in-new",render:Ut},Lt={class:"p-4 flex gap-0 justify-between text-sm"},Mt=["href"],Ft=["src"],It=["href"],Nt=["href"],Vt=["href"],Dt=["href"],Et=w({__name:"PopupFooter",setup(u){return(e,n)=>(c(),d("div",Lt,[s("a",{class:"flex items-center gap-2 link link-hover",href:("getOptionsPage"in e?e.getOptionsPage:t(C))("nuclear"),target:"_blank"},[s("img",{src:("browser"in e?e.browser:t(V)).runtime.getURL("/icon-nuclear-16.png")},null,8,Ft),s("span",null,r(("t"in e?e.t:t(l))("nuclearMode")),1)],8,Mt),n[1]||(n[1]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"link link-hover",href:("getOptionsPage"in e?e.getOptionsPage:t(C))(),target:"_blank"},[s("span",null,r(("t"in e?e.t:t(l))("dashboard")),1)],8,It),n[2]||(n[2]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"link link-hover",href:("getOptionsPage"in e?e.getOptionsPage:t(C))("settings"),target:"_blank"},[s("span",null,r(("t"in e?e.t:t(l))("settings")),1)],8,Nt),n[3]||(n[3]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"link link-hover",href:("getOptionsPage"in e?e.getOptionsPage:t(C))("help"),target:"_blank"},[s("span",null,r(("t"in e?e.t:t(l))("helpFaq")),1)],8,Vt),n[4]||(n[4]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"flex gap-2 items-center link link-hover link-accent text-sm",href:("Links"in e?e.Links:t(Z)).Discord,target:"_blank"},[n[0]||(n[0]=s("span",null,"Discord",-1)),$(t(Rt))],8,Dt)]))}}),qt={class:"font-bold uppercase"},Qt=w({__name:"MutationTimerResult",props:{mutationResult:{}},setup(u){const e=u,n=k(()=>{if(e.mutationResult){if(e.mutationResult.status=="success")return l("success");if(e.mutationResult.status=="failed")return l("failed")}});return(i,f)=>i.mutationResult?(c(),d("p",{key:0,class:D(["text-sm",{"text-success":i.mutationResult.status=="success","text-error":i.mutationResult.status==="failed"}])},[s("span",qt,r(t(n)),1),tt(" "+r(i.mutationResult.message),1)],2)):T("",!0)}}),jt={class:"flex flex-row"},Ht={for:"groups-source",class:"lg:block m-auto text-base-content/80"},Kt=["value"],Wt=w({__name:"BlockedGroupsSelector",emits:["selectGroup"],setup(u,{emit:e}){const n=e,{groups:i}=et(),f=A("");G(i,()=>{i.value&&(f.value=i.value.find(p=>p.customLimitName==E).id)});function _(){n("selectGroup",f.value)}return(p,g)=>(c(),d("div",jt,[s("label",Ht,[s("small",null,r(("t"in p?p.t:t(l))("group"))+":",1)]),q(s("select",st({id:"groups-source",class:"select select-sm select-primary select-bordered ml-3 w-full"},t(i),{"onUpdate:modelValue":g[0]||(g[0]=o=>Q(f)?f.value=o:null),onChange:_}),[(c(!0),d(x,null,nt(t(i),o=>(c(),d("option",{key:o.id,value:o.id},r(o.customLimitName),9,Kt))),128))],16),[[W,t(f)]])]))}});function zt(){const u=j();return St({mutationFn:async({timer:e,pattern:n})=>{const i=await u.timers.getAllTimersByType(S.Group),f=ot(i),_=at(rt(n)),p=it(f,[_]);if(p.result){const g=Ct(e,o=>{var b;(b=o.blocklist)==null||b.push(_)});return await u.timers.upsertTimer(g),{status:"success"}}else return{status:"failed",message:p.message}}})}function M(){const{state:u}=B(lt),e=k(()=>u.value?ut(u.value):"-");return{currentUrl:u,hostname:e}}function Jt(){const{state:u}=B(ct);return k(()=>{const n=Object.values(u.value).find(i=>i.name==E);if(n)return n.id})}const Xt={class:"collapse collapse-arrow rounded-none"},Yt={class:"collapse-title text-sm min-h-8 p-3 ml-1"},Zt={class:"collapse-content flex flex-col gap-4"},te={class:"flex gap-4"},ee={class:"flex gap-4"},se={class:"text-sm"},ne={class:"flex gap-4"},oe=w({__name:"PopupBlockForm",setup(u){const{data:e}=pt(),{state:n}=B(mt),{mutate:i,isSuccess:f,data:_}=zt();function p(a){var O;const m=(O=e.value)==null?void 0:O.find(y=>y.timer.id==U.value);if(!a||!m)return;const R=m.timer;i({pattern:a,timer:R})}const{mutate:g,isSuccess:o,data:b}=Ot();function h(a){a&&g({pattern:a})}G(o,a=>{a&&(P.value=b.value)}),G(f,a=>{a&&(P.value=_.value)});const v=A(""),P=A(),{currentUrl:F,hostname:I}=M(),N=Jt(),U=A("");G(N,()=>U.value=N.value??"");function K(a){U.value=a}return(a,m)=>{const R=Wt,O=Qt;return c(),d("details",Xt,[s("summary",Yt,r(("t"in a?a.t:t(l))("popup_advancedBlockingOptions")),1),s("div",Zt,[$(R,{onSelectGroup:K}),$(O,{"mutation-result":t(P)},null,8,["mutation-result"]),s("div",te,[s("button",{type:"button",class:"flex-1 btn btn-sm btn-error",onClick:m[0]||(m[0]=y=>p(t(I)))},r(("t"in a?a.t:t(l))("popup_blockEntireSite")),1),t(n)?T("",!0):(c(),d("button",{key:0,type:"button",class:"flex-1 btn btn-sm btn-success",onClick:m[1]||(m[1]=y=>h(t(I)))},r(("t"in a?a.t:t(l))("popup_allowEntireSite")),1))]),s("div",ee,[s("button",{type:"button",class:"flex-1 btn btn-sm btn-error",onClick:m[2]||(m[2]=y=>p(t(F)))},r(("t"in a?a.t:t(l))("popup_blockUrl")),1),t(n)?T("",!0):(c(),d("button",{key:0,type:"button",class:"flex-1 btn btn-sm btn-success",onClick:m[3]||(m[3]=y=>h(t(F)))},r(("t"in a?a.t:t(l))("popup_allowUrl")),1))]),s("p",se,r(("t"in a?a.t:t(l))("popup_enterCustomUrl")),1),q(s("input",{class:"input input-sm input-bordered focus:input-primary",type:"text",placeholder:"URL","onUpdate:modelValue":m[4]||(m[4]=y=>Q(v)?v.value=y:null)},null,512),[[z,t(v)]]),s("div",ne,[s("button",{type:"button",class:"flex-1 btn btn-sm btn-error",onClick:m[5]||(m[5]=y=>p(t(v)))},r(("t"in a?a.t:t(l))("popup_blockCustomUrl")),1),t(n)?T("",!0):(c(),d("button",{key:0,type:"button",class:"flex-1 btn btn-sm btn-success",onClick:m[6]||(m[6]=y=>h(t(v)))},r(("t"in a?a.t:t(l))("popup_allowCustomUrl")),1))])])])}}}),ae=At(oe,[["__scopeId","data-v-49cc260a"]]);function re(){const u=j(),{currentUrl:e}=M();return dt({queryKey:[_t.GetPopupTimer],queryFn:()=>e.value?u.timers.getPopupTimer(e.value):null,refetchInterval:ft.SECOND.ms,refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0})}const ie={class:"uppercase text-xs opacity-70 whitespace-nowrap"},le={class:"text-xl font-bold"},ue={key:1,class:"text-xl font-bold"},ce={class:"uppercase text-xs opacity-70 whitespace-nowrap"},pe={class:"flex items-baseline gap-2 justify-end","data-testid":"display-timer"},me={class:"text-2xl font-bold"},de=w({__name:"CurrentTimer",setup(u){const{data:e}=re(),n=k(()=>{var o;return(o=e.value)==null?void 0:o.timer.type}),i=k(()=>n.value==S.Group),f=k(()=>{var o;return(o=e.value)==null?void 0:o.timer.name}),_=k(()=>{var o;return((o=e.value)==null?void 0:o.timer.type)==S.Nuclear}),p=k(()=>{switch(n.value){case S.Group:return l("group");case S.Nuclear:return l("nuclear");case S.BlockAll:return l("blockAll")}}),g=k(()=>{if(e.value){const o=e.value.timeLeftMs,b=gt(o<bt.Second?0:o);return`${b.hours==0?"":`${b.hours}:`}${b.minutes}:${b.seconds}`}});return(o,b)=>{var h,v,P;return t(e)?(c(),d("div",{key:0,class:D(["rounded self-center px-3 py-2 text-right min-w-32",{"bg-success text-white":!t(_)&&((h=t(e))==null?void 0:h.relation)==="allowed","bg-error text-white":!t(_)&&((v=t(e))==null?void 0:v.relation)==="blocked","bg-nuclear text-nuclear":t(_),"bg-neutral text-primary":!t(_)&&((P=t(e))==null?void 0:P.relation)==null}])},[s("div",null,[t(i)?(c(),d(x,{key:0},[s("p",ie,r(("t"in o?o.t:t(l))("group")),1),s("p",le,r(t(f)),1)],64)):(c(),d("p",ue,r(t(p)),1))]),s("p",ce,r(("t"in o?o.t:t(l))("timeRemaining")),1),s("div",pe,[s("p",me,r(t(g)),1)])],2)):T("",!0)}}}),fe={class:"flex gap-4 px-4 py-2 min-w-[100%]"},_e={class:"flex-1 flex flex-col"},ge={class:"text-sm opacity-50","data-testid":"currently-on"},be={class:"text-lg font-bold truncate"},ve={class:"text-sm truncate"},he=w({__name:"PopupActivated",setup(u){const{currentUrl:e,hostname:n}=M();return(i,f)=>{const _=de,p=ae,g=Et;return c(),d(x,null,[s("section",fe,[s("div",_e,[s("p",ge,r(("t"in i?i.t:t(l))("youAreCurrentlyOn")),1),s("p",be,r(t(n)),1),s("p",ve,r(t(e)),1)]),$(_)]),$(p),$(g)],64)}}}),ye={class:"flex flex-col gap-4 justify-center p-5 px-8 bg-base-100"},ke={class:"text-lg font-bold"},$e={class:"text-base"},we=w({__name:"ActionRequired",setup(u){function e(){V.tabs.create({url:C(),active:!0})}return(n,i)=>(c(),d("div",ye,[s("h1",ke,r(("t"in n?n.t:t(l))("required")),1),s("p",$e,r(("t"in n?n.t:t(l))("tosHaveChanged")),1),s("button",{class:"btn btn-primary","data-testid":"btn-open-settings",onClick:e},r(("t"in n?n.t:t(l))("openSettings")),1)]))}}),Te={class:"w-[32rem] divide-y divide-base-content divide-opacity-10"},Pe=w({__name:"App",setup(u){Gt();const e=yt(),{state:n}=B(vt),i=ht(async()=>await e.isOnboardingCompleted());return(f,_)=>{const p=we,g=xt,o=wt,b=Pt,h=he,v=Tt;return c(),d("div",Te,[t(i)?(c(),d(x,{key:1},[s("div",null,[$(g,{height:45}),$(o)]),t(n)?T("",!0):(c(),L(b,{key:0})),t(n)?(c(),L(h,{key:1})):T("",!0),$(v)],64)):(c(),L(p,{key:0}))])}}});H.page(location.href);H.autoTrack(document);J(Pe).use(kt()).use(X).provide($t.Stayfocusd,Y()).mount("#app");
